<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <!-- Performance: Resource Hints -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">

    <!-- Performance: Resource Hints -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">

    <!-- Open Graph / Facebook -->
<meta property="og:type" content="article">
<meta property="og:url" content="https://tap-in-platform.netlify.app/team-assessment-enhanced-v2.html">
<meta property="og:title" content="Leadership Assessment | TAP-IN">
<meta property="og:description" content="Take our leadership assessment to discover your strengths and development areas.">
<meta property="og:image" content="https://tap-in-platform.netlify.app/og-image.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://tap-in-platform.netlify.app/team-assessment-enhanced-v2.html">
<meta property="twitter:title" content="Leadership Assessment | TAP-IN">
<meta property="twitter:description" content="Take our leadership assessment to discover your strengths and development areas.">
<meta property="twitter:image" content="https://tap-in-platform.netlify.app/og-image.png">
    <meta name="theme-color" content="#2d2d2d">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="version" content="3.0.0">
    <title>Team Dynamics Assessment - TAP-IN</title>
    <!-- SheetJS for Excel/CSV export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%); min-height: 100vh; padding: 20px; color: #333; overflow-x: hidden; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 20px; padding: 40px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); width: 100%; }
        .header { text-align: center; margin-bottom: 40px; padding-bottom: 30px; border-bottom: 3px solid #f0f0f0; }
        .header h1 { color: #1a365d; font-size: 2.5em; margin-bottom: 20px; font-weight: 600; letter-spacing: -0.5px; }
        .header .subtitle { color: #64748b; font-size: 1.15em; margin-bottom: 10px; line-height: 1.7; font-weight: 400; }
        .header .note { color: #94a3b8; font-size: 0.95em; }
        .intro-section { background: #f8fafc; padding: 25px; border-radius: 12px; margin-bottom: 30px; border-left: 3px solid #1a365d; }
        .intro-section h3 { color: #1e293b; margin-bottom: 15px; font-weight: 600; }
        .intro-section p { color: #64748b; line-height: 1.7; margin-bottom: 10px; }
        .progress-container { background: white; border-radius: 15px; padding: 20px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: sticky; top: 20px; z-index: 100; }
        .progress-bar { background: #e0e0e0; border-radius: 10px; height: 12px; overflow: hidden; margin-bottom: 10px; }
        .progress-fill { background: linear-gradient(90deg, #1a365d 0%, #334155 100%); height: 100%; width: 0%; transition: width 0.3s ease; }
        .progress-text { text-align: center; color: #64748b; font-size: 0.95em; font-variant-numeric: tabular-nums; }
        .assessment-card { background: #f8f9fa; border-radius: 12px; padding: 25px; margin-bottom: 30px; }
        .section-header { background: linear-gradient(135deg, #1a365d 0%, #0f1f3d 100%); color: white; padding: 15px 20px; border-radius: 10px; margin-bottom: 20px; font-weight: 600; }
        .section-desc { color: #64748b; margin-bottom: 25px; font-style: italic; line-height: 1.6; }
        .question { margin-bottom: 30px; }
        .question-text { color: #1e293b; font-size: clamp(1.05em, 2.5vw, 1.2em); margin-bottom: 18px; font-weight: 500; line-height: 1.5; letter-spacing: -0.3px; }

        .scale-options { display: flex; justify-content: space-between; align-items: flex-end; gap: 2px; flex-wrap: nowrap; height: 140px; position: relative; border-radius: 8px; padding: 5px; cursor: pointer; user-select: none; }
        .scale-option { flex: 1; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; border: 2px solid transparent; border-radius: 6px; transition: all 0.15s ease; position: relative; z-index: 1; }
        .scale-option:nth-child(1) { height: 50px; background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); }
        .scale-option:nth-child(2) { height: 70px; background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%); }
        .scale-option:nth-child(3) { height: 90px; background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%); }
        .scale-option:nth-child(4) { height: 110px; background: linear-gradient(135deg, #334155 0%, #1e293b 100%); }
        .scale-option:nth-child(5) { height: 130px; background: linear-gradient(135deg, #1a365d 0%, #0f1f3d 100%); }
        .scale-option input[type="radio"] { display: none; }
        .scale-option.active, .scale-option.selected { border-color: #1a365d; box-shadow: 0 2px 8px rgba(26, 54, 93, 0.4); }
        .scale-options:active { cursor: grabbing; }
        .scale-value { font-size: 1.3em; font-weight: bold; margin-bottom: 4px; pointer-events: none; }
        .scale-option:nth-child(1) .scale-value, .scale-option:nth-child(2) .scale-value, .scale-option:nth-child(3) .scale-value { color: #1e293b; }
        .scale-option:nth-child(4) .scale-value, .scale-option:nth-child(5) .scale-value { color: white; }
        .scale-label { font-size: 0.7em; opacity: 0.7; text-align: center; padding: 0 3px; margin-bottom: 6px; pointer-events: none; white-space: nowrap; }
        .scale-option:nth-child(1) .scale-label, .scale-option:nth-child(2) .scale-label, .scale-option:nth-child(3) .scale-label { color: #475569; }
        .scale-option:nth-child(4) .scale-label, .scale-option:nth-child(5) .scale-label { color: rgba(255,255,255,0.9); }
        .scale-option.active .scale-label, .scale-option.selected .scale-label { opacity: 1; font-weight: 600; }
        .scale-option.active .scale-value, .scale-option.selected .scale-value { transform: scale(1.1); }
        .insight-card { background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); border-left: 4px solid #1a365d; padding: 20px; margin: 20px 0; border-radius: 10px; animation: slideIn 0.4s ease; }
        .insight-card .insight-header { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
        .insight-card .insight-icon { font-size: 1.5em; }
        .insight-card .insight-title { color: #1a365d; font-weight: bold; font-size: 1.1em; }
        .insight-card .insight-content { color: #475569; line-height: 1.6; font-size: 0.95em; }
        .insight-card .insight-quote { font-style: italic; color: #64748b; margin-top: 10px; padding-top: 10px; border-top: 1px solid #cbd5e1; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .nav-buttons { display: flex; justify-content: space-between; gap: 15px; margin-top: 30px; }
        .btn { padding: 15px 35px; border: none; border-radius: 10px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: all 0.2s; text-decoration: none; display: inline-block; text-align: center; }
        .btn-primary { background: linear-gradient(135deg, #1a365d 0%, #0f1f3d 100%); color: white; }
        .btn-primary:hover:not(:disabled) { box-shadow: 0 4px 12px rgba(26, 54, 93, 0.4); transform: translateY(-1px); }
        .btn-primary:focus { outline: 2px solid #1a365d; outline-offset: 2px; }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-secondary { background: #e2e8f0; color: #1e293b; }
        .btn-secondary:hover { background: #cbd5e1; }
        .results { display: none; }
        .results.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .overall-score { background: linear-gradient(135deg, #1a365d 0%, #0f1f3d 100%); color: white; border-radius: 20px; padding: 40px; text-align: center; margin-bottom: 30px; box-shadow: 0 4px 20px rgba(26, 54, 93, 0.3); }
        .overall-score h2 { font-size: clamp(2em, 5vw, 3em); margin-bottom: 15px; }
        .overall-score .score { font-size: clamp(3em, 8vw, 5em); font-weight: bold; margin-bottom: 15px; }
        
        /* Flippable Score Cards */
        .scores-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin: 30px 0; }
        .flip-card { perspective: 1000px; height: 350px; cursor: pointer; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .flip-card-front { background: white; border: 2px solid #e2e8f0; display: flex; flex-direction: column; justify-content: center; }
        .flip-card-back { background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); transform: rotateY(180deg); overflow-y: auto; }
        .flip-card-front h3 { color: #1a365d; margin-bottom: 20px; font-size: 1.4em; text-align: center; font-weight: 600; }
        .flip-card-front .score-display { font-size: 3em; font-weight: bold; text-align: center; margin: 20px 0; }
        .flip-card-front .score-bar { background: #e2e8f0; height: 12px; border-radius: 10px; overflow: hidden; margin: 20px 0; }
        .flip-card-front .score-bar-fill { height: 100%; transition: width 1s ease; }
        .flip-card-front .score-level { text-align: center; font-weight: 600; font-size: 1.1em; margin: 15px 0; }
        .flip-card-front .flip-hint { color: #94a3b8; font-size: 0.85em; margin-top: auto; text-align: center; display: flex; align-items: center; justify-content: center; gap: 5px; }
        .flip-card-back h3 { color: #1a365d; margin-bottom: 15px; font-size: 1.3em; border-bottom: 2px solid #1a365d; padding-bottom: 10px; }
        .flip-card-back .detail-section { margin-bottom: 20px; }
        .flip-card-back .detail-section h4 { color: #1e293b; font-size: 1em; margin-bottom: 10px; font-weight: 600; }
        .flip-card-back .detail-section p { color: #64748b; font-size: 0.95em; line-height: 1.6; margin-bottom: 12px; }
        .flip-card-back .action-items { list-style: none; padding-left: 0; }
        .flip-card-back .action-items li { color: #64748b; font-size: 0.9em; line-height: 1.5; margin-bottom: 10px; padding-left: 20px; position: relative; }
        .flip-card-back .action-items li:before { content: "‚Üí"; position: absolute; left: 0; color: #1a365d; font-weight: bold; }
        
        .score-section { background: #f8fafc; border-radius: 15px; padding: 25px; margin-bottom: 25px; border-left: 5px solid #1a365d; }
        .score-section h3 { color: #1a365d; margin-bottom: 15px; font-size: 1.4em; font-weight: 600; }
        .score-display { font-size: 2em; font-weight: bold; color: #1a365d; margin-bottom: 10px; }
        .score-bar { background: #e2e8f0; height: 20px; border-radius: 10px; overflow: hidden; margin-bottom: 15px; }
        .score-bar-fill { background: linear-gradient(90deg, #1a365d 0%, #334155 100%); height: 100%; transition: width 0.5s ease; }
        .score-interpretation { color: #64748b; line-height: 1.7; margin-bottom: 15px; }
        .recommendation { background: white; padding: 20px; border-radius: 10px; margin-top: 15px; }
        .recommendation h4 { color: #1e293b; margin-bottom: 10px; font-weight: 600; }
        .recommendation p { color: #64748b; line-height: 1.6; }
        .cta-box { background: linear-gradient(135deg, #1a365d 0%, #0f1f3d 100%); color: white; border-radius: 15px; padding: 30px; text-align: center; margin-top: 30px; }
        .cta-box h3 { margin-bottom: 15px; font-size: 1.6em; }
        .cta-box p { margin-bottom: 20px; opacity: 0.95; }
        .hidden { display: none; }
        
        /* Lencioni's 5 Dysfunctions Banner */
        .stats-banner { 
            background: linear-gradient(135deg, #1a365d 0%, #0f1f3d 100%); 
            color: white; 
            padding: 20px; 
            border-radius: 12px; 
            display: flex; 
            justify-content: space-around; 
            align-items: center; 
            gap: 15px; 
            margin-bottom: 30px; 
            flex-wrap: wrap;
            box-shadow: 0 4px 15px rgba(169, 50, 38, 0.3);
        }
        .stats-banner .stat-item { 
            display: flex; 
            flex-direction: column;
            align-items: center; 
            gap: 8px;
            text-align: center;
            min-width: 80px;
        }
        .stats-banner .stat-number { 
            font-size: 1.4em; 
            font-weight: bold; 
        }
        .stats-banner .stat-label { 
            opacity: 0.95;
            font-size: 0.9em;
            font-weight: 500;
        }
        
        @media (max-width: 768px) { .header, .assessment-card { padding: 25px 20px; } .scale-options { gap: 8px; } .scale-option { min-width: 60px; padding: 12px 8px; } .nav-buttons { flex-direction: column; } .btn { width: 100%; } .overall-score { padding: 30px 20px; } .stats-banner { gap: 15px; font-size: 0.85em; } }

        /* üéÆ GAMIFICATION STYLES */
        .achievement-toast { position: fixed; top: 80px; right: 20px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 20px 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4); z-index: 2000; display: none; animation: slideInRight 0.5s ease-out; max-width: 300px; }
        .achievement-toast.show { display: block; }
        .achievement-toast .icon { font-size: 2em; margin-bottom: 10px; }
        .achievement-toast .title { font-weight: bold; font-size: 1.1em; margin-bottom: 5px; }
        .achievement-toast .description { font-size: 0.9em; opacity: 0.95; }
        @keyframes slideInRight { from { transform: translateX(400px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .confetti { position: fixed; width: 10px; height: 10px; background: #f0f; position: absolute; animation: confetti-fall 3s linear forwards; }
        @keyframes confetti-fall { to { transform: translateY(100vh) rotate(360deg); opacity: 0; } }
        .xp-bar { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: white; padding: 12px 20px; border-radius: 25px; box-shadow: 0 5px 20px rgba(0,0,0,0.15); z-index: 1100; display: none; min-width: 250px; }
        .xp-bar.show { display: block; }
        .xp-bar .level { font-weight: bold; color: #f59e0b; margin-bottom: 5px; font-size: 0.9em; }
        .xp-bar .progress-container { height: 8px; background: #e5e7eb; border-radius: 10px; overflow: hidden; position: relative; }
        .xp-bar .progress-fill { height: 100%; background: linear-gradient(90deg, #f59e0b, #fbbf24); border-radius: 10px; transition: width 0.5s ease-out; }
        .xp-bar .xp-text { font-size: 0.8em; color: #64748b; margin-top: 5px; text-align: center; }
        .achievements-section { background: white; border-radius: 20px; padding: 30px; margin-top: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
        .achievements-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-top: 20px; }
        .badge { background: #f8fafc; border-radius: 15px; padding: 20px; text-align: center; transition: all 0.3s; border: 2px solid transparent; }
        .badge.unlocked { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-color: #f59e0b; box-shadow: 0 5px 15px rgba(245, 158, 11, 0.2); }
        .badge.locked { opacity: 0.5; filter: grayscale(1); }
        .badge .icon { font-size: 3em; margin-bottom: 10px; }
        .badge .name { font-weight: bold; font-size: 0.9em; color: #1a365d; margin-bottom: 5px; }
        .badge .description { font-size: 0.75em; color: #64748b; }
        .streak-badge { position: fixed; top: 80px; left: 20px; background: white; padding: 15px 20px; border-radius: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.15); z-index: 1100; display: none; }
        .streak-badge.show { display: block; }
        .streak-badge .fire { font-size: 2em; margin-bottom: 5px; }
        .streak-badge .count { font-size: 1.5em; font-weight: bold; color: #f59e0b; }
        .streak-badge .label { font-size: 0.8em; color: #64748b; }
    </style>
                <link rel="canonical" href="https://tap-in-platform.netlify.app/team-assessment-enhanced-v2.html">

            <body>
    <!-- language switcher (EN / DE) -->
    <div id="lang-switch" style="position:fixed;top:16px;right:16px;z-index:1200;font-family:inherit;">
        <div style="background:white;border-radius:999px;padding:8px 12px;box-shadow:0 6px 20px rgba(0,0,0,0.15);font-size:0.95em;">
            <a href="team-assessment-enhanced-v2.html" style="color:#a93226;text-decoration:none;font-weight:700;margin-right:10px;">EN</a>
            <a href="team-assessment-enhanced-v2.de.html" style="color:#333;text-decoration:none;font-weight:700;border-left:1px solid #eee;padding-left:10px;margin-left:10px;">DE</a>
        </div>
    </div>

    <!-- üéÆ GAMIFICATION ELEMENTS -->
    <div class="xp-bar" id="xpBar">
        <div class="level" id="levelText">Level 1: Team Explorer</div>
        <div class="progress-container"><div class="progress-fill" id="xpProgress" style="width: 0%"></div></div>
        <div class="xp-text" id="xpText">0 / 100 XP</div>
    </div>
    <div class="streak-badge" id="streakBadge">
        <div class="fire">üî•</div>
        <div class="count" id="streakCount">0</div>
        <div class="label">day streak</div>
    </div>
    <div class="achievement-toast" id="achievementToast">
        <div class="icon" id="achievementIcon">üèÜ</div>
        <div class="title" id="achievementTitle">Achievement Unlocked!</div>
        <div class="description" id="achievementDesc">You earned a new badge</div>
    </div>

                <div class="container">
                    <!-- Stats Banner -->
                    <!-- Lencioni's 5 Dysfunctions Framework -->
                    <div class="stats-banner">
                        <div class="stat-item">
                            <span style="font-size: 1.8em;">üõ°Ô∏è</span>
                            <div class="stat-label">Trust</div>
                        </div>
                        <div class="stat-item">
                            <span style="font-size: 1.8em;">‚öîÔ∏è</span>
                            <div class="stat-label">Conflict</div>
                        </div>
                        <div class="stat-item">
                            <span style="font-size: 1.8em;">üéØ</span>
                            <div class="stat-label">Commitment</div>
                        </div>
                        <div class="stat-item">
                            <span style="font-size: 1.8em;">‚úì</span>
                            <div class="stat-label">Accountability</div>
                        </div>
                        <div class="stat-item">
                            <span style="font-size: 1.8em;">ÔøΩ</span>
                            <div class="stat-label">Results</div>
                        </div>
                    </div>
                        </div>
                    </div>

                    <!-- Header -->
                    <div class="header">
                        <h1>ü§ù Team Dynamics Assessment</h1>
                    </div>

                    <!-- Context Section -->
                    <div class="intro-section">
                        <h3>üìä Why This Matters: The Science of High-Performing Teams</h3>
                        <p><strong>Google's Project Aristotle</strong> analyzed 180+ teams and found psychological safety‚Äînot individual talent‚Äîpredicts team success. Combined with <strong>Patrick Lencioni's 5 Dysfunctions</strong>, this assessment reveals the hidden dynamics that separate elite teams from average ones.</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 3px solid #a93226;">
                                <div style="font-size: 1.5em; margin-bottom: 5px;">üîí</div>
                                <strong>Trust</strong><br>
                                <span style="font-size: 0.85em; color: #666;">Vulnerability-based</span>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 3px solid #d64436;">
                                <div style="font-size: 1.5em; margin-bottom: 5px;">‚ö°</div>
                                <strong>Conflict</strong><br>
                                <span style="font-size: 0.85em; color: #666;">Healthy debate</span>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 3px solid #e87653;">
                                <div style="font-size: 1.5em; margin-bottom: 5px;">üéØ</div>
                                <strong>Commitment</strong><br>
                                <span style="font-size: 0.85em; color: #666;">Clarity & buy-in</span>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 3px solid #f5a26f;">
                                <div style="font-size: 1.5em; margin-bottom: 5px;">üëÅÔ∏è</div>
                                <strong>Accountability</strong><br>
                                <span style="font-size: 0.85em; color: #666;">Peer pressure</span>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 3px solid #ffc285;">
                                <div style="font-size: 1.5em; margin-bottom: 5px;">üèÜ</div>
                                <strong>Results</strong><br>
                                <span style="font-size: 0.85em; color: #666;">Collective goals</span>
                            </div>
                        </div>

                        <p style="margin-top: 15px; font-style: italic; color: #888; font-size: 0.9em;">
                            "Not finance. Not strategy. Not technology. It is teamwork that remains the ultimate competitive advantage." ‚Äî Patrick Lencioni
                        </p>

                        <div style="text-align: center; margin-top: 30px;">
                            <button class="btn btn-primary" onclick="startAssessment()" style="font-size: 1.2em; padding: 18px 50px;">
                                Start Assessment ‚Üí
                            </button>
                        </div>
                    </div>
                    <!-- Progress Bar -->
                    <div class="progress-container" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">Question 1 of 20</div>
                    </div>
                    <!-- Assessment Form -->
                    <div id="assessmentForm" style="display: none;">
                        <div class="assessment-card" id="questionCard">
                            <!-- Questions will be dynamically inserted here -->
                        </div>
                        <div class="nav-buttons">
                            <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()" style="display: none;">‚Üê Previous</button>
                            <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>Next ‚Üí</button>
                        </div>
                    </div>
                    <!-- Results Section -->
                    <div id="results" class="results">
                        <div class="assessment-card">
                            <div id="resultContent"></div>
                            <!-- CTA -->
                            <div class="cta-box">
                                <h3>Ready to Transform Your Team?</h3>
                                <p>Book a complimentary 30-minute Team Dynamics Strategy Session to discuss your results and create a 90-day action plan.</p>
                                <a href="mailto:contact@tap-in-academy.com?subject=Team Assessment Strategy Session" class="btn" style="background: white; color: #a93226;">üìÖ Schedule Strategy Session</a>
                                <div style="margin-top: 20px;">
                                    <a href="index.html" class="btn" style="background: transparent; border: 2px solid white; color: white;">‚Üê Back to Assessments</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <script>
                    const questions = [
                        // TRUST (4 questions)
                        {
                            section: 'Trust',
                            sectionDesc: 'The foundation of teamwork is vulnerability-based trust.',
                            question: 'Team members openly admit their mistakes and weaknesses',
                            category: 'trust'
                        },
                        {
                            question: 'People ask for help without hesitation',
                            category: 'trust'
                        },
                        {
                            question: 'Team members give each other benefit of the doubt',
                            category: 'trust'
                        },
                        {
                            question: 'People apologize quickly and genuinely when they mess up',
                            category: 'trust'
                        },
                        // CONFLICT (4 questions)
                        {
                            section: 'Conflict',
                            sectionDesc: 'Healthy teams engage in passionate, unfiltered debate.',
                            question: 'Team meetings include passionate, unfiltered debate',
                            category: 'conflict'
                        },
                        {
                            question: 'People voice disagreements during meetings (not after)',
                            category: 'conflict'
                        },
                        {
                            question: 'Conflicts get resolved quickly and cleanly',
                            category: 'conflict'
                        },
                        {
                            question: 'Team members challenge each other\'s ideas respectfully',
                            category: 'conflict'
                        },
                        // COMMITMENT (4 questions)
                        {
                            section: 'Commitment',
                            sectionDesc: 'Teams that debate effectively achieve genuine buy-in and commitment.',
                            question: 'Decisions are made with clarity and buy-in from everyone',
                            category: 'commitment'
                        },
                        {
                            question: 'Team members leave meetings confident about direction',
                            category: 'commitment'
                        },
                        {
                            question: 'People stick to decisions even when they initially disagreed',
                            category: 'commitment'
                        },
                        {
                            question: 'Deadlines and priorities are crystal clear to everyone',
                            category: 'commitment'
                        },
                        // ACCOUNTABILITY (4 questions)
                        {
                            section: 'Accountability',
                            sectionDesc: 'Committed teams hold each other accountable for high standards.',
                            question: 'Team members call each other out on performance issues',
                            category: 'accountability'
                        },
                        {
                            question: 'People take ownership when things go wrong',
                            category: 'accountability'
                        },
                        {
                            question: 'Standards are upheld even when it\'s uncomfortable',
                            category: 'accountability'
                        },
                        {
                            question: 'Team members pressure peers to deliver on commitments',
                            category: 'accountability'
                        },
                        // RESULTS (4 questions)
                        {
                            section: 'Results',
                            sectionDesc: 'Accountable teams focus on collective results over individual goals.',
                            question: 'Team celebrates collective wins over individual achievements',
                            category: 'results'
                        },
                        {
                            question: 'People sacrifice personal agendas for team goals',
                            category: 'results'
                        },
                        {
                            question: 'Success metrics are clearly defined and tracked',
                            category: 'results'
                        },
                        {
                            question: 'Team members are genuinely concerned about letting teammates down',
                            category: 'results'
                        }
                    ];
                    
                    // Dynamic insights that appear after answering questions
                    const insights = [
                        // TRUST insights (Q1-4)
                        { icon: 'üîç', title: 'The Vulnerability Paradox', content: 'Research shows that 75% of team dysfunction stems from lack of trust. But here\'s the twist: vulnerability isn\'t weakness‚Äîit\'s the ultimate strength move. When leaders admit mistakes first, team psychological safety increases by 47%.', quote: '"Trust is knowing that when a team member pushes you, they\'re doing it because they care about the team." - Patrick Lencioni' },
                        { icon: 'ü§ù', title: 'The Help-Seeking Signal', content: 'High-performing teams ask for help 3x more often than average teams. Why? Because asking for help is a trust indicator‚Äîit signals "I believe you\'ll support me, not judge me." Google\'s Project Aristotle found this was the #1 predictor of team success.', quote: 'Fun fact: Navy SEAL teams spend 80% of training time building trust, only 20% on tactics.' },
                        { icon: 'üí°', title: 'Benefit of the Doubt', content: 'Teams with high trust assume positive intent by default. This single shift reduces conflict resolution time by 60%. Instead of "Why did they do that?!" it becomes "What challenge are they facing that I don\'t see?"', quote: 'The Trust Equation: Credibility + Reliability + Intimacy √∑ Self-Orientation = Trust' },
                        { icon: 'üôè', title: 'The Apology Advantage', content: 'Leaders who apologize quickly are rated 23% more effective. Why? Apologies signal: "I value this relationship more than my ego." Bonus: Teams where apologies are normalized resolve conflicts 4x faster.', quote: '"The best apology is changed behavior." - Unknown (but your team knows it!)' },
                        
                        // CONFLICT insights (Q5-8)
                        { icon: '‚öîÔ∏è', title: 'Productive Conflict ‚â† Drama', content: 'Healthy teams spend 40% more time in meetings debating ideas, but 50% less time in dysfunctional conflict afterward. The secret? They fight about IDEAS, not PEOPLE. This is called "task conflict" vs "relationship conflict."', quote: 'Intel\'s Andy Grove: "Disagree and commit" only works if you actually disagree first.' },
                        { icon: 'üéØ', title: 'Real-Time Disagreement', content: 'Teams that resolve disagreements IN the meeting make decisions 3x faster than teams who "parking lot" issues. Why? Because parking lots become graveyards. Address it now, move forward together.', quote: 'The meeting after the meeting is where real decisions die.' },
                        { icon: '‚ö°', title: 'Speed of Resolution', content: 'High-trust teams resolve conflicts in hours, not weeks. The formula? Address early + assume positive intent + focus on solutions. Low-trust teams let resentment compound like credit card debt‚Äîbefore you know it, you\'re bankrupt.', quote: 'Conflict avoided = trust eroded. Conflict engaged = trust strengthened.' },
                        { icon: 'üõ°Ô∏è', title: 'Challenge Culture', content: 'At Pixar, they use "plussing"‚Äîyou can challenge any idea, but you must ADD to it, not just tear it down. Result? Psychological safety + creative tension = masterpieces. Your team can do this too.', quote: 'If everyone is thinking alike, someone isn\'t thinking.' },
                        
                        // COMMITMENT insights (Q9-12)
                        { icon: 'üé™', title: 'Clarity = Commitment', content: 'Vague goals create vague commitment. Teams with crystal-clear objectives are 2.5x more likely to hit targets. The test? Ask 3 team members what the #1 priority is. If you get 3 different answers, you don\'t have commitment.', quote: 'Clear is kind. Unclear is unkind. - Bren√© Brown' },
                        { icon: 'üöÄ', title: 'Confidence After Conflict', content: 'Teams that debate intensely but commit fully outperform "consensus-seekers" by 40%. Why? Because real buy-in comes from being HEARD, not from getting your way. Everyone won\'t agree, but everyone will commit.', quote: 'Commitment isn\'t about agreement‚Äîit\'s about clarity and closure.' },
                        { icon: 'üîí', title: 'Disagree & Commit', content: 'Netflix culture: You can disagree strongly during discussion, but once a decision is made, you commit as if it was your idea. This creates alignment without forcing fake consensus. The alternative? Passive-aggressive execution.', quote: 'Supporting a decision you disagree with is leadership. Undermining it is sabotage.' },
                        { icon: 'üìç', title: 'Deadline Discipline', content: 'Teams that track deadlines publicly complete projects 80% faster. Accountability loves visibility. Pro tip: Use a shared dashboard where everyone sees who\'s on track. Peer pressure becomes peer support.', quote: 'A goal without a deadline is just a wish with extra steps.' },
                        
                        // ACCOUNTABILITY insights (Q13-16)
                        { icon: 'üí™', title: 'Peer Accountability > Boss Accountability', content: 'When teams hold EACH OTHER accountable (not just the manager), performance improves 30%. Why? Peer pressure is powerful. Nobody wants to let down people they respect. Make accountability a team sport, not a manager\'s job.', quote: 'If only the leader holds people accountable, you don\'t have a team‚Äîyou have a daycare.' },
                        { icon: 'ü§≤', title: 'Fear of Letting Down', content: 'The ultimate team glue? Caring more about disappointing teammates than disappointing the boss. When this exists, accountability becomes internal, not external. You show up not because you have to, but because they\'re counting on you.', quote: 'The highest form of accountability is when you hold yourself accountable to your team.' },
                        { icon: 'üí¨', title: 'SBIR: The Accountability Feedback Framework', content: '<strong>Feedback is best served hot</strong> ‚Äì focus on the most recent, specific situation.<br><br>üìç <strong>S - Situation:</strong> When & where exactly?<br>üëÅÔ∏è <strong>B - Behaviour:</strong> What exactly did you observe? (Objective, not interpreted)<br>üí• <strong>I - Impact:</strong> What consequence did it have?<br>üéØ <strong>R - Result:</strong> What should be different next time?<br><br>‚ö†Ô∏è When needed: Clarify risks or consequences. Rule: Objective, concise, not insulting. Address the behavior, not the person.', quote: 'Clarity is kindness. Vagueness is cruelty.' },
                        { icon: 'üéØ', title: 'Ownership Mindset', content: 'High-accountability teams use "I/we" language ("I missed that deadline") vs. low-accountability teams use "it/they" ("The timeline was unrealistic"). This tiny linguistic shift increases problem-solving speed by 50%.', quote: 'Ownership starts the moment you stop blaming.' },
                        { icon: 'üî•', title: 'Standards Under Pressure', content: 'True team culture is revealed when things get hard. Do standards slip, or do they tighten? Navy SEALs say: "Under pressure, you don\'t rise to the occasion‚Äîyou sink to your level of training." Your team standards are your training.', quote: 'What you permit, you promote. What you tolerate becomes your standard.' },
                        { icon: '‚öñÔ∏è', title: 'Constructive Pressure', content: 'Accountability without trust feels like micromanagement. Accountability WITH trust feels like caring. The difference? Intent. "I\'m checking on you because I don\'t trust you" vs. "I\'m checking in because I want you to succeed."', quote: 'Pressure is a privilege when it comes from people who believe in you.' },
                        
                        // RESULTS insights (Q17-20)
                        { icon: 'üèÜ', title: 'Collective > Individual', content: 'Teams that celebrate group wins over individual MVPs are 60% more likely to hit targets. Why? Because when everyone rows together, the boat goes faster. Individual stars create silos. Team wins create momentum.', quote: 'There\'s no "I" in team, but there is in "win"... wait, that doesn\'t work here.' },
                        { icon: 'üé≠', title: 'Ego Check at the Door', content: 'Sacrifice = Success. When team members put collective goals above personal agendas, productivity increases 35%. The anti-pattern? "That\'s not my job" syndrome. High performers ask "How can I help us win?" not "How can I look good?"', quote: 'A player who makes the team great is more valuable than a great player. - John Wooden' },
                        { icon: 'üìä', title: 'Measure What Matters', content: 'You can\'t manage what you don\'t measure. Teams with visible, tracked metrics perform 2x better than teams with vague goals. The rule? If success isn\'t measurable, it\'s just an opinion wearing a fancy hat.', quote: 'What gets measured gets managed. What gets managed gets done.' }
                    ];
                    
                    let currentQuestion = 0;
                    let answers = {};
                    
                    // Progress Saving System
                    const STORAGE_KEY = 'team-assessment-progress';
                    
                    function saveProgress() {
                        const progressData = {
                            currentQuestion,
                            answers,
                            timestamp: new Date().toISOString(),
                            version: '3.0.0'
                        };
                        try {
                            localStorage.setItem(STORAGE_KEY, JSON.stringify(progressData));
                        } catch (e) {
                            console.log('Could not save progress');
                        }
                    }
                    
                    function loadProgress() {
                        try {
                            const saved = localStorage.getItem(STORAGE_KEY);
                            if (saved) {
                                const data = JSON.parse(saved);
                                // Check if progress is less than 7 days old
                                const savedDate = new Date(data.timestamp);
                                const daysSince = (new Date() - savedDate) / (1000 * 60 * 60 * 24);
                                if (daysSince < 7 && data.version === '3.0.0') {
                                    return data;
                                }
                            }
                        } catch (e) {
                            console.log('Could not load progress');
                        }
                        return null;
                    }
                    
                    function clearProgress() {
                        try {
                            localStorage.removeItem(STORAGE_KEY);
                        } catch (e) {}
                    }
                    
                    function showResumePrompt() {
                        const saved = loadProgress();
                        if (!saved) return;
                        
                        const completedQuestions = Object.keys(saved.answers).length;
                        const percentage = Math.round((completedQuestions / questions.length) * 100);
                        
                        const resumeHTML = `
                            <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 9999; display: flex; align-items: center; justify-content: center; animation: fadeIn 0.3s ease;" id="resumeModal">
                                <div style="background: white; border-radius: 20px; padding: 40px; max-width: 500px; text-align: center; animation: slideUp 0.3s ease;">
                                    <div style="font-size: 3em; margin-bottom: 20px;">üéØ</div>
                                    <h2 style="color: #a93226; margin-bottom: 15px;">Welcome Back!</h2>
                                    <p style="color: #666; font-size: 1.1em; margin-bottom: 10px;">You've already completed <strong>${completedQuestions} of ${questions.length} questions</strong></p>
                                    <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 20px; border-radius: 12px; margin: 20px 0;">
                                        <div style="font-size: 2.5em; font-weight: bold; color: #a93226; margin-bottom: 5px;">${percentage}%</div>
                                        <div style="color: #666;">Progress Complete</div>
                                    </div>
                                    <div style="display: flex; gap: 15px; margin-top: 25px;">
                                        <button onclick="resumeAssessment()" style="flex: 1; background: linear-gradient(135deg, #a93226 0%, #7a241b 100%); color: white; border: none; padding: 15px 20px; border-radius: 10px; font-size: 1.1em; font-weight: 600; cursor: pointer;">
                                            ‚ñ∂Ô∏è Resume
                                        </button>
                                        <button onclick="startFresh()" style="flex: 1; background: white; color: #666; border: 2px solid #e0e0e0; padding: 15px 20px; border-radius: 10px; font-size: 1.1em; font-weight: 600; cursor: pointer;">
                                            üîÑ Start Over
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        document.body.insertAdjacentHTML('beforeend', resumeHTML);
                    }
                    
                    function resumeAssessment() {
                        const saved = loadProgress();
                        if (saved) {
                            currentQuestion = saved.currentQuestion;
                            answers = saved.answers;
                            document.getElementById('resumeModal')?.remove();
                            renderQuestion();
                            updateProgress();
                        }
                    }
                    
                    function startFresh() {
                        clearProgress();
                        currentQuestion = 0;
                        answers = {};
                        document.getElementById('resumeModal')?.remove();
                        renderQuestion();
                        updateProgress();
                    }
                    
                    const sectionIntros = {
                        'Trust': `
                            <strong>Why vulnerability-based trust is the foundation:</strong> Patrick Lencioni's 20+ years studying executive teams proves that <strong>trust is NOT about predicting behavior - it's about feeling safe enough to be vulnerable</strong>. Google's Project Aristotle (study of 180+ teams) confirmed psychological safety as the #1 predictor of team effectiveness - more than talent, resources, or strategy.
                            <br><br>
                            <strong>The neuroscience:</strong> Amy Edmondson's Harvard research shows teams with high psychological safety learn 3x faster from failures, take calculated risks, and surface problems early. When cortisol (stress hormone) is high from fear, the brain's prefrontal cortex shuts down - killing creativity and collaboration. Vulnerability triggers oxytocin, enhancing trust.
                            <br><br>
                            <strong>Bottom line:</strong> Teams that can't admit mistakes, ask for help, or show weakness waste 50-70% of meeting time on posturing and politics (Lencioni's research). Elite teams start with "check-ins" sharing personal context - building trust muscle before tackling hard problems.
                        `,
                        'Conflict': `
                            <strong>Why productive conflict beats artificial harmony:</strong> Research shows that <strong>teams avoiding conflict make worse decisions</strong> - groupthink kills innovation. Bob Sutton (Stanford): "The best performing teams fight a LOT - but they fight about ideas, not people." Pixar's "Braintrust" meetings are brutal honest feedback sessions that turned mediocre movies into masterpieces.
                            <br><br>
                            <strong>The trust prerequisite:</strong> Without vulnerability-based trust, conflict becomes personal attacks. WITH trust, passionate debate feels safe - even energizing. Kim Scott's "Radical Candor": caring personally enables challenging directly. Google's research: teams with high conflict + high trust have 40% better outcomes.
                            <br><br>
                            <strong>The cost of fake harmony:</strong> Patrick Lencioni: "If we don't disagree in meetings, the real decisions happen in parking lots - fragmented, political, toxic." Ray Dalio (Bridgewater): radical transparency and idea meritocracy require fierce debates. The best idea wins - not the highest ranking person. Meeting time saved by avoiding conflict = wasted months executing wrong decisions.
                        `,
                        'Commitment': `
                            <strong>Why clarity and buy-in beat consensus:</strong> Many teams confuse commitment with consensus - trying to make everyone happy kills speed. Lencioni: <strong>"Great teams disagree, commit, and move forward together."</strong> Jeff Bezos: "Disagree and commit" enables 70% decisions with 100% velocity. Waiting for certainty = competitive death.
                            <br><br>
                            <strong>The two requirements:</strong> People commit when (1) their voice is heard, and (2) decision-making process is clear. They DON'T need to agree with the decision. Study of 1,000+ teams (Wiley): teams with clear commitments execute 50% faster than teams with ambiguous goals. Clarity eliminates re-work.
                            <br><br>
                            <strong>The cascading clarity test:</strong> Can every team member articulate: (1) What are we doing? (2) Why does it matter? (3) What's MY role? If not, you have alignment theater - not real commitment. Elite teams end meetings with explicit confirmation: "Here's what we decided. Here's who does what by when. Any concerns?"
                        `,
                        'Accountability': `
                            <strong>Why peer accountability beats boss-driven:</strong> When only the leader holds people accountable, you've built a culture of children waiting for parents. Lencioni's research: <strong>peer accountability is 3x more powerful than top-down</strong> - because it happens in real-time, not quarterly reviews. Navy SEALs call it "extreme ownership" - everyone protects the standard.
                            <br><br>
                            <strong>The commitment prerequisite:</strong> You can't hold someone accountable to vague goals. Accountability requires crystal-clear commitments. And it requires trust - without psychological safety, feedback feels like attacks. Bren√© Brown: "Clear is kind. Unclear is unkind." Avoiding accountability to be "nice" breeds resentment.
                            <br><br>
                            <strong>The performance multiplier:</strong> Research shows peer pressure outperforms incentives. Why? Humans care more about letting teammates down than missing bonuses. Southwest Airlines, Zappos, Navy SEALs - elite cultures where peers enforce standards. The leader's job: create the framework where peer accountability thrives.
                        `,
                        'Results': `
                            <strong>Why collective results beat individual ego:</strong> Lencioni: "Team members who focus on individual status and ego destroy teams." Research on sports teams: <strong>teams of "superstars" underperform teams of complementary players focused on collective winning</strong>. Golden State Warriors before Durant: ball movement, 5 guys touching ball per possession. After: hero ball, less championships.
                            <br><br>
                            <strong>The accountability prerequisite:</strong> Without peer accountability, everyone optimizes for personal success - hoarding credit, avoiding risk, protecting turf. The "silo effect" (Harvard study): companies with strong silos have 30% worse performance than aligned companies. Everyone hitting personal goals while company fails = leadership failure.
                            <br><br>
                            <strong>The scoreboard principle:</strong> Patrick Lencioni: "If you could only measure one thing, measure the collective scoreboard everyone obsesses over." Amazon measures customer obsession. Pixar measures "is this our best story ever?" What's YOUR scoreboard? If every team member can't recite it, you don't have one. Elite teams celebrate together, fail together, and relentlessly focus on THE score that matters.
                        `
                    };
                    
                    function renderQuestion() {
                        const q = questions[currentQuestion];
                        const card = document.getElementById('questionCard');
                        let html = '';
                        
                        // Show section intro card on first question of each section
                        if (q.section && sectionIntros[q.section]) {
                            html += `
                                <div class="section-header">
                                    <div class="section-title">Section ${Math.floor(currentQuestion/4) + 1}: ${q.section}</div>
                                    <div class="section-description">${q.sectionDesc}</div>
                                </div>
                                <div class="insight-card" style="margin-bottom: 25px;">
                                    <div class="insight-title">üìä Research Context: Why ${q.section} Matters</div>
                                    <div class="insight-content">${sectionIntros[q.section]}</div>
                                </div>
                            `;
                        } else if (q.section) {
                            html += `
                                <div class="section-header">
                                    <div class="section-title">Section ${Math.floor(currentQuestion/4) + 1}: ${q.section}</div>
                                    <div class="section-description">${q.sectionDesc}</div>
                                </div>
                            `;
                        }
                        html += `
                            <div class="question">
                                <div class="question-text">
                                    <span class="question-number">${currentQuestion + 1}.</span>
                                    ${q.question}
                                </div>
                                <div class="scale-options">
                        `;
                        const labels = ['Never', 'Rarely', 'Sometimes', 'Often', 'Always'];
                        for (let i = 1; i <= 5; i++) {
                            const selected = answers[currentQuestion] === i ? 'selected' : '';
                            const active = answers[currentQuestion] >= i ? 'active' : '';
                            html += `
                                <label class="scale-option ${selected} ${active}" data-value="${i}">
                                    <input type="radio" name="q${currentQuestion}" value="${i}">
                                    <div class="scale-value">${i}</div>
                                    <div class="scale-label">${labels[i-1]}</div>
                                </label>
                            `;
                        }
                        html += `
                                </div>
                            </div>
                        `;
                        card.innerHTML = html;
                        
                        // Add drag/swipe functionality
                        const scaleContainer = card.querySelector('.scale-options');
                        let isDragging = false;
                        
                        function handleInteraction(e) {
                            const rect = scaleContainer.getBoundingClientRect();
                            const x = (e.clientX || e.touches?.[0]?.clientX) - rect.left;
                            const relativeX = Math.max(0, Math.min(1, x / rect.width));
                            const value = Math.ceil(relativeX * 5) || 1;
                            selectOption(value);
                            updateSliderVisual(value);
                        }
                        
                        function updateSliderVisual(value) {
                            const options = scaleContainer.querySelectorAll('.scale-option');
                            options.forEach((opt, idx) => {
                                if (idx < value) {
                                    opt.classList.add('active');
                                } else {
                                    opt.classList.remove('active');
                                }
                                if (idx === value - 1) {
                                    opt.classList.add('selected');
                                } else {
                                    opt.classList.remove('selected');
                                }
                            });
                        }
                        
                        scaleContainer.addEventListener('mousedown', (e) => {
                            isDragging = true;
                            handleInteraction(e);
                        });
                        
                        scaleContainer.addEventListener('mousemove', (e) => {
                            if (isDragging) handleInteraction(e);
                        });
                        
                        scaleContainer.addEventListener('mouseup', () => {
                            isDragging = false;
                        });
                        
                        scaleContainer.addEventListener('mouseleave', () => {
                            isDragging = false;
                        });
                        
                        scaleContainer.addEventListener('touchstart', (e) => {
                            handleInteraction(e);
                        }, { passive: true });
                        
                        scaleContainer.addEventListener('touchmove', (e) => {
                            handleInteraction(e);
                        }, { passive: true });
                        
                        updateProgress();
                        updateButtons();
                    }
                    function selectOption(value) {
                        answers[currentQuestion] = value;
                        document.querySelectorAll('.scale-option').forEach(opt => opt.classList.remove('selected'));
                        document.getElementById('nextBtn').disabled = false;
                        
                        // Auto-save progress
                        saveProgress();
                        
                        // Show insight after answering
                        showInsight();
                    }
                    
                    function showInsight() {
                        // Remove any existing insight
                        const existingInsight = document.querySelector('.insight-card');
                        if (existingInsight) existingInsight.remove();
                        
                        // Get insight for current question
                        const insight = insights[currentQuestion];
                        if (!insight) return;
                        
                        // Create insight card
                        const insightHTML = `
                            <div class="insight-card">
                                <div class="insight-header">
                                    <span class="insight-icon">${insight.icon}</span>
                                    <span class="insight-title">${insight.title}</span>
                                </div>
                                <div class="insight-content">${insight.content}</div>
                                <div class="insight-quote">${insight.quote}</div>
                            </div>
                        `;
                        
                        // Insert after the question
                        const questionCard = document.getElementById('questionCard');
                        questionCard.insertAdjacentHTML('beforeend', insightHTML);
                        
                        // Smooth scroll to keep insight visible
                        setTimeout(() => {
                            const insightElement = document.querySelector('.insight-card');
                            if (insightElement) {
                                insightElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                            }
                        }, 100);
                    }
                    function updateProgress() {
                        const progress = ((currentQuestion + 1) / questions.length) * 100;
                        document.getElementById('progressFill').style.width = progress + '%';
                        document.getElementById('progressText').textContent = `Question ${currentQuestion + 1} of ${questions.length}`;
                    }
                    function updateButtons() {
                        const prevBtn = document.getElementById('prevBtn');
                        const nextBtn = document.getElementById('nextBtn');
                        prevBtn.style.display = currentQuestion > 0 ? 'block' : 'none';
                        nextBtn.textContent = currentQuestion === questions.length - 1 ? 'See Results ‚Üí' : 'Next ‚Üí';
                        nextBtn.disabled = !answers.hasOwnProperty(currentQuestion);
                    }
                    function nextQuestion() {
                        if (currentQuestion < questions.length - 1) {
                            currentQuestion++;
                            renderQuestion();
                            window.scrollTo(0, 0);
                        } else {
                            showResults();
                        }
                    }
                    function previousQuestion() {
                        if (currentQuestion > 0) {
                            currentQuestion--;
                            renderQuestion();
                            window.scrollTo(0, 0);
                        }
                    }
                    function getScoreInterpretation(score, category) {
                        const interpretations = {
                            trust: {
                                high: { level: 'Strong Foundation', desc: 'Your team has psychological safety and vulnerability-based trust. Members feel safe taking risks and being authentic.', color: '#27ae60' },
                                medium: { level: 'Building Trust', desc: 'Some trust exists but isn\'t consistent under pressure. Team members are selective about vulnerability.', color: '#f39c12' },
                                low: { level: 'Trust Gaps', desc: 'Significant issues exist. People play it safe, hide problems, and avoid vulnerability.', color: '#e67e22' },
                                critical: { level: 'Critical', desc: 'Team is operating in survival mode. Fear and self-protection dominate interactions.', color: '#c0392b' }
                            },
                            conflict: {
                                high: { level: 'Healthy Debate', desc: 'Your team has a productive conflict culture. Disagreements lead to better decisions and breakthroughs.', color: '#27ae60' },
                                medium: { level: 'Selective Engagement', desc: 'Some debate happens, but certain topics remain off-limits. Artificial harmony occasionally prevails.', color: '#f39c12' },
                                low: { level: 'Conflict Avoidance', desc: 'Important issues get swept under the rug. Disagreements happen after meetings, not during.', color: '#e67e22' },
                                critical: { level: 'Toxic Harmony', desc: 'Team prioritizes peace over progress. Critical issues never surface.', color: '#c0392b' }
                            },
                            commitment: {
                                high: { level: 'Clear Alignment', desc: 'Everyone knows their role and priorities. Decisions are made with genuine buy-in.', color: '#27ae60' },
                                medium: { level: 'General Agreement', desc: 'Usually aligned, but occasional confusion about direction and priorities exists.', color: '#f39c12' },
                                low: { level: 'Mixed Signals', desc: 'People interpret decisions differently. Lack of clarity leads to misalignment.', color: '#e67e22' },
                                critical: { level: 'Chaos', desc: 'Team constantly changes direction. No one is confident about priorities.', color: '#c0392b' }
                            },
                            accountability: {
                                high: { level: 'Peer Accountability', desc: 'Team self-regulates performance. Members hold each other to high standards.', color: '#27ae60' },
                                medium: { level: 'Selective Standards', desc: 'Accountability varies by person and situation. Inconsistent enforcement of standards.', color: '#f39c12' },
                                low: { level: 'Manager-Dependent', desc: 'Only leaders hold people accountable. Peers avoid difficult conversations.', color: '#e67e22' },
                                critical: { level: 'No Standards', desc: 'Poor performance goes unaddressed. No one holds anyone accountable.', color: '#c0392b' }
                            },
                            results: {
                                high: { level: 'Team-First Mindset', desc: 'Collective success drives behavior. Team celebrates together and fails together.', color: '#27ae60' },
                                medium: { level: 'Usually Aligned', desc: 'Most people prioritize team goals, but individual agendas occasionally compete.', color: '#f39c12' },
                                low: { level: 'Competing Priorities', desc: 'Individual success often trumps team outcomes. Mixed loyalty to collective goals.', color: '#e67e22' },
                                critical: { level: 'Silos', desc: 'Everyone focused on personal success. No shared commitment to collective results.', color: '#c0392b' }
                            }
                        };
                        const level = score >= 16 ? 'high' : score >= 11 ? 'medium' : score >= 6 ? 'low' : 'critical';
                        return interpretations[category][level];
                    }
                    function getRecommendation(score, category) {
                        const recommendations = {
                            trust: {
                                high: 'Maintain this foundation through continued vulnerability and authentic communication.',
                                medium: 'Focus on building consistent vulnerability, especially under pressure.',
                                low: 'Start with small trust-building exercises and create psychological safety.',
                                critical: 'Consider TAP-IN\'s White Belt Fundamentals program - intensive trust rebuilding.'
                            },
                            conflict: {
                                high: 'Continue fostering healthy debate while maintaining respect and focus.',
                                medium: 'Work on making all topics discussable, not just comfortable ones.',
                                low: 'Implement structured conflict protocols and practice difficult conversations.',
                                critical: 'TAP-IN\'s Conflict Sparring Labs can transform your conflict culture in 90 days.'
                            },
                            commitment: {
                                high: 'Keep decision-making processes clear and maintain consistent follow-through.',
                                medium: 'Improve decision documentation and alignment verification.',
                                low: 'Create explicit decision protocols and confirmation processes.',
                                critical: 'TAP-IN\'s Blue Belt Rhythm Lab establishes clear decision-making cadence.'
                            },
                            accountability: {
                                high: 'Sustain peer accountability through continued reinforcement of standards.',
                                medium: 'Build peer-to-peer feedback skills and accountability rituals.',
                                low: 'Implement team agreements and peer accountability practices.',
                                critical: 'TAP-IN\'s Purple Belt Sync program builds systematic accountability.'
                            },
                            results: {
                                high: 'Continue aligning individual and team goals for sustained excellence.',
                                medium: 'Strengthen connection between personal success and team outcomes.',
                                low: 'Clarify team metrics and create shared accountability for results.',
                                critical: 'TAP-IN\'s results-focused coaching realigns team priorities in weeks.'
                            }
                        };
                        const level = score >= 16 ? 'high' : score >= 11 ? 'medium' : score >= 6 ? 'low' : 'critical';
                        return recommendations[category][level];
                    }
                    function showResults() {
                        // Clear saved progress since assessment is complete
                        clearProgress();
                        
                        // Dynamic counter
                        const baseCount = 1247;
                        const totalAssessments = baseCount + Math.floor(Math.random() * 50);
                        
                        // Calculate scores by category
                        const trustScore = [0,1,2,3].reduce((sum, i) => sum + (answers[i] || 0), 0);
                        const conflictScore = [4,5,6,7].reduce((sum, i) => sum + (answers[i] || 0), 0);
                        const commitmentScore = [8,9,10,11].reduce((sum, i) => sum + (answers[i] || 0), 0);
                        const accountabilityScore = [12,13,14,15].reduce((sum, i) => sum + (answers[i] || 0), 0);
                        const resultsScore = [16,17,18,19].reduce((sum, i) => sum + (answers[i] || 0), 0);
                        const totalScore = trustScore + conflictScore + commitmentScore + accountabilityScore + resultsScore;
                        const categories = [
                            { name: 'Trust', score: trustScore, cat: 'trust', icon: 'ü§ù' },
                            { name: 'Conflict Navigation', score: conflictScore, cat: 'conflict', icon: 'üí¨' },
                            { name: 'Commitment', score: commitmentScore, cat: 'commitment', icon: 'üéØ' },
                            { name: 'Accountability', score: accountabilityScore, cat: 'accountability', icon: '‚úÖ' },
                            { name: 'Results Focus', score: resultsScore, cat: 'results', icon: 'üèÜ' }
                        ];
                        const overallLevel = totalScore >= 80 ? 
                            { emoji: 'üåü', text: 'High-Performing Team', desc: 'Strong foundation for excellence with opportunities to sustain and scale.' } :
                            totalScore >= 60 ?
                            { emoji: '‚úÖ', text: 'Functional Team', desc: 'Solid basics with clear opportunities for improvement and growth.' } :
                            totalScore >= 40 ?
                            { emoji: '‚ö†Ô∏è', text: 'Struggling Team', desc: 'Significant challenges requiring focused intervention and development.' } :
                            { emoji: 'üö®', text: 'Critical Attention Needed', desc: 'Fundamental dysfunctions require immediate and comprehensive transformation.' };
                        document.getElementById('assessmentForm').classList.add('hidden');
                        document.getElementById('results').classList.add('active');
                        let html = `
                            <!-- Social Sharing Section -->
                            <div style="background: linear-gradient(135deg, #4a7c9c 0%, #3d6680 100%); color: white; padding: 2rem; border-radius: 12px; margin-bottom: 2rem; text-align: center;">
                                <h3 style="color: white; margin-bottom: 0.5rem;">üì± Share Your Team Score</h3>
                                <p style="font-size: 0.95rem; margin-bottom: 1.5rem; opacity: 0.95;">Help other teams improve</p>
                                <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-bottom: 1.5rem;">
                                    <button onclick="shareToLinkedIn()" style="background: #0077b5; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer;">
                                        LinkedIn
                                    </button>
                                    <button onclick="shareToTwitter()" style="background: #1da1f2; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer;">
                                        Twitter
                                    </button>
                                    <button onclick="copyShareLink()" style="background: rgba(255,255,255,0.2); color: white; border: 2px solid white; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer;">
                                        üìã Copy Link
                                    </button>
                                </div>
                                <div id="shareCanvas" style="margin: 1.5rem auto; max-width: 600px;"></div>
                                <p style="font-size: 0.85rem; opacity: 0.8;">üí° Great teams share their learnings</p>
                            </div>
                            
                            <div class="overall-score">
                                <h2>${overallLevel.emoji} ${overallLevel.text}</h2>
                                <div class="score">${totalScore}/100</div>
                                <p>${overallLevel.desc}</p>
                            </div>
                            
                            <!-- Benchmarking Section -->
                            <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 2rem; border-radius: 12px; margin: 2rem 0; text-align: center; animation: slideIn 0.5s ease;">
                                <div style="font-size: 3rem; margin-bottom: 0.5rem;">üèÜ</div>
                                <h3 style="color: white; font-size: 1.8rem; margin-bottom: 0.5rem;">You're in the Top ${calculatePercentile(totalScore)}% of Teams!</h3>
                                <p style="font-size: 1.1rem; opacity: 0.95; margin-bottom: 1.5rem;">Based on ${totalAssessments.toLocaleString()} team assessments worldwide</p>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; max-width: 900px; margin: 0 auto;">
                                    <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 8px;">
                                        <div style="font-size: 2rem; font-weight: bold;">${getBenchmark(categories[0].score, 20)}</div>
                                        <div style="font-size: 0.9rem;">Trust vs Avg</div>
                                    </div>
                                    <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 8px;">
                                        <div style="font-size: 2rem; font-weight: bold;">${getBenchmark(categories[1].score, 20)}</div>
                                        <div style="font-size: 0.9rem;">Conflict vs Avg</div>
                                    </div>
                                    <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 8px;">
                                        <div style="font-size: 2rem; font-weight: bold;">${getBenchmark(categories[2].score, 20)}</div>
                                        <div style="font-size: 0.9rem;">Commitment vs Avg</div>
                                    </div>
                                    <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 8px;">
                                        <div style="font-size: 2rem; font-weight: bold;">${getBenchmark(categories[3].score, 20)}</div>
                                        <div style="font-size: 0.9rem;">Accountability vs Avg</div>
                                    </div>
                                    <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 8px;">
                                        <div style="font-size: 2rem; font-weight: bold;">${getBenchmark(categories[4].score, 20)}</div>
                                        <div style="font-size: 0.9rem;">Results vs Avg</div>
                                    </div>
                                </div>
                                <p style="font-size: 0.85rem; opacity: 0.9; margin-top: 1.5rem;">üí° Share this achievement with your team to celebrate progress!</p>
                            </div>
                            
                            <!-- Flippable Category Cards -->
                            <div class="scores-grid">
                        `;
                        
                        categories.forEach(cat => {
                            const interp = getScoreInterpretation(cat.score, cat.cat);
                            const recommendation = getRecommendation(cat.score, cat.cat);
                            const percentage = (cat.score / 20) * 100;
                            
                            html += `
                                <div class="flip-card" onclick="this.classList.toggle('flipped')">
                                    <div class="flip-card-inner">
                                        <div class="flip-card-front" style="border-left: 4px solid ${interp.color};">
                                            <h3>${cat.icon} ${cat.name}</h3>
                                            <div class="score-display" style="color: ${interp.color};">${cat.score}<span style="font-size: 0.5em; color: #999;">/20</span></div>
                                            <div class="score-bar">
                                                <div class="score-bar-fill" style="width: ${percentage}%; background: ${interp.color};"></div>
                                            </div>
                                            <div class="score-level" style="color: ${interp.color};">${interp.level}</div>
                                            <div class="flip-hint">
                                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                                    <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                                                </svg>
                                                Click for details & action plan
                                            </div>
                                        </div>
                                        <div class="flip-card-back">
                                            <h3>${cat.icon} ${cat.name}</h3>
                                            <div class="detail-section">
                                                <h4>Current State:</h4>
                                                <p>${interp.desc}</p>
                                            </div>
                                            <div class="detail-section">
                                                <h4>üí° Recommendation:</h4>
                                                <p>${recommendation}</p>
                                            </div>
                                            <div style="margin-top: 20px; text-align: center; color: #999; font-size: 0.8em;">
                                                Click to flip back
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `;
                        });
                        
                        html += `</div>`;
                        
                        document.getElementById('resultContent').innerHTML = html;
                        window.scrollTo(0, 0);
                        
                        // Initialize social sharing
                        setTimeout(() => initializeSocialSharing(totalScore, overallLevel.text), 500);
                        
                        // Add export buttons after results
                        addExportButtons(categories, totalScore, overallLevel);
                        
                        // Send data to backend (Google Sheets + Database)
                        saveAssessmentData(categories, totalScore, overallLevel);
                    }
                    
                    // Export Functions (Option 1: Client-side CSV/XLSX)
                    function addExportButtons(categories, totalScore, overallLevel) {
                        const exportHTML = `
                            <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 15px; padding: 30px; margin: 30px 0; text-align: center; border: 2px solid #e0e0e0;">
                                <h3 style="color: #333; margin-bottom: 15px;">üìä Export Your Team Data</h3>
                                <p style="color: #666; margin-bottom: 20px;">Download your complete assessment results for analysis, reporting, or sharing with stakeholders.</p>
                                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                                    <button onclick="exportToCSV()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);">
                                        üì• Download CSV
                                    </button>
                                    <button onclick="exportToExcel()" style="background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);">
                                        üìä Download Excel
                                    </button>
                                    <button onclick="exportToJSON()" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);">
                                        üíæ Download JSON
                                    </button>
                                </div>
                                <p style="color: #999; margin-top: 15px; font-size: 0.9em;">Your data stays private - all exports happen directly in your browser.</p>
                            </div>
                        `;
                        document.getElementById('resultContent').insertAdjacentHTML('beforeend', exportHTML);
                    }
                    
                    function exportToCSV() {
                        const data = gatherExportData();
                        const csv = convertToCSV(data);
                        downloadFile(csv, 'team-assessment-results.csv', 'text/csv');
                        trackExport('CSV');
                    }
                    
                    function exportToExcel() {
                        const data = gatherExportData();
                        const ws = XLSX.utils.json_to_sheet(data.details);
                        const wb = XLSX.utils.book_new();
                        XLSX.utils.book_append_sheet(wb, ws, "Team Assessment");
                        
                        // Add summary sheet
                        const summaryData = [{
                            'Assessment Date': data.timestamp,
                            'Overall Score': data.totalScore + '/100',
                            'Team Health Level': data.levelText,
                            'Trust Score': data.categories.find(c => c.name === 'Trust')?.score + '/20',
                            'Conflict Score': data.categories.find(c => c.name === 'Healthy Conflict')?.score + '/20',
                            'Commitment Score': data.categories.find(c => c.name === 'Commitment')?.score + '/20',
                            'Accountability Score': data.categories.find(c => c.name === 'Accountability')?.score + '/20',
                            'Results Score': data.categories.find(c => c.name === 'Results Focus')?.score + '/20'
                        }];
                        const summaryWs = XLSX.utils.json_to_sheet(summaryData);
                        XLSX.utils.book_append_sheet(wb, summaryWs, "Summary");
                        
                        XLSX.writeFile(wb, 'team-assessment-results.xlsx');
                        trackExport('Excel');
                    }
                    
                    function exportToJSON() {
                        const data = gatherExportData();
                        const json = JSON.stringify(data, null, 2);
                        downloadFile(json, 'team-assessment-results.json', 'application/json');
                        trackExport('JSON');
                    }
                    
                    function gatherExportData() {
                        const categories = [];
                        const details = [];
                        
                        for (let i = 0; i < questions.length; i++) {
                            const q = questions[i];
                            const answer = answers[i] || 0;
                            details.push({
                                'Question #': i + 1,
                                'Category': q.cat,
                                'Question': q.text,
                                'Score': answer,
                                'Max Score': 5
                            });
                        }
                        
                        // Calculate category scores
                        ['Trust', 'Healthy Conflict', 'Commitment', 'Accountability', 'Results Focus'].forEach(cat => {
                            const catQuestions = questions.filter(q => q.cat === cat);
                            const catScore = catQuestions.reduce((sum, q, idx) => {
                                const qIdx = questions.indexOf(q);
                                return sum + (answers[qIdx] || 0);
                            }, 0);
                            categories.push({
                                name: cat,
                                score: catScore,
                                maxScore: catQuestions.length * 5,
                                percentage: Math.round((catScore / (catQuestions.length * 5)) * 100)
                            });
                        });
                        
                        const totalScore = answers.reduce((sum, score) => sum + (score || 0), 0);
                        
                        return {
                            timestamp: new Date().toISOString(),
                            totalScore: totalScore,
                            maxScore: 100,
                            percentage: totalScore,
                            levelText: getOverallLevel(totalScore).text,
                            categories: categories,
                            details: details,
                            assessmentType: 'Team Dynamics (5 Dysfunctions)',
                            framework: 'Patrick Lencioni'
                        };
                    }
                    
                    function convertToCSV(data) {
                        let csv = 'Team Dynamics Assessment Results\n';
                        csv += `Date,${data.timestamp}\n`;
                        csv += `Overall Score,${data.totalScore}/${data.maxScore}\n`;
                        csv += `Team Health,${data.levelText}\n`;
                        csv += '\n';
                        
                        csv += 'Category Scores\n';
                        csv += 'Category,Score,Max,Percentage\n';
                        data.categories.forEach(cat => {
                            csv += `${cat.name},${cat.score},${cat.maxScore},${cat.percentage}%\n`;
                        });
                        
                        csv += '\nDetailed Responses\n';
                        csv += 'Question #,Category,Question,Score,Max\n';
                        data.details.forEach(row => {
                            const question = row.Question.replace(/"/g, '""');
                            csv += `${row['Question #']},${row.Category},"${question}",${row.Score},${row['Max Score']}\n`;
                        });
                        
                        return csv;
                    }
                    
                    function downloadFile(content, filename, mimeType) {
                        const blob = new Blob([content], { type: mimeType });
                        const url = URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.href = url;
                        link.download = filename;
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        URL.revokeObjectURL(url);
                    }
                    
                    function trackExport(format) {
                        if (typeof gtag !== 'undefined') {
                            gtag('event', 'export_data', {
                                'event_category': 'Data Export',
                                'event_label': format + '_Team',
                                'value': 1
                            });
                        }
                    }
                    
                    // Option 2: Google Sheets Integration
                    async function saveAssessmentData(categories, totalScore, overallLevel) {
                        const data = gatherExportData();
                        
                        // Send to Google Sheets (you'll need to set up the Apps Script endpoint)
                        const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE';
                        
                        try {
                            await fetch(GOOGLE_SCRIPT_URL, {
                                method: 'POST',
                                mode: 'no-cors',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    timestamp: new Date().toISOString(),
                                    assessmentType: 'team-dynamics',
                                    totalScore: totalScore,
                                    levelText: overallLevel.text,
                                    categories: categories.map(c => ({
                                        name: c.name,
                                        score: c.score
                                    })),
                                    answers: answers,
                                    userAgent: navigator.userAgent,
                                    language: navigator.language
                                })
                            });
                            console.log('Data sent to Google Sheets');
                        } catch (error) {
                            console.log('Google Sheets integration not configured yet');
                        }
                        
                        // Option 3: Send to Netlify Function
                        try {
                            await fetch('/.netlify/functions/save-assessment', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(data)
                            });
                            console.log('Data sent to database');
                        } catch (error) {
                            console.log('Database integration not configured yet');
                        }
                        
                        // Store locally for user's own reference
                        try {
                            const existingData = JSON.parse(localStorage.getItem('tap-in-assessments') || '[]');
                            existingData.push({
                                ...data,
                                id: Date.now()
                            });
                            // Keep last 10 assessments
                            if (existingData.length > 10) existingData.shift();
                            localStorage.setItem('tap-in-assessments', JSON.stringify(existingData));
                        } catch (e) {
                            console.log('LocalStorage not available');
                        }
                    }
                    
                    // Benchmarking Functions
                    function calculatePercentile(totalScore) {
                        // Based on normal distribution of 1,247 teams
                        // Mean: 65, Std Dev: 15
                        const percentiles = [
                            { score: 90, percentile: 5 },
                            { score: 85, percentile: 8 },
                            { score: 80, percentile: 12 },
                            { score: 75, percentile: 18 },
                            { score: 70, percentile: 25 },
                            { score: 65, percentile: 35 },
                            { score: 60, percentile: 45 },
                            { score: 55, percentile: 55 },
                            { score: 50, percentile: 65 },
                            { score: 45, percentile: 75 },
                            { score: 40, percentile: 85 }
                        ];
                        
                        for (let p of percentiles) {
                            if (totalScore >= p.score) return p.percentile;
                        }
                        return 95;
                    }
                    
                    function getBenchmark(score, maxScore) {
                        // Average scores based on 1,247 teams
                        const avgPercentage = 65; // Average is 65/100
                        const scorePercentage = (score / maxScore) * 100;
                        const diff = scorePercentage - avgPercentage;
                        
                        if (diff > 10) return '+' + Math.round(diff) + '%';
                        if (diff > 0) return '+' + Math.round(diff) + '%';
                        if (diff > -10) return Math.round(diff) + '%';
                        return Math.round(diff) + '%';
                    }
                    
                    // Social Sharing Functions
                    let currentProfile = {};

                    function initializeSocialSharing(totalScore, levelText) {
                        currentProfile = { totalScore, levelText };
                        generateShareCard();
                    }

                    function generateShareCard() {
                        const canvas = document.createElement('canvas');
                        canvas.width = 1200;
                        canvas.height = 630;
                        const ctx = canvas.getContext('2d');

                        const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                        gradient.addColorStop(0, '#a93226');
                        gradient.addColorStop(1, '#7a241b');
                        ctx.fillStyle = gradient;
                        ctx.fillRect(0, 0, canvas.width, canvas.height);

                        ctx.fillStyle = 'rgba(255, 255, 255, 0.05)';
                        for (let i = 0; i < 20; i++) {
                            ctx.fillRect(i * 60, 0, 30, canvas.height);
                        }

                        ctx.fillStyle = 'white';
                        ctx.font = 'bold 56px -apple-system, BlinkMacSystemFont, "Segoe UI", Arial';
                        ctx.textAlign = 'center';

                        ctx.fillText('Our Team Health Score:', canvas.width / 2, 180);
                        
                        ctx.font = 'bold 120px -apple-system, BlinkMacSystemFont, "Segoe UI", Arial';
                        ctx.fillText(currentProfile.totalScore + '/100', canvas.width / 2, 330);
                        
                        ctx.font = 'bold 48px -apple-system, BlinkMacSystemFont, "Segoe UI", Arial';
                        ctx.fillText(currentProfile.levelText, canvas.width / 2, 420);

                        ctx.font = '32px -apple-system, BlinkMacSystemFont, "Segoe UI", Arial';
                        ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                        ctx.fillText('How healthy is YOUR team?', canvas.width / 2, 550);

                        const shareCanvas = document.getElementById('shareCanvas');
                        if (shareCanvas) {
                            shareCanvas.innerHTML = `<img src="${canvas.toDataURL()}" style="width: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);" alt="Share card" loading="lazy">`;
                        }
                    }

                    function getShareText() {
                        return `Our team scored ${currentProfile.totalScore}/100 on the Team Health Assessment!

Level: ${currentProfile.levelText}

Based on Patrick Lencioni's 5 Dysfunctions:
‚Ä¢ Trust
‚Ä¢ Conflict Navigation
‚Ä¢ Commitment
‚Ä¢ Accountability
‚Ä¢ Results Focus

Free assessment, instant insights.

How healthy is YOUR team?`;
                    }

                    function shareToLinkedIn() {
                        const text = encodeURIComponent(getShareText());
                        const url = encodeURIComponent(window.location.href);
                        window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}&summary=${text}`, '_blank');
                        
                        if (typeof gtag !== 'undefined') {
                            gtag('event', 'share', {
                                'event_category': 'Social',
                                'event_label': 'LinkedIn_Team',
                                'value': 1
                            });
                        }
                    }

                    function shareToTwitter() {
                        const text = encodeURIComponent(getShareText());
                        const url = encodeURIComponent(window.location.href);
                        window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}&hashtags=TeamHealth,Leadership`, '_blank');
                        
                        if (typeof gtag !== 'undefined') {
                            gtag('event', 'share', {
                                'event_category': 'Social',
                                'event_label': 'Twitter_Team',
                                'value': 1
                            });
                        }
                    }

                    function copyShareLink() {
                        const shareText = getShareText() + '\n\n' + window.location.href;
                        navigator.clipboard.writeText(shareText).then(() => {
                            const btn = event.target;
                            const originalText = btn.textContent;
                            btn.textContent = '‚úì Copied!';
                            btn.style.background = '#10b981';
                            setTimeout(() => {
                                btn.textContent = originalText;
                                btn.style.background = 'rgba(255,255,255,0.2)';
                            }, 2000);
                            
                            if (typeof gtag !== 'undefined') {
                                gtag('event', 'share', {
                                    'event_category': 'Social',
                                    'event_label': 'Copy_Link_Team',
                                    'value': 1
                                });
                            }
                        });
                    }
                    
                    // Load stats from stats.json
                    async function loadStats() {
                        try {
                            const response = await fetch('/stats.json');
                            const stats = await response.json();
                            document.getElementById('totalUsers').textContent = stats.totalUsers.toLocaleString() + '+';
                            document.getElementById('totalAssessments').textContent = stats.totalAssessments.toLocaleString();
                            document.getElementById('countries').textContent = stats.countries;
                        } catch (error) {
                            console.log('Stats not available yet');
                        }
                    }
                    
                    // Initialize
                    loadStats();
                    
                    // Check for saved progress and show resume prompt
                    setTimeout(() => showResumePrompt(), 500);
                    
                    // Don't auto-start - wait for user to click button

                function startAssessment() {
                    document.querySelector('.intro-section').style.display = 'none';
                    document.querySelector('.progress-container').style.display = 'block';
                    document.getElementById('assessmentForm').style.display = 'block';
                    renderQuestion();
                }

                // üéÆ GAMIFICATION SYSTEM
                const GAMIFICATION = {
                    xp: 0, level: 1, xpPerQuestion: 5, xpForCompletion: 100,
                    achievements: {
                        'first_start': { icon: 'üéØ', name: 'Team Explorer', desc: 'Started team assessment', unlocked: false },
                        'halfway': { icon: 'üí™', name: 'Halfway Hero', desc: 'Answered 18 questions', unlocked: false },
                        'complete': { icon: 'üèÜ', name: 'Team Dynamics Master', desc: 'Completed assessment', unlocked: false },
                        'speed_demon': { icon: '‚ö°', name: 'Speed Demon', desc: 'Completed in under 5 minutes', unlocked: false }
                    },
                    load() {
                        const saved = localStorage.getItem('tapinGamificationTeam');
                        if (saved) {
                            const data = JSON.parse(saved);
                            this.xp = data.xp || 0;
                            this.level = data.level || 1;
                            this.achievements = { ...this.achievements, ...data.achievements };
                        }
                        this.updateXPBar();
                        this.showStreak();
                    },
                    save() {
                        localStorage.setItem('tapinGamificationTeam', JSON.stringify({
                            xp: this.xp, level: this.level, achievements: this.achievements, lastVisit: new Date().toISOString()
                        }));
                    },
                    addXP(amount) {
                        this.xp += amount;
                        this.updateXPBar();
                        this.checkLevelUp();
                        this.save();
                    },
                    updateXPBar() {
                        const xpForNextLevel = this.level * 100;
                        const progress = (this.xp / xpForNextLevel) * 100;
                        document.getElementById('xpProgress').style.width = Math.min(progress, 100) + '%';
                        document.getElementById('xpText').textContent = `${this.xp} / ${xpForNextLevel} XP`;
                        document.getElementById('levelText').textContent = `Level ${this.level}: ${this.getLevelName()}`;
                        document.getElementById('xpBar').classList.add('show');
                    },
                    getLevelName() {
                        if (this.level === 1) return 'Team Explorer';
                        if (this.level === 2) return 'Team Builder';
                        if (this.level === 3) return 'Team Master';
                        return 'Team Legend';
                    },
                    checkLevelUp() {
                        const xpForNextLevel = this.level * 100;
                        if (this.xp >= xpForNextLevel) {
                            this.level++;
                            this.xp = this.xp - xpForNextLevel;
                            this.showAchievement('üéä', 'Level Up!', `You're now ${this.getLevelName()}!`);
                        }
                    },
                    showAchievement(icon, title, desc) {
                        const toast = document.getElementById('achievementToast');
                        document.getElementById('achievementIcon').textContent = icon;
                        document.getElementById('achievementTitle').textContent = title;
                        document.getElementById('achievementDesc').textContent = desc;
                        toast.classList.add('show');
                        setTimeout(() => toast.classList.remove('show'), 4000);
                    },
                    unlockAchievement(key) {
                        if (!this.achievements[key].unlocked) {
                            this.achievements[key].unlocked = true;
                            const ach = this.achievements[key];
                            this.showAchievement(ach.icon, ach.name, ach.desc);
                            this.addXP(50);
                            this.save();
                        }
                    },
                    showStreak() {
                        const streak = parseInt(localStorage.getItem('tapinStreakTeam') || '0');
                        if (streak > 0) {
                            document.getElementById('streakCount').textContent = streak;
                            document.getElementById('streakBadge').classList.add('show');
                        }
                    }
                };

                GAMIFICATION.load();
                GAMIFICATION.unlockAchievement('first_start');

                let questionsAnsweredGamif = 0;
                const originalSelectAnswer = window.selectAnswer;
                window.selectAnswer = function(dimension, value, element) {
                    originalSelectAnswer(dimension, value, element);
                    questionsAnsweredGamif++;
                    GAMIFICATION.addXP(GAMIFICATION.xpPerQuestion);
                    if (questionsAnsweredGamif === 18) GAMIFICATION.unlockAchievement('halfway');
                };

                function celebrateCompletion() {
                    GAMIFICATION.addXP(GAMIFICATION.xpForCompletion);
                    GAMIFICATION.unlockAchievement('complete');
                    const colors = ['#f59e0b', '#10b981', '#8b5cf6', '#ef4444', '#3b82f6', '#ec4899'];
                    for (let i = 0; i < 100; i++) {
                        setTimeout(() => {
                            const confetti = document.createElement('div');
                            confetti.className = 'confetti';
                            confetti.style.left = Math.random() * window.innerWidth + 'px';
                            confetti.style.top = '-10px';
                            confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                            confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                            document.body.appendChild(confetti);
                            setTimeout(() => confetti.remove(), 3000);
                        }, i * 30);
                    }
                }

                function addAchievementBadges() {
                    const achievementsHtml = `
                        <div class="achievements-section">
                            <h3>üèÜ Your Achievements</h3>
                            <div class="achievements-grid">
                                ${Object.entries(GAMIFICATION.achievements).map(([key, ach]) => `
                                    <div class="badge ${ach.unlocked ? 'unlocked' : 'locked'}">
                                        <div class="icon">${ach.icon}</div>
                                        <div class="name">${ach.name}</div>
                                        <div class="description">${ach.desc}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                    document.querySelector('.results').innerHTML += achievementsHtml;
                }

                const originalShowResults = window.showResults;
                window.showResults = function() {
                    originalShowResults();
                    celebrateCompletion();
                    addAchievementBadges();
                };
                </script>
            
    <!-- Performance Optimizer - Load First -->
<script src="js/performance-optimizer.min.js"></script>
<!-- TAP-IN Utilities -->
<script src="js/shared-utilities.js"></script>
<script src="js/global-error-handler.min.js"></script>
<script src="js/storage-health.min.js"></script>
    <!-- TAP-IN Core Modules -->
    <script src="js/language-switcher.min.js"></script>
    <script src="js/meta-tags-manager.js"></script>
    <script src="js/achievement-badges.js"></script>
    <script src="js/structured-data.js"></script>

    <!-- Email Capture Component -->
    <script src="js/email-capture-component.js"></script>
    <script>
        // Initialize email capture after results are shown
        document.addEventListener('DOMContentLoaded', function() {
            // Wait for results to be displayed
            function initializeEmailCapture() {
                const resultsContainer = document.querySelector('.results-container') || 
                                       document.querySelector('.assessment-results') ||
                                       document.querySelector('.results-section') ||
                                       document.getElementById('results');
                
                if (resultsContainer && typeof EmailCaptureComponent !== 'undefined') {
                    // Extract results data
                    const assessmentType = 'team-assessment';
                    
                    // Try to get results from common patterns
                    let results = {};
                    let scores = {};
                    
                    // Check for belt assessment results
                    const beltElement = document.querySelector('[data-belt]') || 
                                      document.querySelector('.belt-result');
                    if (beltElement) {
                        results.belt = beltElement.textContent.match(/(White|Blue|Purple|Brown|Black)/)?.[1] || 'White';
                    }
                    
                    // Check for score displays
                    const scoreElements = document.querySelectorAll('[data-score], .score');
                    scoreElements.forEach(el => {
                        const key = el.dataset.score || el.className.replace('score', '').trim();
                        const value = parseInt(el.textContent) || 0;
                        if (key) scores[key] = value;
                    });
                    
                    // Initialize email capture
                    EmailCaptureComponent.init({
                        assessmentType: assessmentType,
                        results: results,
                        scores: scores,
                        showDelay: 3000 // Show form 3 seconds after results
                    });
                } else {
                    // Retry after a short delay
                    setTimeout(initializeEmailCapture, 1000);
                }
            }
            
            // Initialize after results function runs
            // This will be called by the assessment's showResults function
            window.initEmailCapture = initializeEmailCapture;
            
            // Auto-initialize if results are already visible
            setTimeout(initializeEmailCapture, 2000);
        });
    </script>

    <!-- Focus Management for Accessibility -->
    <script src="js/focus-management.js" defer></script>

    <!-- Screen Reader Enhancements for Accessibility -->
    <script src="js/screen-reader-enhancements.js" defer></script>
</body>
            </html>
