<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#2d2d2d">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="version" content="3.0.0">
    <title>F√ºhrungsstil-Assessment - TAP-IN</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 3px solid #f0f0f0;
        }

        .header h1 {
            color: #a93226;
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .header .subtitle {
            color: #666;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .header .duration {
            color: #999;
            font-size: 0.95em;
            font-style: italic;
        }

        .intro-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            border-left: 4px solid #a93226;
        }

        .intro-section h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .intro-section p {
            color: #666;
            line-height: 1.7;
            margin-bottom: 10px;
        }

        .archetypes-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .archetype-badge {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }

        .archetype-badge .icon {
            font-size: 2em;
            margin-bottom: 8px;
        }

        .archetype-badge .name {
            font-weight: bold;
            color: #333;
            font-size: 0.9em;
        }

        .question-section {
            margin-bottom: 35px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .question-section:hover {
            background: #f0f2f5;
        }

        .question-number {
            color: #a93226;
            font-weight: bold;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.2em;
            color: #333;
            margin-bottom: 20px;
            font-weight: 500;
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            display: flex;
            align-items: flex-start;
            padding: 18px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .option:hover {
            border-color: #a93226;
            background: #fff8f7;
            transform: translateX(5px);
        }

        .option input[type="radio"] {
            margin-right: 12px;
            margin-top: 4px;
            cursor: pointer;
            width: 20px;
            height: 20px;
            accent-color: #a93226;
        }

        .option-label {
            cursor: pointer;
            color: #555;
            line-height: 1.5;
            flex: 1;
        }

        .progress-bar {
            position: sticky;
            top: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 100;
        }

        .progress-text {
            text-align: center;
            color: #666;
            font-size: 0.9em;
            margin-bottom: 8px;
        }

        .progress-fill {
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill-bar {
            height: 100%;
            background: linear-gradient(90deg, #a93226, #d64436);
            width: 0%;
            transition: width 0.3s ease;
        }

        .submit-section {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #f0f0f0;
        }

        .submit-btn {
            background: linear-gradient(135deg, #a93226 0%, #7a241b 100%);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .submit-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(169, 50, 38, 0.4);
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .validation-message {
            color: #a93226;
            text-align: center;
            margin-top: 15px;
            font-weight: bold;
        }

        /* Results Styles */
        .results-container {
            display: none;
        }

        .results-container.active {
            display: block;
        }

        .results-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .results-header h2 {
            color: #a93226;
            font-size: 2.2em;
            margin-bottom: 15px;
        }

        .primary-type {
            background: linear-gradient(135deg, #a93226 0%, #7a241b 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .primary-type .icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        .primary-type h3 {
            font-size: 2em;
            margin-bottom: 15px;
        }

        .primary-type .tagline {
            font-size: 1.3em;
            opacity: 0.95;
            margin-bottom: 10px;
        }

        .primary-type .score {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .type-description {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 4px solid #a93226;
        }

        .type-description h4 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .type-description p {
            color: #666;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .type-description ul {
            margin-left: 20px;
            color: #666;
            line-height: 1.8;
        }

        .type-description ul li {
            margin-bottom: 8px;
        }

        .scores-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .score-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            text-align: center;
        }

        .score-item .icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .score-item .type-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .score-item .percentage {
            font-size: 1.8em;
            color: #a93226;
            font-weight: bold;
        }

        .score-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 5px;
            margin-top: 10px;
            overflow: hidden;
        }

        .score-bar-fill {
            height: 100%;
            background: #a93226;
            transition: width 0.5s ease;
        }

        .cta-section {
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            margin-top: 40px;
        }

        .cta-section h3 {
            font-size: 1.8em;
            margin-bottom: 15px;
        }

        .cta-section p {
            font-size: 1.1em;
            margin-bottom: 25px;
            opacity: 0.95;
        }

        .cta-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .cta-btn {
            background: white;
            color: #a93226;
            padding: 15px 30px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.2s;
            display: inline-block;
        }

        .cta-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255,255,255,0.3);
        }

        .cta-btn.secondary {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 25px;
            }

            .header h1 {
                font-size: 2em;
            }

            .question-text {
                font-size: 1.1em;
            }

            .archetypes-preview {
                grid-template-columns: 1fr 1fr;
            }

            .scores-breakdown {
                grid-template-columns: 1fr;
            }

            .cta-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- language switcher (EN / DE) -->
    <div id="lang-switch" style="position:fixed;top:16px;right:16px;z-index:1200;font-family:inherit;">
        <div style="background:white;border-radius:999px;padding:8px 12px;box-shadow:0 6px 20px rgba(0,0,0,0.15);font-size:0.95em;">
            <a href="leadership-style-assessment.html" style="color:#333;text-decoration:none;font-weight:700;margin-right:10px;">EN</a>
            <a href="leadership-style-assessment.de.html" style="color:#a93226;text-decoration:none;font-weight:700;border-left:1px solid #eee;padding-left:10px;margin-left:10px;">DE</a>
        </div>
    </div>
    <div class="container">
        <!-- Assessment Form -->
        <div id="assessmentForm">
            <div class="header">
                <h1>üéØ F√ºhrungsstil-Assessment</h1>
                <p class="subtitle">Entdecke deinen nat√ºrlichen F√ºhrungsarchetyp</p>
                <p class="duration">‚è±Ô∏è 6 Minuten ‚Ä¢ 14 Fragen</p>
            </div>

            <div class="intro-section" id="introSection">
                <h3 data-i18n="intro_heading">üåü Von Jocko zu Sinek: Was gro√üe Leader gemeinsam haben</h3>
                <p data-i18n="intro_paragraph" style="margin-bottom: 15px;"><strong>Jocko Willink</strong> (Navy SEAL) betont extreme Eigenverantwortung. <strong>Simon Sinek</strong> startet mit dem Warum. <strong>Bren√© Brown</strong> f√ºhrt durch Verletzlichkeit. <strong>Andy Grove</strong> (Intel) baute Systeme. Sie scheinen unterschiedlich‚Äîaber jeder repr√§sentiert einen <em>zeitlosen F√ºhrungsarchetyp</em>.</p>

                <p style="color: #666; line-height: 1.7; margin-bottom: 15px;">
                    Dieses Assessment enth√ºllt <strong>deinen nat√ºrlichen Stil</strong>‚Äînicht was du denkst, dass du sein solltest, sondern wie du instinktiv f√ºhrst, wenn die Eins√§tze hoch sind. Basierend auf Forschung von Harvard Business School, milit√§rischer F√ºhrungsdoktrin und 50+ Jahren Organisationspsychologie.
                </p>

                <div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <p style="font-style: italic; color: #555; font-size: 0.95em; margin-bottom: 8px;">
                        "F√ºhrung bedeutet nicht, das Sagen zu haben. Es bedeutet, sich um die zu k√ºmmern, f√ºr die man verantwortlich ist."
                    </p>
                    <p style="text-align: right; color: #888; font-size: 0.85em;">‚Äî Simon Sinek</p>
                </div>
                
                <div class="archetypes-preview">
                    <div class="archetype-badge">
                        <div class="icon">üéØ</div>
                        <div class="name" data-i18n="archetype_visionary">Vision√§rer Leader</div>
                        <div style="font-size: 0.75em; color: #888; margin-top: 5px;">MLK Jr., Mandela</div>
                    </div>
                    <div class="archetype-badge">
                        <div class="icon">üèóÔ∏è</div>
                        <div class="name" data-i18n="archetype_architect">Architekt-Stratege</div>
                        <div style="font-size: 0.75em; color: #888; margin-top: 5px;">Jobs, Grove</div>
                    </div>
                    <div class="archetype-badge">
                        <div class="icon">ü§ù</div>
                        <div class="name" data-i18n="archetype_facilitator">Facilitator-Coach</div>
                        <div style="font-size: 0.75em; color: #888; margin-top: 5px;">Rogers, Brown</div>
                    </div>
                    <div class="archetype-badge">
                        <div class="icon">‚ö°</div>
                        <div class="name" data-i18n="archetype_executor">Umsetzer-Driver</div>
                        <div style="font-size: 0.75em; color: #888; margin-top: 5px;">Willink, Ardern</div>
                    </div>
                </div>

                <p style="margin-top: 15px; padding: 12px; background: #fff8f7; border-radius: 8px; font-size: 0.9em; color: #666;">
                    <strong>Pro-Tipp:</strong> Die besten Leader entwickeln sekund√§re Stile. Jocko (Umsetzer) studierte strategisches Denken. Sinek (Vision√§r) baute Umsetzungssysteme. Kenne deine Hauptst√§rke, dann erweitere deine Reichweite.
                </p>
            </div>
            </div>

                <div class="progress-bar">
                <div class="progress-text">Fortschritt: <span id="progressText">0/14</span></div>
                <div class="progress-fill">
                    <div class="progress-fill-bar" id="progressBar"></div>
                </div>
            </div>

            <form id="leadershipForm">
                <!-- Question 1 -->
                <div class="question-section">
                    <div class="question-number">Frage 1 von 14</div>
                    <div class="question-text">Was ist dein erster Instinkt beim Start eines neuen Projekts?</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q1" value="visionary" required>
                            <span class="option-label">Das gro√üe Bild malen und das Team mit der Vision inspirieren</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q1" value="architect">
                            <span class="option-label">Das System, Prozesse und Abh√§ngigkeiten kartieren</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q1" value="facilitator">
                            <span class="option-label">Alle zusammenbringen, um Ausrichtung und Klarheit zu schaffen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q1" value="executor">
                            <span class="option-label">Quick Wins identifizieren und sofort mit der Umsetzung beginnen</span>
                        </label>
                    </div>
                </div>

                <!-- Question 2 -->
                <div class="question-section">
                    <div class="question-number">Frage 2 von 14</div>
                    <div class="question-text">Bei Teamkonflikten tendierst du dazu:</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q2" value="visionary" required>
                            <span class="option-label">Den Fokus auf die gemeinsame Mission und den gr√∂√üeren Zweck umlenken</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q2" value="architect">
                            <span class="option-label">Die Grundursache analysieren und bessere Prozesse designen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q2" value="facilitator">
                            <span class="option-label">Einen sicheren Raum schaffen, in dem alle Perspektiven geh√∂rt werden</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q2" value="executor">
                            <span class="option-label">Auf schnelle L√∂sung dr√§ngen, damit wir zur√ºck zur Arbeit k√∂nnen</span>
                        </label>
                    </div>
                </div>

                <!-- Question 3 -->
                <div class="question-section">
                    <div class="question-number">Frage 3 von 14</div>
                    <div class="question-text">Was gibt dir bei der Arbeit am meisten Energie?</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q3" value="visionary" required>
                            <span class="option-label">Andere inspirieren und Momentum in Richtung einer mutigen Zukunft schaffen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q3" value="architect">
                            <span class="option-label">Komplexe Probleme l√∂sen und elegante Systeme aufbauen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q3" value="facilitator">
                            <span class="option-label">Teammitgliedern helfen zu wachsen und effektiv zusammenzuarbeiten</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q3" value="executor">
                            <span class="option-label">Abgeschlossene Aufgaben abhaken und Ergebnisse liefern</span>
                        </label>
                    </div>
                </div>

                <!-- Question 4 -->
                <div class="question-section">
                    <div class="question-number">Frage 4 von 14</div>
                    <div class="question-text">Wie kommunizierst du wichtige Informationen am liebsten?</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q4" value="visionary" required>
                            <span class="option-label">Durch Geschichten und √ºberzeugende Narrative, die zum Handeln inspirieren</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q4" value="architect">
                            <span class="option-label">Mit detaillierten Frameworks, Diagrammen und logischer Struktur</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q4" value="facilitator">
                            <span class="option-label">Im Dialogformat, sodass alle verstehen und sich einbringen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q4" value="executor">
                            <span class="option-label">Klare Handlungsschritte, Deadlines und Verantwortlichkeiten</span>
                        </label>
                    </div>
                </div>

                <!-- Question 5 -->
                <div class="question-section">
                    <div class="question-number">Frage 5 von 14</div>
                    <div class="question-text">Bei einem gro√üen Hindernis ist dein Ansatz:</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q5" value="visionary" required>
                            <span class="option-label">Es als Chance umdeuten und das Team nach vorne f√ºhren</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q5" value="architect">
                            <span class="option-label">Es systematisch zerlegen und den Ansatz neu designen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q5" value="facilitator">
                            <span class="option-label">Das Team zusammenbringen, um gemeinsam L√∂sungen zu finden</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q5" value="executor">
                            <span class="option-label">Den schnellsten Weg drum herum oder hindurch finden</span>
                        </label>
                    </div>
                </div>

                <!-- Question 6 -->
                <div class="question-section">
                    <div class="question-number">Frage 6 von 14</div>
                    <div class="question-text">In Meetings neigst du am ehesten dazu:</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q6" value="visionary" required>
                            <span class="option-label">Das Team herausfordern, gr√∂√üer zu denken und h√∂her zu zielen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q6" value="architect">
                            <span class="option-label">Die zugrundeliegenden Annahmen und Logik hinterfragen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q6" value="facilitator">
                            <span class="option-label">Sicherstellen, dass alle Stimmen geh√∂rt werden und Perspektiven synthetisieren</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q6" value="executor">
                            <span class="option-label">Auf Entscheidungen und klare n√§chste Schritte dr√§ngen</span>
                        </label>
                    </div>
                </div>

                <!-- Question 7 -->
                <div class="question-section">
                    <div class="question-number">Frage 7 von 14</div>
                    <div class="question-text">Dein Team w√ºrde dich beschreiben als jemanden, der:</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q7" value="visionary" required>
                            <span class="option-label">M√∂glichkeiten sieht, die andere √ºbersehen, und sie erreichbar erscheinen l√§sst</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q7" value="architect">
                            <span class="option-label">Tiefgr√ºndig denkt und smarte L√∂sungen f√ºr komplexe Probleme designt</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q7" value="facilitator">
                            <span class="option-label">Verbindung und Vertrauen schafft und das Beste aus jedem herausholt</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q7" value="executor">
                            <span class="option-label">Dinge erledigt, egal welche Hindernisse auftauchen</span>
                        </label>
                    </div>
                </div>

                <!-- Question 8 -->
                <div class="question-section">
                    <div class="question-number">Frage 8 von 14</div>
                    <div class="question-text">Was frustriert dich am meisten in einem Team-Setting?</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q8" value="visionary" required>
                            <span class="option-label">Zu klein denken und sich mit inkrementellen Verbesserungen zufriedengeben</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q8" value="architect">
                            <span class="option-label">Schlampiges Denken und schlecht designte Prozesse</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q8" value="facilitator">
                            <span class="option-label">Menschen h√∂ren einander nicht zu oder arbeiten in Silos</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q8" value="executor">
                            <span class="option-label">Endlose Diskussionen ohne Entscheidungen oder Handlungen</span>
                        </label>
                    </div>
                </div>

                <!-- Question 9 -->
                <div class="question-section">
                    <div class="question-number">Frage 9 von 14</div>
                    <div class="question-text">Beim Delegieren von Arbeit konzentrierst du dich auf:</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q9" value="visionary" required>
                            <span class="option-label">Das 'Warum' und die gew√ºnschte Wirkung, dem Team das 'Wie' √ºberlassen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q9" value="architect">
                            <span class="option-label">Klare Frameworks und Entscheidungsrechte, damit Menschen unabh√§ngig arbeiten k√∂nnen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q9" value="facilitator">
                            <span class="option-label">Aufgaben an St√§rken und Entwicklungsziele der Menschen anpassen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q9" value="executor">
                            <span class="option-label">Spezifische Ergebnisse, Deadlines und Verantwortlichkeits-Checkpoints</span>
                        </label>
                    </div>
                </div>

                <!-- Question 10 -->
                <div class="question-section">
                    <div class="question-number">Frage 10 von 14</div>
                    <div class="question-text">Unter Druck tendierst du dazu:</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q10" value="visionary" required>
                            <span class="option-label">Die Vision verdoppeln und Dringlichkeit inspirieren</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q10" value="architect">
                            <span class="option-label">Zur√ºcktreten, um zu analysieren und den Ansatz neu zu designen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q10" value="facilitator">
                            <span class="option-label">Das Team sammeln und sicherstellen, dass alle ausgerichtet und unterst√ºtzt sind</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q10" value="executor">
                            <span class="option-label">In den Hochgeschwindigkeitsmodus schalten und Umsetzung unerbittlich vorantreiben</span>
                        </label>
                    </div>
                </div>

                <!-- Question 11 -->
                <div class="question-section">
                    <div class="question-number">Frage 11 von 14</div>
                    <div class="question-text">Deine ideale Arbeitsumgebung ist eine, in der:</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q11" value="visionary" required>
                            <span class="option-label">Innovation und mutige Ideen ermutigt und gefeiert werden</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q11" value="architect">
                            <span class="option-label">Systeme sauber, Prozesse optimiert sind und Logik herrscht</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q11" value="facilitator">
                            <span class="option-label">Menschen sich sicher und wertgesch√§tzt f√ºhlen und nahtlos zusammenarbeiten</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q11" value="executor">
                            <span class="option-label">Ziele klar, Momentum hoch ist und Ergebnisse schnell kommen</span>
                        </label>
                    </div>
                </div>

                <!-- Question 12 -->
                <div class="question-section">
                    <div class="question-number">Frage 12 von 14</div>
                    <div class="question-text">Beim Feedback-Geben betonst du:</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q12" value="visionary" required>
                            <span class="option-label">Die Verbindung ihrer Arbeit zur gr√∂√üeren Mission und zum Potenzial</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q12" value="architect">
                            <span class="option-label">Die Logik und das Framework hinter dem, was funktioniert und was nicht</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q12" value="facilitator">
                            <span class="option-label">Ihre Wachstumsreise und das Aufbauen ihres Selbstvertrauens</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q12" value="executor">
                            <span class="option-label">Spezifische Verhaltensweisen zum √Ñndern und zu erreichende Ergebnisse</span>
                        </label>
                    </div>
                </div>

                <!-- Question 13 -->
                <div class="insight-card">
                    <h4>üí° Erfolgskennzahlen definieren dich</h4>
                    <p>Was du misst, zeigt, was du sch√§tzt. Vision√§re verfolgen Transformation. Architekten messen Skalierbarkeit. Facilitatoren z√§hlen entwickelte Leader. Executors √ºberwachen Ergebnisse. Dein Scorecard ist nicht neutral‚Äîes formt Verhalten. W√§hle Metriken, die zu deinem Archetyp passen.</p>
                </div>

                <div class="question-section">
                    <div class="question-number">Frage 13 von 14</div>
                    <div class="question-text">Erfolg wird f√ºr dich am besten gemessen durch:</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q13" value="visionary" required>
                            <span class="option-label">Bleibende Wirkung und Transformation schaffen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q13" value="architect">
                            <span class="option-label">Systeme aufbauen, die skalieren und Bestand haben</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q13" value="facilitator">
                            <span class="option-label">Menschen entwickeln und Teamf√§higkeiten st√§rken</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q13" value="executor">
                            <span class="option-label">Ziele erreichen und greifbare Ergebnisse liefern</span>
                        </label>
                    </div>
                </div>

                <!-- Question 14 -->
                <div class="insight-card">
                    <h4>üí° Superkraft = Konstante Exzellenz</h4>
                    <p>Deine Superkraft ist nicht, was du gelegentlich tun kannst‚Äîes ist, was du <strong>konstant unter Druck</strong> lieferst. Mandela inspirierte durch Jahrzehnte im Gef√§ngnis. Jobs designte durch Misserfolg und Erfolg. Rogers verband sich 33 Jahre lang. Kenne deine Kraft. Nutze sie weise.</p>
                </div>

                <div class="question-section">
                    <div class="question-number">Frage 14 von 14</div>
                    <div class="question-text">Deine F√ºhrungssuperkraft ist:</div>
                    <div class="options">
                        <label class="option">
                            <input type="radio" name="q14" value="visionary" required>
                            <span class="option-label">Eine √ºberzeugende Zukunft malen, der Menschen folgen wollen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q14" value="architect">
                            <span class="option-label">Smarte L√∂sungen f√ºr komplexe Herausforderungen designen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q14" value="facilitator">
                            <span class="option-label">Das Beste aus Menschen herausholen und gro√üartige Teams aufbauen</span>
                        </label>
                        <label class="option">
                            <input type="radio" name="q14" value="executor">
                            <span class="option-label">Strategie durch fehlerfreie Umsetzung in Realit√§t verwandeln</span>
                        </label>
                    </div>
                </div>

                <div class="submit-section">
                    <button type="submit" class="submit-btn" id="submitBtn">Meinen F√ºhrungsstil sehen ‚Üí</button>
                    <div class="validation-message" id="validationMessage"></div>
                </div>
            </form>
        </div>

        <!-- Results Container -->
        <div id="resultsContainer" class="results-container">
            <!-- Results will be dynamically inserted here -->
        </div>
    </div>

    <script>
        // Progress tracking
        const form = document.getElementById('leadershipForm');
        const totalQuestions = 14;
        let answeredQuestions = new Set();

        // Update progress bar
        function updateProgress() {
            const answered = answeredQuestions.size;
            const percentage = (answered / totalQuestions) * 100;
            document.getElementById('progressText').textContent = `${answered}/${totalQuestions}`;
            document.getElementById('progressBar').style.width = `${percentage}%`;
        }

        // Track all radio buttons
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', function() {
                answeredQuestions.add(this.name);
                updateProgress();
                
                // Smooth scroll to next question
                const currentQuestion = this.closest('.question-section');
                const nextQuestion = currentQuestion.nextElementSibling;
                if (nextQuestion && nextQuestion.classList.contains('question-section')) {
                    setTimeout(() => {
                        nextQuestion.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }, 200);
                }
            });
        });

        // Form submission
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate all questions answered
            if (answeredQuestions.size < totalQuestions) {
                document.getElementById('validationMessage').textContent = 
                    `Bitte alle Fragen beantworten (${answeredQuestions.size}/${totalQuestions} abgeschlossen)`;
                return;
            }

            // Calculate scores
            const scores = {
                visionary: 0,
                architect: 0,
                facilitator: 0,
                executor: 0
            };

            // Count responses
            for (let i = 1; i <= totalQuestions; i++) {
                const answer = document.querySelector(`input[name="q${i}"]:checked`);
                if (answer) {
                    scores[answer.value]++;
                }
            }

            // Calculate percentages
            const total = totalQuestions;
            const percentages = {
                visionary: Math.round((scores.visionary / total) * 100),
                architect: Math.round((scores.architect / total) * 100),
                facilitator: Math.round((scores.facilitator / total) * 100),
                executor: Math.round((scores.executor / total) * 100)
            };

            // Find primary type
            const sortedTypes = Object.entries(percentages).sort((a, b) => b[1] - a[1]);
            const primaryType = sortedTypes[0][0];
            const primaryPercentage = sortedTypes[0][1];

            // Show results
            showResults(primaryType, percentages, scores);
        });

        function showResults(primaryType, percentages, scores) {
            // Hide form, show results
            document.getElementById('assessmentForm').style.display = 'none';
            const resultsContainer = document.getElementById('resultsContainer');
            resultsContainer.classList.add('active');

            // Leadership type data
            const typeData = {
                visionary: {
                    icon: 'üéØ',
                    name: 'Der Vision√§re Leader',
                    tagline: 'Du gibst Richtung vor & inspirierst andere',
                    description: 'Du f√ºhrst mit Vision und Zweck. Deine Superkraft ist es, M√∂glichkeiten zu sehen, die andere √ºbersehen, und sie erreichbar erscheinen zu lassen. Du inspirierst Teams, indem du ihre Arbeit mit einer gr√∂√üeren Mission verbindest und Momentum in Richtung mutiger Zuk√ºnfte schaffst.',
                    strengths: [
                        'Strategisches Denken und langfristige Vision',
                        'Teams inspirieren und motivieren',
                        'Ausrichtung auf gemeinsamen Zweck schaffen',
                        'Komfort mit Mehrdeutigkeit und Wandel',
                        'Storytelling und √ºberzeugende Kommunikation'
                    ],
                    challenges: [
                        'K√∂nnte operative Details √ºbersehen',
                        'Kann ungeduldig mit inkrementellem Fortschritt sein',
                        'Bewegt sich manchmal zu schnell f√ºr das Team',
                        'Muss Vision mit Umsetzung ausbalancieren'
                    ],
                    growthTips: [
                        'Partnerschaft mit Umsetzern, um Vision in Aktion zu verwandeln',
                        'Systeme mit Architekten aufbauen, um Ideen zu skalieren',
                        'Mit Facilitatoren arbeiten, um Team-Buy-in sicherzustellen',
                        '√úben, in gegenw√§rtigen Herausforderungen geerdet zu bleiben'
                    ],
                    ideal: 'Strategische F√ºhrungsrollen, Innovationsinitiativen, Transformationsprojekte, Startup-Gr√ºndung'
                },
                architect: {
                    icon: 'üèóÔ∏è',
                    name: 'Der Architekt-Stratege',
                    tagline: 'Du designst Systeme & l√∂st komplexe Probleme',
                    description: 'Du f√ºhrst mit Logik und Struktur. Deine Superkraft ist es, elegante L√∂sungen f√ºr komplexe Herausforderungen zu designen. Du excellierst darin, Frameworks zu erstellen, Prozesse zu optimieren und Systeme aufzubauen, die skalieren.',
                    strengths: [
                        'Systemdenken und strategisches Design',
                        'Analytische Probleml√∂sung',
                        'Prozessoptimierung und Effizienz',
                        'Konsequenzen und Abh√§ngigkeiten antizipieren',
                        'Klarheit aus Komplexit√§t schaffen'
                    ],
                    challenges: [
                        'K√∂nnte vor dem Handeln √ºberanalysieren',
                        'Kann als √ºberkritisch wahrgenommen werden',
                        'Untersch√§tzt manchmal Personenfaktoren',
                        'Muss Perfektion mit Fortschritt ausbalancieren'
                    ],
                    growthTips: [
                        'Partnerschaft mit Vision√§ren, um Systeme mit Zweck zu verbinden',
                        'Mit Facilitatoren arbeiten, um Adoption zu verbessern',
                        'Mit Umsetzern f√ºr schnelles Testen zusammenarbeiten',
                        '"Gut genug" Entscheidungsfindung √ºben'
                    ],
                    ideal: 'Operations-F√ºhrung, Produktstrategie, Organisationsdesign, Prozessverbesserung'
                },
                facilitator: {
                    icon: 'ü§ù',
                    name: 'Der Facilitator-Coach',
                    tagline: 'Du erm√∂glichst Teamzusammenarbeit & Entwicklung',
                    description: 'Du f√ºhrst mit Empathie und Verbindung. Deine Superkraft ist es, das Beste aus Menschen herauszuholen und Teams mit hohem Vertrauen aufzubauen. Du excellierst darin, psychologische Sicherheit zu schaffen, Talent zu entwickeln und nahtlose Zusammenarbeit zu erm√∂glichen.',
                    strengths: [
                        'Vertrauen und psychologische Sicherheit aufbauen',
                        'Menschen entwickeln und Potenzial freisetzen',
                        'Ausrichtung durch Dialog schaffen',
                        'Konfliktl√∂sung und Mediation',
                        'Starke Teamkultur aufbauen'
                    ],
                    challenges: [
                        'K√∂nnte Harmonie √ºber notwendigen Konflikt priorisieren',
                        'Kann langsam sein bei schwierigen Entscheidungen',
                        'K√§mpft manchmal mit direkter Verantwortlichkeit',
                        'Muss Unterst√ºtzung mit Herausforderung ausbalancieren'
                    ],
                    growthTips: [
                        'Partnerschaft mit Umsetzern f√ºr Verantwortlichkeit',
                        'Mit Architekten arbeiten, um Struktur hinzuzuf√ºgen',
                        'Mit Vision√§ren f√ºr mutige Ambitionen zusammenarbeiten',
                        'Direktes Feedback √ºben'
                    ],
                    ideal: 'People Leadership, Team-Coaching, Kulturtransformation, HR-F√ºhrung'
                },
                executor: {
                    icon: '‚ö°',
                    name: 'Der Umsetzer-Driver',
                    tagline: 'Du verwandelst Strategie in Realit√§t',
                    description: 'Du f√ºhrst mit Aktion und Ergebnissen. Deine Superkraft ist es, Dinge zu erledigen, egal welche Hindernisse auftauchen. Du excellierst darin, Strategie in Umsetzung zu √ºbersetzen, Momentum aufrechtzuerhalten und greifbare Ergebnisse zu liefern.',
                    strengths: [
                        'Bias f√ºr Aktion und schnelle Umsetzung',
                        'Ergebnisorientiert und zielorientiert',
                        'Hindernisse beseitigen und Fortschritt vorantreiben',
                        'Verantwortlichkeit und Follow-through',
                        'Momentum und Dringlichkeit aufrechterhalten'
                    ],
                    challenges: [
                        'K√∂nnte zu schnell ohne vollst√§ndige Ausrichtung handeln',
                        'Kann als ungeduldig wahrgenommen werden',
                        'Untersch√§tzt manchmal Prozess und Planung',
                        'Muss Geschwindigkeit mit Reflexion ausbalancieren'
                    ],
                    growthTips: [
                        'Partnerschaft mit Architekten f√ºr bessere Systeme',
                        'Mit Facilitatoren f√ºr Team-Buy-in arbeiten',
                        'Mit Vision√§ren f√ºr strategische Ausrichtung zusammenarbeiten',
                        'Entschleunigung f√ºr wichtige Entscheidungen √ºben'
                    ],
                    ideal: 'Operative F√ºhrung, Projektmanagement, Turnaround-Situationen, Operations skalieren'
                }
            };

            const data = typeData[primaryType];

            // Build results HTML
            resultsContainer.innerHTML = `
                <div class="results-header">
                    <h2>Deine F√ºhrungsstil-Ergebnisse</h2>
                </div>

                <div class="primary-type">
                    <div class="icon">${data.icon}</div>
                    <h3>${data.name}</h3>
                    <p class="tagline">${data.tagline}</p>
                    <p class="score">Prim√§rer Stil: ${percentages[primaryType]}%</p>
                </div>

                <div class="type-description">
                    <h4>Was das bedeutet</h4>
                    <p>${data.description}</p>
                </div>

                <div class="type-description">
                    <h4>Deine nat√ºrlichen St√§rken</h4>
                    <ul>
                        ${data.strengths.map(s => `<li>${s}</li>`).join('')}
                    </ul>
                </div>

                <div class="type-description">
                    <h4>Wachstumsbereiche</h4>
                    <ul>
                        ${data.challenges.map(c => `<li>${c}</li>`).join('')}
                    </ul>
                </div>

                <div class="type-description">
                    <h4>Wie du deine Wirkung verst√§rkst</h4>
                    <ul>
                        ${data.growthTips.map(t => `<li>${t}</li>`).join('')}
                    </ul>
                </div>

                <div class="type-description">
                    <h4>Wo du aufbl√ºhst</h4>
                    <p>${data.ideal}</p>
                </div>

                <div class="scores-breakdown">
                    <div class="score-item">
                        <div class="icon">üéØ</div>
                        <div class="type-name">Vision√§r</div>
                        <div class="percentage">${percentages.visionary}%</div>
                        <div class="score-bar">
                            <div class="score-bar-fill" style="width: ${percentages.visionary}%"></div>
                        </div>
                    </div>
                    <div class="score-item">
                        <div class="icon">üèóÔ∏è</div>
                        <div class="type-name">Architekt</div>
                        <div class="percentage">${percentages.architect}%</div>
                        <div class="score-bar">
                            <div class="score-bar-fill" style="width: ${percentages.architect}%"></div>
                        </div>
                    </div>
                    <div class="score-item">
                        <div class="icon">ü§ù</div>
                        <div class="type-name">Facilitator</div>
                        <div class="percentage">${percentages.facilitator}%</div>
                        <div class="score-bar">
                            <div class="score-bar-fill" style="width: ${percentages.facilitator}%"></div>
                        </div>
                    </div>
                    <div class="score-item">
                        <div class="icon">‚ö°</div>
                        <div class="type-name">Umsetzer</div>
                        <div class="percentage">${percentages.executor}%</div>
                        <div class="score-bar">
                            <div class="score-bar-fill" style="width: ${percentages.executor}%"></div>
                        </div>
                    </div>
                </div>


                <!-- Social Sharing Section -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 2rem; border-radius: 12px; margin: 2rem 0; text-align: center;">
                    <h3 style="color: white; margin-bottom: 0.5rem;">üì± Teile deinen F√ºhrungsstil</h3>
                    <p style="font-size: 0.95rem; margin-bottom: 1.5rem; opacity: 0.95;">Hilf anderen F√ºhrungskr√§ften, sich selbst zu entdecken</p>
                    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-bottom: 1.5rem;">
                        <button onclick="shareToLinkedIn()" style="background: #0077b5; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer;">
                            LinkedIn
                        </button>
                        <button onclick="shareToTwitter()" style="background: #1da1f2; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer;">
                            Twitter
                        </button>
                        <button onclick="copyShareLink()" style="background: rgba(255,255,255,0.2); color: white; border: 2px solid white; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer;">
                            üìã Link kopieren
                        </button>
                    </div>
                    <div id="shareCanvas" style="margin: 1.5rem auto; max-width: 600px;"></div>
                    <p style="font-size: 0.85rem; opacity: 0.8;">üí° 1.247+ F√ºhrungskr√§fte haben dieses Assessment gemacht</p>
                </div>

                <div class="cta-section">
                    <h3>Bereit, deine F√ºhrung zu entwickeln?</h3>
                    <p>Entdecke, wie TAP-INs Embodied Leadership Programme dir helfen k√∂nnen, deine St√§rken zu verst√§rken und ein leistungsstarkes Team aufzubauen.</p>
                    <div class="cta-buttons">
                        <a href="mailto:contact@tap-in-academy.com?subject=Leadership%20Assessment%20Follow-up%20-%20${data.name}" class="cta-btn">
                            Strategie-Sitzung buchen
                        </a>
                        <a href="combined-leadership-profile.de.html" class="cta-btn secondary">
                            Komplettes Assessment machen
                        </a>
                        <a href="index.de.html" class="cta-btn secondary">
                            Zur√ºck zur Startseite
                        </a>
                    </div>
                </div>
            `;

            // Scroll to top of results
            resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Initialize social sharing
            setTimeout(() => initializeSocialSharing(primaryType, data.name, data.icon, percentages[primaryType]), 500);
        }

        // Social Sharing Functions
        let currentProfile = {};

        function initializeSocialSharing(type, typeName, typeIcon, percentage) {
            currentProfile = { type, typeName, typeIcon, percentage };
            generateShareCard();
        }

        function generateShareCard() {
            const canvas = document.createElement('canvas');
            canvas.width = 1200;
            canvas.height = 630;
            const ctx = canvas.getContext('2d');

            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#a93226');
            gradient.addColorStop(1, '#7a241b');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = 'rgba(255, 255, 255, 0.05)';
            for (let i = 0; i < 20; i++) {
                ctx.fillRect(i * 60, 0, 30, canvas.height);
            }

            ctx.fillStyle = 'white';
            ctx.font = 'bold 56px -apple-system, BlinkMacSystemFont, "Segoe UI", Arial';
            ctx.textAlign = 'center';

            ctx.fillText('Mein F√ºhrungsstil:', canvas.width / 2, 180);
            
            ctx.font = 'bold 72px -apple-system, BlinkMacSystemFont, "Segoe UI", Arial';
            ctx.fillText(currentProfile.typeIcon + ' ' + currentProfile.typeName, canvas.width / 2, 300);
            
            ctx.font = 'bold 64px -apple-system, BlinkMacSystemFont, "Segoe UI", Arial';
            ctx.fillText(currentProfile.percentage + '% √úbereinstimmung', canvas.width / 2, 400);

            ctx.font = '32px -apple-system, BlinkMacSystemFont, "Segoe UI", Arial';
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.fillText('Was ist DEIN F√ºhrungsstil?', canvas.width / 2, 550);

            const shareCanvas = document.getElementById('shareCanvas');
            if (shareCanvas) {
                shareCanvas.innerHTML = `<img src="${canvas.toDataURL()}" style="width: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);" alt="Share card">`;
            }
        }

        function getShareText() {
            return `Ich habe gerade entdeckt, dass ich ein ${currentProfile.typeName} bin (${currentProfile.percentage}% √úbereinstimmung)!

Was ist DEIN F√ºhrungsstil? ${currentProfile.typeIcon}

‚ú® 4 F√ºhrungs-Archetypen
üìä Instant-Insights
üéØ Kostenlose Bewertung

1.247+ F√ºhrungskr√§fte haben ihr Profil bereits entdeckt.`;
        }

        function shareToLinkedIn() {
            const text = encodeURIComponent(getShareText());
            const url = encodeURIComponent(window.location.href);
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}&summary=${text}`, '_blank');
            
            if (typeof gtag !== 'undefined') {
                gtag('event', 'share', {
                    'event_category': 'Social',
                    'event_label': 'LinkedIn_Leadership_DE',
                    'value': 1
                });
            }
        }

        function shareToTwitter() {
            const text = encodeURIComponent(getShareText());
            const url = encodeURIComponent(window.location.href);
            window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}&hashtags=F√ºhrungsstil,Leadership`, '_blank');
            
            if (typeof gtag !== 'undefined') {
                gtag('event', 'share', {
                    'event_category': 'Social',
                    'event_label': 'Twitter_Leadership_DE',
                    'value': 1
                });
            }
        }

        function copyShareLink() {
            const shareText = getShareText() + '

' + window.location.href;
            navigator.clipboard.writeText(shareText).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úì Kopiert!';
                btn.style.background = '#10b981';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = 'rgba(255,255,255,0.2)';
                }, 2000);
                
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'share', {
                        'event_category': 'Social',
                        'event_label': 'Copy_Link_Leadership_DE',
                        'value': 1
                    });
                }
            });
        }
    
    // Export Functions (Option 1: Client-Side CSV/XLSX)
    function addExportButtons(data) {
        const exportHTML = `
            <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 15px; padding: 30px; margin: 30px 0; text-align: center; border: 2px solid #e0e0e0;">
                <h3 style="color: #333; margin-bottom: 15px;">üìä Export Your Results</h3>
                <p style="color: #666; margin-bottom: 20px;">Download your complete assessment results for analysis, reporting, or personal records.</p>
                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                    <button onclick="exportToCSV()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);">
                        üì• Download CSV
                    </button>
                    <button onclick="exportToExcel()" style="background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);">
                        üìä Download Excel
                    </button>
                    <button onclick="exportToJSON()" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);">
                        üíæ Download JSON
                    </button>
                </div>
                <p style="color: #999; margin-top: 15px; font-size: 0.9em;">Your data stays private - all exports happen directly in your browser.</p>
            </div>
        `;
        const resultContainer = document.getElementById('resultContent') || document.querySelector('.result-display') || document.querySelector('.results-container');
        if (resultContainer) {
            resultContainer.insertAdjacentHTML('beforeend', exportHTML);
        }
    }
    
    function exportToCSV() {
        const data = gatherExportData();
        const csv = convertToCSV(data);
        downloadFile(csv, 'assessment-results-' + Date.now() + '.csv', 'text/csv');
        trackExport('CSV');
    }
    
    function exportToExcel() {
        const data = gatherExportData();
        const ws = XLSX.utils.json_to_sheet(data.details || [data]);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Assessment Results");
        
        // Add summary sheet if categories exist
        if (data.categories && data.categories.length > 0) {
            const summaryData = [{
                'Assessment Date': data.timestamp,
                'Overall Score': (data.totalScore || data.score) + '/' + (data.maxScore || 100),
                'Level': data.levelText || data.type || ''
            }];
            data.categories.forEach(cat => {
                summaryData[0][cat.name + ' Score'] = cat.score + '/' + cat.maxScore;
            });
            const summaryWs = XLSX.utils.json_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(wb, summaryWs, "Summary");
        }
        
        XLSX.writeFile(wb, 'assessment-results-' + Date.now() + '.xlsx');
        trackExport('Excel');
    }
    
    function exportToJSON() {
        const data = gatherExportData();
        const json = JSON.stringify(data, null, 2);
        downloadFile(json, 'assessment-results-' + Date.now() + '.json', 'application/json');
        trackExport('JSON');
    }
    
    function convertToCSV(data) {
        let csv = (data.assessmentType || 'Assessment') + ' Results\n';
        csv += `Date,${data.timestamp}
`;
        csv += `Score,${(data.totalScore || data.score)}/${(data.maxScore || 100)}
`;
        csv += `Level,${data.levelText || data.type || ''}
`;
        csv += '\n';
        
        if (data.categories && data.categories.length > 0) {
            csv += 'Category Scores\n';
            csv += 'Category,Score,Max,Percentage\n';
            data.categories.forEach(cat => {
                csv += `${cat.name},${cat.score},${cat.maxScore},${cat.percentage}%
`;
            });
            csv += '\n';
        }
        
        if (data.details && data.details.length > 0) {
            csv += 'Detailed Responses\n';
            const headers = Object.keys(data.details[0]);
            csv += headers.join(',') + '\n';
            data.details.forEach(row => {
                const values = headers.map(h => {
                    let v = row[h];
                    if (typeof v === 'string') v = v.replace(/"/g, '""');
                    return `"${v}"`;
                });
                csv += values.join(',') + '\n';
            });
        }
        
        return csv;
    }
    
    function downloadFile(content, filename, mimeType) {
        const blob = new Blob([content], { type: mimeType });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = filename;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    }
    
    function trackExport(format) {
        if (typeof gtag !== 'undefined') {
            gtag('event', 'export_data', {
                'event_category': 'Data Export',
                'event_label': format + '_Assessment',
                'value': 1
            });
        }
    }
    
    // Backend data collection (Google Sheets + Database)
    async function saveAssessmentData(data) {
        const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE';
        
        try {
            await fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    ...data,
                    userAgent: navigator.userAgent,
                    language: navigator.language
                })
            });
        } catch (error) {
            console.log('Google Sheets not configured');
        }
        
        try {
            await fetch('/.netlify/functions/save-assessment', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
        } catch (error) {
            console.log('Database not configured');
        }
        
        try {
            const existing = JSON.parse(localStorage.getItem('tap-in-assessments') || '[]');
            existing.push({ ...data, id: Date.now() });
            if (existing.length > 10) existing.shift();
            localStorage.setItem('tap-in-assessments', JSON.stringify(existing));
        } catch (e) {}
    }

    </script>
</body>
</html>
