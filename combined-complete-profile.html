<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#1a365d">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="TAP-IN Complete">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icon-192.png">
    <title>Complete Impact Profile - TAP-IN</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            -webkit-tap-highlight-color: rgba(26, 54, 93, 0.2);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .container { max-width: 800px; margin: 0 auto; }
        
        /* Hamburger Menu */
        .menu-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 2001;
            background: white;
            border: none;
            border-radius: 12px;
            padding: 12px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        .menu-toggle:hover { background: #f8f9fa; transform: scale(1.05); }
        .menu-toggle span {
            display: block;
            width: 25px;
            height: 3px;
            background: #1a365d;
            margin: 5px 0;
            transition: all 0.3s;
            border-radius: 2px;
        }
        .menu-toggle.active span:nth-child(1) { transform: rotate(45deg) translate(8px, 8px); }
        .menu-toggle.active span:nth-child(2) { opacity: 0; }
        .menu-toggle.active span:nth-child(3) { transform: rotate(-45deg) translate(7px, -7px); }
        
        .slide-menu {
            position: fixed;
            top: 0;
            left: -320px;
            width: 320px;
            height: 100vh;
            background: white;
            box-shadow: 4px 0 20px rgba(0,0,0,0.3);
            z-index: 2000;
            transition: left 0.3s ease;
            overflow-y: auto;
            padding: 80px 0 30px;
        }
        .slide-menu.active { left: 0; }
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            z-index: 1999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        .menu-overlay.active { opacity: 1; pointer-events: auto; }
        .logo {
            font-size: 1.5em;
            font-weight: bold;
            color: #1a365d;
            padding: 0 25px 20px;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 10px;
        }
        .menu-section {
            padding: 20px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .menu-section:last-child { border-bottom: none; }
        .menu-section-title {
            font-size: 0.75em;
            font-weight: bold;
            color: #999;
            text-transform: uppercase;
            padding: 0 25px 10px;
            letter-spacing: 0.5px;
        }
        .menu-section a {
            display: flex;
            align-items: center;
            padding: 12px 25px;
            color: #333;
            text-decoration: none;
            font-size: 1em;
            transition: all 0.2s;
            gap: 12px;
        }
        .menu-section a:hover {
            background: rgba(26,54,93,0.05);
            color: #1a365d;
            padding-left: 30px;
        }
        .menu-section a.primary {
            background: linear-gradient(135deg, #1a365d 0%, #0f1f3d 100%);
            color: white;
            margin: 10px 15px;
            border-radius: 10px;
            font-weight: 600;
        }
        .menu-section a.primary:hover {
            padding-left: 25px;
            transform: scale(1.02);
        }
        
        /* Language Switcher */
        .lang-switch {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2000;
            background: white;
            border-radius: 25px;
            padding: 8px 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }
        .lang-switch a {
            color: #666;
            text-decoration: none;
            font-weight: 600;
            padding: 5px 10px;
            transition: all 0.2s;
        }
        .lang-switch a.active { color: #1a365d; }
        .lang-switch a:hover { color: #1a365d; }
        
        .header {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .header h1 {
            color: #1a365d;
            font-size: 2.5em;
            margin-bottom: 20px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }
        .header .subtitle {
            color: #64748b;
            font-size: 1.15em;
            line-height: 1.7;
            margin-bottom: 25px;
            font-weight: 400;
        }
        .header .note {
            background: #f8fafc;
            padding: 16px 20px;
            border-radius: 8px;
            border-left: 3px solid #1a365d;
            color: #475569;
            font-size: 0.95em;
        }
        
        /* Overall Progress */
        .overall-progress {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .overall-progress h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        .progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 12px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        .progress-fill {
            background: linear-gradient(90deg, #1a365d 0%, #334155 100%);
            height: 100%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }
        .progress-text {
            text-align: center;
            color: #64748b;
            font-size: 0.9em;
            margin-top: 8px;
            font-variant-numeric: tabular-nums;
        }
        .assessment-sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .section-badge {
            background: #f8fafc;
            padding: 18px 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: all 0.3s;
        }
        .section-badge.completed {
            border-color: #10b981;
            background: #f0fdf4;
        }
        .section-badge.active {
            border-color: #1a365d;
            background: #f1f5f9;
        }
        .section-badge .icon {
            font-size: 1.8em;
            margin-bottom: 10px;
            opacity: 0.8;
        }
        .section-badge .title {
            font-weight: 600;
            color: #1e293b;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        .section-badge .status {
            font-size: 0.8em;
            color: #64748b;
            margin-top: 5px;
            font-variant-numeric: tabular-nums;
        }
        
        /* Question Card */
        .question-card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            display: none;
        }
        .question-card.active {
            display: block;
            animation: slideIn 0.4s ease;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-header {
            background: linear-gradient(135deg, #1a365d 0%, #334155 100%);
            color: white;
            padding: 14px 24px;
            border-radius: 8px;
            margin-bottom: 30px;
            font-size: 1em;
            font-weight: 600;
            letter-spacing: 0.3px;
        }
        
        .question-number {
            color: #94a3b8;
            font-size: 0.85em;
            margin-bottom: 12px;
            font-variant-numeric: tabular-nums;
            letter-spacing: 0.5px;
        }
        .question-text {
            color: #1e293b;
            font-size: 1.5em;
            font-weight: 600;
            margin-bottom: 35px;
            line-height: 1.4;
            letter-spacing: -0.3px;
        }
        
        /* Answer Options */
        .answer-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 35px;
        }
        .answer-option {
            background: #ffffff;
            padding: 18px 22px;
            border-radius: 8px;
            cursor: pointer;
            border-left: 3px solid #e2e8f0;
            border-top: 1px solid #e2e8f0;
            border-right: 1px solid #e2e8f0;
            border-bottom: 1px solid #e2e8f0;
            transition: all 0.2s;
            font-size: 1em;
            color: #334155;
            font-weight: 400;
        }
        .answer-option:hover {
            border-left-color: #1a365d;
            border-left-width: 3px;
            background: #f8fafc;
        }
        .answer-option.selected {
            border-left-color: #1a365d;
            border-left-width: 4px;
            background: #f1f5f9;
            font-weight: 500;
            color: #1e293b;
        }
        .answer-option:focus {
            outline: 2px solid #1a365d;
            outline-offset: 2px;
        }
        
        /* Scale Options (for team assessment) */
        .scale-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 35px;
        }
        .scale-option {
            background: #ffffff;
            padding: 18px 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            border: 2px solid #e2e8f0;
            transition: all 0.2s;
            touch-action: manipulation;
            -webkit-user-select: none;
            user-select: none;
            min-height: 44px;
        }
        .scale-option:hover {
            border-color: #1a365d;
            background: #f8fafc;
        }
        .scale-option:active {
            transform: scale(0.98);
        }
        .scale-option.selected {
            border-color: #1a365d;
            border-width: 2px;
            background: #f1f5f9;
            box-shadow: 0 2px 8px rgba(26, 54, 93, 0.15);
        }
        .scale-value {
            font-size: 1.6em;
            font-weight: 600;
            color: #1a365d;
            margin-bottom: 5px;
        }
        .scale-label {
            font-size: 0.8em;
            color: #64748b;
            font-weight: 500;
        }
        
        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            gap: 12px;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #e2e8f0;
        }
        .nav-btn {
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            min-width: 110px;
        }
        .nav-btn.prev {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #cbd5e1;
        }
        .nav-btn.prev:hover {
            background: #e2e8f0;
            border-color: #94a3b8;
        }
        .nav-btn.next {
            background: linear-gradient(135deg, #1a365d 0%, #334155 100%);
            color: white;
            margin-left: auto;
        }
        .nav-btn.next:hover {
            box-shadow: 0 4px 12px rgba(26, 54, 93, 0.25);
        }
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .nav-btn:focus {
            outline: 2px solid #1a365d;
            outline-offset: 2px;
        }
        
        /* Results */
        .results {
            display: none;
        }
        .results.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .results-header {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .results-header h2 {
            color: #1a365d;
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        .result-section {
            background: white;
            padding: 35px;
            border-radius: 20px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .result-section h3 {
            color: #1a365d;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        .result-badge {
            display: inline-block;
            font-size: 3em;
            padding: 20px;
            background: linear-gradient(135deg, #fff8f7 0%, #ffe8e6 100%);
            border-radius: 20px;
            margin: 20px 0;
        }
        
        /* Insight Card Styles */
        .insight-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-left: 4px solid #1a365d;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            animation: fadeIn 0.5s ease;
        }
        .insight-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            display: block;
        }
        .insight-title {
            font-size: 1.4em;
            font-weight: 700;
            color: #1a365d;
            margin-bottom: 15px;
            line-height: 1.3;
        }
        .insight-content {
            color: #475569;
            line-height: 1.8;
            margin-bottom: 15px;
            font-size: 1.05em;
        }
        .insight-quote {
            font-style: italic;
            color: #64748b;
            padding: 15px 20px;
            background: white;
            border-left: 3px solid #1a365d;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 0.98em;
            line-height: 1.7;
        }
        .insight-reflection {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        .insight-reflection h4 {
            color: #1a365d;
            font-size: 1.1em;
            margin-bottom: 12px;
            font-weight: 600;
        }
        .insight-reflection ul {
            list-style: none;
            padding-left: 0;
        }
        .insight-reflection li {
            color: #475569;
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
            line-height: 1.6;
        }
        .insight-reflection li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #1a365d;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            body { padding: 10px; }
            .header { padding: 25px; border-radius: 15px; }
            .header h1 { font-size: 1.8em; }
            .header p { font-size: 1em; }
            .section-progress { flex-direction: column; }
            .section-indicator-item { min-width: 100%; }
            .progress-bar-container { padding: 15px; }
            .question-card { padding: 25px; border-radius: 15px; }
            .question-text { font-size: 1.2em; line-height: 1.4; }
            .scale-options { 
                grid-template-columns: repeat(5, 1fr); 
                gap: 8px; 
            }
            .scale-option { 
                padding: 12px 8px; 
                border-radius: 8px;
            }
            .scale-number { font-size: 1.2em; }
            .scale-label { font-size: 0.7em; }
            .scale-labels { font-size: 0.75em; }
            .nav-buttons { flex-direction: column; gap: 10px; }
            .nav-btn { width: 100%; padding: 15px; }
            .nav-btn.next { margin-left: 0; }
            .celebration-card { padding: 40px 25px; }
            .celebration-card h2 { font-size: 2em; }
            .celebration-card p { font-size: 1.1em; }
            .results-header { padding: 25px; }
            .results-header h2 { font-size: 2em; }
            .result-section { padding: 25px; }
            .result-section h3 { font-size: 1.5em; }
        }
        .achievement-toast{position:fixed;top:80px;right:20px;background:linear-gradient(135deg,#4a7c9c 0%,#3d6680 100%);color:white;padding:20px 25px;border-radius:12px;box-shadow:0 8px 32px rgba(102,126,234,0.4);z-index:10000;min-width:300px;animation:slideInRight 0.5s ease-out;}.achievement-toast.show{display:block;}@keyframes slideInRight{from{transform:translateX(400px);opacity:0;}to{transform:translateX(0);opacity:1;}}.achievement-icon{font-size:2.5em;margin-bottom:10px;}.achievement-title{font-size:1.2em;font-weight:700;margin-bottom:5px;}.achievement-desc{font-size:0.9em;opacity:0.95;}.confetti{position:fixed;width:10px;height:10px;background:#4a7c9c;z-index:9999;}.xp-bar{position:fixed;top:20px;left:50%;transform:translateX(-50%);background:white;padding:15px 25px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.15);z-index:1000;min-width:320px;text-align:center;}.xp-bar .level{font-weight:700;color:#1a365d;margin-bottom:8px;font-size:0.95em;}.progress-container{background:#e2e8f0;border-radius:10px;height:12px;overflow:hidden;margin-bottom:8px;}.progress-fill{background:linear-gradient(90deg,#4a7c9c 0%,#3d6680 100%);height:100%;border-radius:10px;transition:width 0.3s ease;}.xp-text{font-size:0.85em;color:#64748b;font-weight:600;}.achievements-section{margin-top:40px;padding:30px;background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);border-radius:15px;}.achievements-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-top:20px;}.badge{background:white;padding:25px;border-radius:12px;text-align:center;box-shadow:0 4px 15px rgba(0,0,0,0.1);transition:transform 0.2s;}.badge:hover{transform:translateY(-5px);}.badge.unlocked{border:2px solid #4a7c9c;}.badge.locked{opacity:0.4;border:2px solid #cbd5e1;}.badge-icon{font-size:3em;margin-bottom:10px;}.badge-name{font-weight:700;color:#1a365d;margin-bottom:5px;}.badge-desc{font-size:0.85em;color:#64748b;}.streak-badge{position:fixed;top:20px;left:20px;background:white;padding:12px 20px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.15);z-index:1000;display:flex;align-items:center;gap:10px;}.streak-badge .fire{font-size:1.5em;}.streak-badge .streak-text{font-weight:700;color:#1a365d;}
    </style>
</head>
<body>
    <div class="xp-bar" id="xpBar" style="display:none;">
        <div class="level">Level 1: Profile Explorer</div>
        <div class="progress-container">
            <div class="progress-fill" style="width: 0%"></div>
        </div>
        <div class="xp-text">0 / 100 XP</div>
    </div>
    <div class="streak-badge" id="streakBadge" style="display:none;">
        <div class="fire">üî•</div>
        <div class="streak-text"><span id="streakCount">0</span> Day Streak</div>
    </div>
    <div class="achievement-toast" id="achievementToast" style="display:none;">
        <div class="achievement-icon" id="toastIcon">üèÜ</div>
        <div class="achievement-title" id="toastTitle">Achievement Unlocked!</div>
        <div class="achievement-desc" id="toastDesc">You've earned a new badge</div>
    </div>
    <!-- Hamburger Menu -->
    <button class="menu-toggle" id="menuToggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <!-- Menu Overlay -->
    <div class="menu-overlay" id="menuOverlay"></div>

    <!-- Slide-out Menu -->
    <nav class="slide-menu" id="slideMenu">
        <div class="logo">üéØ TAP-IN</div>
        
        <div class="menu-section">
            <div class="menu-section-title">Main</div>
            <a href="gym-dashboard.html" class="primary">ü•ã The GYM Dashboard</a>
            <a href="team-dashboard.html">üè¢ Team Dashboard</a>
            <a href="recruiter-portal.html">üéØ Recruiter Portal</a>
        </div>

        <div class="menu-section">
            <div class="menu-section-title">Assessments</div>
            <a href="worker-type-assessment.html">üë§ Worker Type</a>
            <a href="leadership-style-carousel.html">üéØ Leadership Style</a>
            <a href="team-assessment-enhanced-v2.html">üë• Team Dynamics</a>
            <a href="combined-complete-profile.html">‚≠ê Complete Profile</a>
        </div>

        <div class="menu-section">
            <div class="menu-section-title">Analytics & Insights</div>
            <a href="advanced-analytics.html">üìà Advanced Analytics</a>
            <a href="achievement-badges.html">üèÜ Achievements</a>
            <a href="goals.html">üéØ Goals & Progress</a>
        </div>

        <div class="menu-section">
            <div class="menu-section-title">Management Tools</div>
            <a href="data-manager.html">üíæ Data Manager</a>
            <a href="notifications.html">üîî Notifications</a>
            <a href="calendar-integration.html">üìÖ Calendar</a>
        </div>

        <div class="menu-section">
            <div class="menu-section-title">Settings</div>
            <a href="white-label-customization.html">üé® White Label</a>
            <a href="QUICK-ADD-DEMO-DATA.html">üé¨ Demo Data</a>
        </div>
    </nav>

    <!-- Language Switcher -->
    <div class="lang-switch">
        <a href="combined-complete-profile.html" class="active">EN</a>
        <span style="color: #ddd;">|</span>
        <a href="combined-complete-profile.de.html">DE</a>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Complete Impact Profile</h1>
            <p class="subtitle">
                Discover your complete professional DNA through three powerful assessments: Worker Type, Team Impact Style, and Team Dynamics.
            </p>
            <div class="note">
                ‚è± <strong>Takes 18 minutes</strong> ‚Ä¢ 46 questions total ‚Ä¢ One question at a time
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-primary" onclick="startAssessment()" style="font-size: 1.2em; padding: 18px 50px;">
                    Start Complete Profile ‚Üí
                </button>
            </div>
        </div>

        <!-- Overall Progress -->
        <div class="overall-progress" id="overallProgress" style="display: none;">
            <h3>Your Progress</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="overallProgressFill" style="width: 0%"></div>
            </div>
            <div class="progress-text">
                Question <span id="currentQuestionNum">0</span> of <span id="totalQuestions">46</span>
            </div>
            
            <div class="assessment-sections">
                <div class="section-badge active" id="section1Badge">
                    <div class="icon">‚óè</div>
                    <div class="title">Worker Type</div>
                    <div class="status">0/12</div>
                </div>
                <div class="section-badge" id="section2Badge">
                    <div class="icon">‚óã</div>
                    <div class="title">Team Impact Style</div>
                    <div class="status">0/14</div>
                </div>
                <div class="section-badge" id="section3Badge">
                    <div class="icon">‚óã</div>
                    <div class="title">Team Dynamics</div>
                    <div class="status">0/20</div>
                </div>
            </div>
        </div>

        <!-- Question Cards Container -->
        <div id="questionsContainer" style="display: none;"></div>

        <!-- Results Section -->
        <div class="results" id="results">
            <div class="results-header">
                <h2>üéâ Your Complete Leadership Profile</h2>
                <p style="color: #666; font-size: 1.1em; margin-top: 10px;">
                    Here's your comprehensive analysis across all three dimensions
                </p>
            </div>

            <div id="resultsContent"></div>

            <div class="result-section" style="text-align: center;">
                <a href="gym-dashboard.html" class="nav-btn next" style="display: inline-block; text-decoration: none;">
                    View Full Dashboard ‚Üí
                </a>
            </div>
        </div>
    </div>

    <script>
        // Assessment Data Structure
        const assessmentData = {
            section1: {
                title: "Worker Type Assessment",
                icon: "üë§",
                questions: [
                    {
                        text: "How do you prefer to approach work projects?",
                        options: [
                            { text: "Intense bursts of productivity, then take a break", type: "sprinter" },
                            { text: "Steady, consistent pace throughout", type: "jogger" },
                            { text: "Marathon sessions when deeply engaged", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "What's your ideal work schedule?",
                        options: [
                            { text: "Short, focused sprints with clear deadlines", type: "sprinter" },
                            { text: "Regular 9-5 with predictable routine", type: "jogger" },
                            { text: "Long, immersive sessions when inspired", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "How do you handle multiple projects?",
                        options: [
                            { text: "Tackle them one at a time, intensely", type: "sprinter" },
                            { text: "Balance them evenly across my time", type: "jogger" },
                            { text: "Deep dive into one until completion", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "What energizes you most at work?",
                        options: [
                            { text: "Quick wins and immediate results", type: "sprinter" },
                            { text: "Making steady progress every day", type: "jogger" },
                            { text: "Being fully absorbed in challenging work", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "How do you recharge after work?",
                        options: [
                            { text: "I need frequent breaks between intense work", type: "sprinter" },
                            { text: "A relaxing evening after a productive day", type: "jogger" },
                            { text: "I often don't need to‚ÄîI'm still energized", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "What's your relationship with deadlines?",
                        options: [
                            { text: "I thrive under pressure and tight deadlines", type: "sprinter" },
                            { text: "I work steadily to meet them comfortably", type: "jogger" },
                            { text: "I lose track of time when deeply engaged", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "How do you handle creative work?",
                        options: [
                            { text: "Burst of intense creativity, then step back", type: "sprinter" },
                            { text: "Allocate specific time for creative thinking", type: "jogger" },
                            { text: "Get into flow state for hours", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "What's your preferred meeting style?",
                        options: [
                            { text: "Short, action-oriented stand-ups", type: "sprinter" },
                            { text: "Scheduled, well-structured meetings", type: "jogger" },
                            { text: "Deep-dive strategy sessions", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "How do you learn new skills?",
                        options: [
                            { text: "Intensive bootcamps or workshops", type: "sprinter" },
                            { text: "Regular practice over time", type: "jogger" },
                            { text: "Total immersion until mastery", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "What's your ideal work environment?",
                        options: [
                            { text: "Dynamic with variety and change", type: "sprinter" },
                            { text: "Stable and predictable", type: "jogger" },
                            { text: "Quiet space for deep focus", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "How do you measure success?",
                        options: [
                            { text: "Quick, visible achievements", type: "sprinter" },
                            { text: "Consistent progress toward goals", type: "jogger" },
                            { text: "Depth and quality of work", type: "ultrarunner" }
                        ]
                    },
                    {
                        text: "What's your communication preference?",
                        options: [
                            { text: "Quick messages and rapid responses", type: "sprinter" },
                            { text: "Scheduled check-ins and updates", type: "jogger" },
                            { text: "In-depth conversations when needed", type: "ultrarunner" }
                        ]
                    }
                ]
            },
            section2: {
                title: "Team Impact Style Assessment",
                icon: "üéØ",
                questions: [
                    {
                        text: "When faced with a major decision, what's your first instinct?",
                        options: [
                            { text: "Paint the big picture and long-term vision", type: "visionary" },
                            { text: "Map out systems and processes", type: "architect" },
                            { text: "Bring people together to discuss", type: "facilitator" },
                            { text: "Focus on action steps and execution", type: "executor" },
                            { text: "Make the call and drive forward", type: "commander" },
                            { text: "Consider team development opportunities", type: "coach" }
                        ]
                    },
                    {
                        text: "What energizes you most as a leader?",
                        options: [
                            { text: "Inspiring others with possibility", type: "visionary" },
                            { text: "Building robust frameworks", type: "architect" },
                            { text: "Creating harmony and collaboration", type: "facilitator" },
                            { text: "Delivering tangible results", type: "executor" },
                            { text: "Overcoming challenges decisively", type: "commander" },
                            { text: "Developing people's potential", type: "coach" }
                        ]
                    },
                    {
                        text: "How do you approach team meetings?",
                        options: [
                            { text: "Share inspiring vision and strategy", type: "visionary" },
                            { text: "Review structures and workflows", type: "architect" },
                            { text: "Ensure everyone's voice is heard", type: "facilitator" },
                            { text: "Focus on action items and accountability", type: "executor" },
                            { text: "Make decisions and assign tasks", type: "commander" },
                            { text: "Use them as coaching opportunities", type: "coach" }
                        ]
                    },
                    {
                        text: "What's your leadership blind spot?",
                        options: [
                            { text: "Getting lost in future possibilities", type: "visionary" },
                            { text: "Over-engineering solutions", type: "architect" },
                            { text: "Avoiding necessary conflict", type: "facilitator" },
                            { text: "Focusing too much on tasks vs. people", type: "executor" },
                            { text: "Being too directive or impatient", type: "commander" },
                            { text: "Spending too much time developing others", type: "coach" }
                        ]
                    },
                    {
                        text: "How do you handle conflict in your team?",
                        options: [
                            { text: "Refocus on shared vision", type: "visionary" },
                            { text: "Create clear processes to prevent it", type: "architect" },
                            { text: "Mediate and find common ground", type: "facilitator" },
                            { text: "Address it directly and move on", type: "executor" },
                            { text: "Make a firm decision to resolve it", type: "commander" },
                            { text: "Use it as a growth opportunity", type: "coach" }
                        ]
                    },
                    {
                        text: "What motivates your work as a leader?",
                        options: [
                            { text: "Creating transformative change", type: "visionary" },
                            { text: "Building something that lasts", type: "architect" },
                            { text: "Fostering strong relationships", type: "facilitator" },
                            { text: "Achieving concrete outcomes", type: "executor" },
                            { text: "Winning and being the best", type: "commander" },
                            { text: "Seeing others succeed and grow", type: "coach" }
                        ]
                    },
                    {
                        text: "How do you communicate expectations?",
                        options: [
                            { text: "Through inspiring stories and vision", type: "visionary" },
                            { text: "With detailed documentation", type: "architect" },
                            { text: "Through collaborative discussions", type: "facilitator" },
                            { text: "Clear objectives and metrics", type: "executor" },
                            { text: "Direct commands and directives", type: "commander" },
                            { text: "Personalized conversations", type: "coach" }
                        ]
                    },
                    {
                        text: "What's your approach to strategic planning?",
                        options: [
                            { text: "Start with inspiring future state", type: "visionary" },
                            { text: "Design comprehensive frameworks", type: "architect" },
                            { text: "Gather input from stakeholders", type: "facilitator" },
                            { text: "Focus on executable milestones", type: "executor" },
                            { text: "Set ambitious goals and push hard", type: "commander" },
                            { text: "Consider team capabilities first", type: "coach" }
                        ]
                    },
                    {
                        text: "How do you celebrate success?",
                        options: [
                            { text: "Connect it to bigger purpose", type: "visionary" },
                            { text: "Document lessons learned", type: "architect" },
                            { text: "Recognize everyone's contributions", type: "facilitator" },
                            { text: "Quickly move to next goal", type: "executor" },
                            { text: "Public acknowledgment of victory", type: "commander" },
                            { text: "Highlight individual growth", type: "coach" }
                        ]
                    },
                    {
                        text: "When hiring, what matters most?",
                        options: [
                            { text: "Alignment with vision and values", type: "visionary" },
                            { text: "Skills matching system needs", type: "architect" },
                            { text: "Cultural fit and team chemistry", type: "facilitator" },
                            { text: "Track record of results", type: "executor" },
                            { text: "Competence and capability", type: "commander" },
                            { text: "Potential for development", type: "coach" }
                        ]
                    },
                    {
                        text: "How do you handle underperformance?",
                        options: [
                            { text: "Reconnect to purpose", type: "visionary" },
                            { text: "Review processes and systems", type: "architect" },
                            { text: "Understand underlying issues", type: "facilitator" },
                            { text: "Set clear improvement metrics", type: "executor" },
                            { text: "Make swift, tough decisions", type: "commander" },
                            { text: "Create development plan", type: "coach" }
                        ]
                    },
                    {
                        text: "What's your meeting pet peeve?",
                        options: [
                            { text: "Lack of strategic thinking", type: "visionary" },
                            { text: "Disorganized agendas", type: "architect" },
                            { text: "People talking over each other", type: "facilitator" },
                            { text: "Talking without action items", type: "executor" },
                            { text: "Indecisiveness", type: "commander" },
                            { text: "Ignoring people's development", type: "coach" }
                        ]
                    },
                    {
                        text: "How would your team describe you?",
                        options: [
                            { text: "Inspiring and forward-thinking", type: "visionary" },
                            { text: "Organized and systematic", type: "architect" },
                            { text: "Supportive and inclusive", type: "facilitator" },
                            { text: "Results-driven and efficient", type: "executor" },
                            { text: "Decisive and strong", type: "commander" },
                            { text: "Caring and developmental", type: "coach" }
                        ]
                    },
                    {
                        text: "What's your superpower as a leader?",
                        options: [
                            { text: "Seeing possibilities others miss", type: "visionary" },
                            { text: "Creating order from chaos", type: "architect" },
                            { text: "Building bridges between people", type: "facilitator" },
                            { text: "Getting things done", type: "executor" },
                            { text: "Making tough calls", type: "commander" },
                            { text: "Unlocking potential in others", type: "coach" }
                        ]
                    }
                ]
            },
            section3: {
                title: "Team Dynamics Assessment",
                icon: "üë•",
                questions: [
                    {
                        text: "Team members openly admit mistakes and weaknesses",
                        scale: true,
                        dimension: "trust"
                    },
                    {
                        text: "People are comfortable being vulnerable in front of the team",
                        scale: true,
                        dimension: "trust"
                    },
                    {
                        text: "Team members ask for help without hesitation",
                        scale: true,
                        dimension: "trust"
                    },
                    {
                        text: "We share personal challenges that affect work",
                        scale: true,
                        dimension: "trust"
                    },
                    {
                        text: "Team members engage in passionate debates about ideas",
                        scale: true,
                        dimension: "conflict"
                    },
                    {
                        text: "We surface and resolve disagreements quickly",
                        scale: true,
                        dimension: "conflict"
                    },
                    {
                        text: "People challenge each other's viewpoints constructively",
                        scale: true,
                        dimension: "conflict"
                    },
                    {
                        text: "Conflict is seen as productive, not problematic",
                        scale: true,
                        dimension: "conflict"
                    },
                    {
                        text: "Everyone is clear about team priorities and goals",
                        scale: true,
                        dimension: "commitment"
                    },
                    {
                        text: "Team members commit fully to decisions, even if they initially disagreed",
                        scale: true,
                        dimension: "commitment"
                    },
                    {
                        text: "We have clear deadlines and stick to them",
                        scale: true,
                        dimension: "commitment"
                    },
                    {
                        text: "After meetings, everyone knows what they need to do",
                        scale: true,
                        dimension: "commitment"
                    },
                    {
                        text: "Team members call out peers who don't meet standards",
                        scale: true,
                        dimension: "accountability"
                    },
                    {
                        text: "We address performance issues directly",
                        scale: true,
                        dimension: "accountability"
                    },
                    {
                        text: "People take ownership of their responsibilities",
                        scale: true,
                        dimension: "accountability"
                    },
                    {
                        text: "No one makes excuses for missing deadlines or quality standards",
                        scale: true,
                        dimension: "accountability"
                    },
                    {
                        text: "Team success is prioritized over individual goals",
                        scale: true,
                        dimension: "results"
                    },
                    {
                        text: "We measure and track collective outcomes",
                        scale: true,
                        dimension: "results"
                    },
                    {
                        text: "Individual awards don't overshadow team achievements",
                        scale: true,
                        dimension: "results"
                    },
                    {
                        text: "Everyone is willing to make personal sacrifices for team success",
                        scale: true,
                        dimension: "results"
                    }
                ]
            }
        };

        // State Management
        let currentQuestion = 0;
        let currentSection = 1;
        let answers = {
            section1: [],
            section2: [],
            section3: []
        };

        // Calculate total questions
        const totalQuestions = Object.values(assessmentData).reduce((sum, section) => sum + section.questions.length, 0);
        document.getElementById('totalQuestions').textContent = totalQuestions;

        // Load saved progress
        function loadProgress() {
            const saved = localStorage.getItem('assessmentProgress');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    const savedTime = new Date(data.timestamp);
                    const now = new Date();
                    const daysDiff = (now - savedTime) / (1000 * 60 * 60 * 24);
                    
                    // Only restore if less than 7 days old
                    if (daysDiff < 7 && confirm('Resume your previous assessment?')) {
                        currentQuestion = data.currentQuestion;
                        currentSection = data.currentSection;
                        answers = data.answers;
                        return true;
                    }
                } catch (e) {
                    console.error('Failed to load progress:', e);
                }
            }
            return false;
        }

        // Save progress
        function saveProgress() {
            const data = {
                timestamp: new Date().toISOString(),
                currentQuestion,
                currentSection,
                answers
            };
            localStorage.setItem('assessmentProgress', JSON.stringify(data));
        }

        // Clear progress
        function clearProgress() {
            localStorage.removeItem('assessmentProgress');
        }

        // Initialize
        function init() {
            loadProgress();
            // Don't auto-start - wait for user to click button
            setupKeyboardNavigation();
        }

        function startAssessment() {
            document.querySelector('.header .btn').parentElement.style.display = 'none';
            document.getElementById('overallProgress').style.display = 'block';
            document.getElementById('questionsContainer').style.display = 'block';
            renderCurrentQuestion();
            updateProgress();
        }

        // Render Question
        function renderCurrentQuestion() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';

            const sectionKey = `section${currentSection}`;
            const section = assessmentData[sectionKey];
            const sectionQuestionIndex = answers[sectionKey].length;
            
            if (sectionQuestionIndex >= section.questions.length) {
                // Show insight before moving to next section
                if (currentSection < 3) {
                    showSectionInsight(currentSection);
                    return;
                } else {
                    showResults();
                    return;
                }
            }

            const question = section.questions[sectionQuestionIndex];
            const globalQuestionNum = currentQuestion + 1;

            const card = document.createElement('div');
            card.className = 'question-card active';
            
            let optionsHTML = '';
            if (question.scale) {
                optionsHTML = `
                    <div class="scale-options">
                        ${[1, 2, 3, 4, 5].map(val => `
                            <div class="scale-option" data-value="${val}">
                                <div class="scale-value">${val}</div>
                                <div class="scale-label">${val === 1 ? 'Never' : val === 5 ? 'Always' : ''}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            } else {
                optionsHTML = `
                    <div class="answer-options">
                        ${question.options.map((opt, idx) => `
                            <div class="answer-option" data-index="${idx}">
                                ${opt.text}
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            card.innerHTML = `
                <div class="section-header">${section.icon} ${section.title}</div>
                <div class="question-number">Question ${globalQuestionNum} of ${totalQuestions}</div>
                <div class="question-text">${question.text}</div>
                ${optionsHTML}
                <div class="nav-buttons">
                    ${currentQuestion > 0 ? '<button class="nav-btn prev" onclick="previousQuestion()">‚Üê Previous</button>' : ''}
                    <button class="nav-btn next" id="nextBtn" disabled>${currentQuestion === totalQuestions - 1 ? 'See Results' : 'Next'} ‚Üí</button>
                </div>
            `;

            container.appendChild(card);

            // Add click handlers
            if (question.scale) {
                card.querySelectorAll('.scale-option').forEach(opt => {
                    opt.addEventListener('click', () => selectScaleOption(opt, question));
                });
            } else {
                card.querySelectorAll('.answer-option').forEach(opt => {
                    opt.addEventListener('click', () => selectAnswer(opt, question));
                });
            }
        }

        function selectAnswer(element, question) {
            // Remove previous selection
            document.querySelectorAll('.answer-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');

            const index = parseInt(element.getAttribute('data-index'));
            const answer = question.options[index];

            // Save answer
            const sectionKey = `section${currentSection}`;
            answers[sectionKey][answers[sectionKey].length] = answer;

            // Save progress
            saveProgress();

            // Enable next button
            document.getElementById('nextBtn').disabled = false;

            // Gamification
            GAMIFICATION.addXP(GAMIFICATION.xpPerQuestion);
            const totalAnswered = Object.values(answers).reduce((sum, arr) => sum + arr.length, 0);
            if (totalAnswered === 23) {
                GAMIFICATION.unlockAchievement('halfway');
            }

            // Auto-advance after short delay
            setTimeout(() => nextQuestion(), 500);
        }

        function selectScaleOption(element, question) {
            // Remove previous selection
            document.querySelectorAll('.scale-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');

            const value = parseInt(element.getAttribute('data-value'));
            
            // Save answer
            const sectionKey = `section${currentSection}`;
            answers[sectionKey][answers[sectionKey].length] = {
                value: value,
                dimension: question.dimension
            };

            // Save progress
            saveProgress();

            // Enable next button
            document.getElementById('nextBtn').disabled = false;

            // Gamification
            GAMIFICATION.addXP(GAMIFICATION.xpPerQuestion);
            const totalAnswered = Object.values(answers).reduce((sum, arr) => sum + arr.length, 0);
            if (totalAnswered === 23) {
                GAMIFICATION.unlockAchievement('halfway');
            }

            // Auto-advance after short delay
            setTimeout(() => nextQuestion(), 500);
        }

        function nextQuestion() {
            currentQuestion++;
            renderCurrentQuestion();
            updateProgress();
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                
                // Remove last answer from current section
                const sectionKey = `section${currentSection}`;
                answers[sectionKey].pop();
                
                // Check if we need to go back a section
                if (answers[sectionKey].length === 0 && currentSection > 1) {
                    currentSection--;
                }
                
                renderCurrentQuestion();
                updateProgress();
            }
        }

        function updateProgress() {
            const progress = (currentQuestion / totalQuestions) * 100;
            document.getElementById('overallProgressFill').style.width = progress + '%';
            document.getElementById('currentQuestionNum').textContent = currentQuestion;

            // Update section badges
            const section1Count = answers.section1.length;
            const section2Count = answers.section2.length;
            const section3Count = answers.section3.length;

            // Section 1
            const section1Badge = document.getElementById('section1Badge');
            if (section1Count === assessmentData.section1.questions.length) {
                section1Badge.classList.remove('active');
                section1Badge.classList.add('completed');
                section1Badge.querySelector('.icon').textContent = '‚óè';
                section1Badge.querySelector('.status').textContent = '12/12';
            } else if (section1Count > 0) {
                section1Badge.classList.add('active');
                section1Badge.querySelector('.icon').textContent = '‚óê';
                section1Badge.querySelector('.status').textContent = `${section1Count}/12`;
            } else {
                section1Badge.querySelector('.status').textContent = `0/12`;
            }

            // Section 2
            const section2Badge = document.getElementById('section2Badge');
            if (section2Count === assessmentData.section2.questions.length) {
                section2Badge.classList.remove('active');
                section2Badge.classList.add('completed');
                section2Badge.querySelector('.icon').textContent = '‚óè';
                section2Badge.querySelector('.status').textContent = '14/14';
            } else if (section2Count > 0) {
                section2Badge.classList.add('active');
                section2Badge.classList.remove('completed');
                section2Badge.querySelector('.icon').textContent = '‚óê';
                section2Badge.querySelector('.status').textContent = `${section2Count}/14`;
            } else {
                section2Badge.querySelector('.status').textContent = `0/14`;
            }

            // Section 3
            const section3Badge = document.getElementById('section3Badge');
            if (section3Count === assessmentData.section3.questions.length) {
                section3Badge.classList.remove('active');
                section3Badge.classList.add('completed');
                section3Badge.querySelector('.icon').textContent = '‚óè';
                section3Badge.querySelector('.status').textContent = '20/20';
            } else if (section3Count > 0) {
                section3Badge.classList.add('active');
                section3Badge.classList.remove('completed');
                section3Badge.querySelector('.icon').textContent = '‚óê';
                section3Badge.querySelector('.status').textContent = `${section3Count}/20`;
            } else {
                section3Badge.querySelector('.status').textContent = `0/20`;
            }
        }

        // Keyboard Navigation
        function setupKeyboardNavigation() {
            document.addEventListener('keydown', (e) => {
                // Ignore if menu is open
                if (document.getElementById('slideMenu').classList.contains('active')) return;
                
                // Ignore if in results
                if (document.getElementById('results').classList.contains('active')) return;

                const activeCard = document.querySelector('.question-card.active');
                if (!activeCard) return;

                // Arrow keys for answer selection
                const options = activeCard.querySelectorAll('.answer-option, .scale-option');
                const selected = activeCard.querySelector('.answer-option.selected, .scale-option.selected');
                
                if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
                    e.preventDefault();
                    const currentIndex = Array.from(options).indexOf(selected);
                    let newIndex;
                    
                    if (e.key === 'ArrowDown') {
                        newIndex = currentIndex < options.length - 1 ? currentIndex + 1 : 0;
                    } else {
                        newIndex = currentIndex > 0 ? currentIndex - 1 : options.length - 1;
                    }
                    
                    options[newIndex].click();
                    options[newIndex].scrollIntoView({ block: 'nearest', behavior: 'smooth' });
                }

                // Number keys for quick selection (1-9)
                if (e.key >= '1' && e.key <= '9') {
                    const index = parseInt(e.key) - 1;
                    if (index < options.length) {
                        e.preventDefault();
                        options[index].click();
                    }
                }

                // Enter/Space to confirm and advance
                if ((e.key === 'Enter' || e.key === ' ') && selected) {
                    e.preventDefault();
                    const nextBtn = document.getElementById('nextBtn');
                    if (!nextBtn.disabled) {
                        nextBtn.click();
                    }
                }

                // Backspace to go back
                if (e.key === 'Backspace' && currentQuestion > 0) {
                    e.preventDefault();
                    previousQuestion();
                }
            });
        }

        function showResults() {
            // Clear progress on completion
            clearProgress();
            
            // Gamification
            GAMIFICATION.addXP(GAMIFICATION.xpForCompletion);
            GAMIFICATION.unlockAchievement('complete');
            const elapsed = (Date.now() - window.assessmentStartTime) / 1000;
            if (elapsed < 300) {
                GAMIFICATION.unlockAchievement('speed_demon');
            }
            celebrateCompletion();
            
            // Hide questions
            document.getElementById('questionsContainer').style.display = 'none';
            document.querySelector('.overall-progress').style.display = 'none';

            // Calculate results
            const results = calculateResults();

            // Show results
            const resultsDiv = document.getElementById('results');
            const resultsContent = document.getElementById('resultsContent');

            resultsContent.innerHTML = `
                <div class="result-section">
                    <h3>üë§ Your Worker Type</h3>
                    <div class="result-badge">${results.workerType.icon}</div>
                    <h4 style="font-size: 1.5em; margin: 15px 0;">${results.workerType.type}</h4>
                    <p style="color: #666; line-height: 1.7;">${results.workerType.description}</p>
                </div>

                <div class="result-section">
                    <h3>üéØ Your Leadership Style</h3>
                    <div class="result-badge">${results.leadershipStyle.icon}</div>
                    <h4 style="font-size: 1.5em; margin: 15px 0;">${results.leadershipStyle.type}</h4>
                    <p style="color: #666; line-height: 1.7;">${results.leadershipStyle.description}</p>
                </div>

                <div class="result-section">
                    <h3>üë• Team Dynamics Overview</h3>
                    ${Object.entries(results.teamDynamics.dimensions).map(([dim, score]) => `
                        <div style="margin: 20px 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <strong style="text-transform: capitalize;">${dim}</strong>
                                <span>${score.toFixed(1)}/5.0</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${(score/5)*100}%"></div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;

            resultsDiv.classList.add('active');
            
            setTimeout(() => addAchievementBadges(), 500);

            // Save to localStorage
            localStorage.setItem('completeProfileResults', JSON.stringify({
                timestamp: new Date().toISOString(),
                workerType: results.workerType.type,
                leadershipStyle: results.leadershipStyle.type,
                teamDynamics: results.teamDynamics,
                answers: answers
            }));
        }

        function calculateResults() {
            // Calculate Worker Type
            const workerTypeCounts = {};
            answers.section1.forEach(answer => {
                workerTypeCounts[answer.type] = (workerTypeCounts[answer.type] || 0) + 1;
            });
            const dominantWorkerType = Object.keys(workerTypeCounts).reduce((a, b) => 
                workerTypeCounts[a] > workerTypeCounts[b] ? a : b
            );

            const workerTypeData = {
                sprinter: {
                    icon: "‚ö°",
                    type: "Sprinter",
                    description: "You thrive in short, intense bursts of productivity. You excel at quick wins, tight deadlines, and rapid execution. Best suited for dynamic environments with clear milestones."
                },
                jogger: {
                    icon: "üèÉ",
                    type: "Jogger",
                    description: "You maintain steady, consistent pace. You excel at sustainable productivity, predictable routines, and balanced work-life integration. Perfect for stable, long-term projects."
                },
                ultrarunner: {
                    icon: "üî•",
                    type: "Ultrarunner",
                    description: "You can sustain deep focus for extended periods. You excel at complex problems, marathon work sessions, and total immersion. Ideal for deep work and challenging projects."
                }
            };

            // Calculate Leadership Style
            const leadershipCounts = {};
            answers.section2.forEach(answer => {
                leadershipCounts[answer.type] = (leadershipCounts[answer.type] || 0) + 1;
            });
            const dominantLeadership = Object.keys(leadershipCounts).reduce((a, b) => 
                leadershipCounts[a] > leadershipCounts[b] ? a : b
            );

            const leadershipData = {
                visionary: {
                    icon: "üîÆ",
                    type: "Visionary",
                    description: "You inspire with big-picture thinking and future possibilities. You excel at strategy, innovation, and painting compelling visions that motivate others."
                },
                architect: {
                    icon: "üèóÔ∏è",
                    type: "Architect",
                    description: "You build robust systems and frameworks. You excel at organization, process design, and creating structures that scale effectively."
                },
                facilitator: {
                    icon: "ü§ù",
                    type: "Facilitator",
                    description: "You bring people together and create harmony. You excel at collaboration, consensus-building, and ensuring everyone's voice is heard."
                },
                executor: {
                    icon: "‚úÖ",
                    type: "Executor",
                    description: "You drive results through focused action. You excel at execution, accountability, and turning plans into reality efficiently."
                },
                commander: {
                    icon: "‚öîÔ∏è",
                    type: "Commander",
                    description: "You lead decisively and drive hard toward goals. You excel at making tough calls, pushing for excellence, and winning."
                },
                coach: {
                    icon: "üéì",
                    type: "Coach",
                    description: "You develop others' potential. You excel at mentoring, personalized support, and helping team members grow and succeed."
                }
            };

            // Calculate Team Dynamics
            const dimensions = {
                trust: [],
                conflict: [],
                commitment: [],
                accountability: [],
                results: []
            };

            answers.section3.forEach(answer => {
                if (answer.dimension) {
                    dimensions[answer.dimension].push(answer.value);
                }
            });

            const dimensionScores = {};
            Object.keys(dimensions).forEach(dim => {
                const scores = dimensions[dim];
                dimensionScores[dim] = scores.reduce((a, b) => a + b, 0) / scores.length;
            });

            return {
                workerType: workerTypeData[dominantWorkerType],
                leadershipStyle: leadershipData[dominantLeadership],
                teamDynamics: {
                    dimensions: dimensionScores
                }
            };
        }

        // Hamburger Menu Control
        const menuToggle = document.getElementById('menuToggle');
        const slideMenu = document.getElementById('slideMenu');
        const menuOverlay = document.getElementById('menuOverlay');

        function toggleMenu() {
            menuToggle.classList.toggle('active');
            slideMenu.classList.toggle('active');
            menuOverlay.classList.toggle('active');
            document.body.style.overflow = slideMenu.classList.contains('active') ? 'hidden' : '';
        }

        menuToggle.addEventListener('click', toggleMenu);
        menuOverlay.addEventListener('click', toggleMenu);

        slideMenu.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                setTimeout(toggleMenu, 150);
            });
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && slideMenu.classList.contains('active')) {
                toggleMenu();
            }
        });
        
        function showSectionInsight(completedSection) {
            const insights = {
                1: {
                    icon: 'üí°',
                    title: 'Self-Reflection: Your Work Rhythm',
                    content: 'You\'ve just explored your natural work dynamics. Whether you\'re a sprinter, a pacer, or a marathon runner, understand this: There is no "best" - only what\'s authentic to you.',
                    quote: '"Productivity isn\'t about how much you do, but how you do what you do."',
                    reflection: {
                        title: 'Consider this:',
                        points: [
                            'Does your current environment work with your natural rhythm or against it?',
                            'When do you feel most in your zone? What creates those conditions?',
                            'How can you structure your work to respect your energy?'
                        ]
                    }
                },
                2: {
                    icon: 'üéØ',
                    title: 'Leadership as Service',
                    content: 'Leadership isn\'t about power - it\'s about empowering people. Whether you lead through direction or support, both serve the team. The question isn\'t who\'s in charge, but who helps others grow.',
                    quote: '"The greatest leaders are those who help others become leaders, not followers."',
                    reflection: {
                        title: 'Reflect on this:',
                        points: [
                            'How do you define leadership? Is it about positions or influence?',
                            'When do you lead best - in crisis, in routine, or in building?',
                            'How do you balance holding people accountable with giving space to grow?',
                            'Think of a moment when you felt like a "servant" rather than a "boss" - what was different?'
                        ]
                    }
                }
            };
            
            const insight = insights[completedSection];
            if (!insight) {
                // No insight for this section, move to next
                currentSection++;
                renderCurrentQuestion();
                return;
            }
            
            const container = document.getElementById('questionsContainer');
            container.innerHTML = `
                <div class="insight-card">
                    <span class="insight-icon">${insight.icon}</span>
                    <h3 class="insight-title">${insight.title}</h3>
                    <p class="insight-content">${insight.content}</p>
                    <div class="insight-quote">${insight.quote}</div>
                    <div class="insight-reflection">
                        <h4>${insight.reflection.title}</h4>
                        <ul>
                            ${insight.reflection.points.map(point => `<li>${point}</li>`).join('')}
                        </ul>
                    </div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="nav-btn next" onclick="continueToNextSection()">
                            Continue to Next Section ‚Üí
                        </button>
                    </div>
                </div>
            `;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function continueToNextSection() {
            currentSection++;
            renderCurrentQuestion();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        const GAMIFICATION = {
            xp: 0,
            level: 1,
            xpPerQuestion: 4,
            xpForCompletion: 150,
            achievements: {
                'first_start': { icon: 'üéØ', name: 'Profile Explorer', desc: 'Started the assessment', xp: 50, unlocked: false },
                'halfway': { icon: 'üí™', name: 'Halfway Hero', desc: 'Answered 23 questions', xp: 50, unlocked: false },
                'complete': { icon: 'üèÜ', name: 'Complete Profile Master', desc: 'Completed the assessment', xp: 50, unlocked: false },
                'speed_demon': { icon: '‚ö°', name: 'Speed Demon', desc: 'Completed in under 5 minutes', xp: 50, unlocked: false }
            },
            load() {
                const saved = localStorage.getItem('tapinGamificationComplete');
                if (saved) {
                    const data = JSON.parse(saved);
                    this.xp = data.xp || 0;
                    this.level = data.level || 1;
                    this.achievements = { ...this.achievements, ...data.achievements };
                }
            },
            save() {
                localStorage.setItem('tapinGamificationComplete', JSON.stringify({
                    xp: this.xp,
                    level: this.level,
                    achievements: this.achievements
                }));
            },
            addXP(amount) {
                this.xp += amount;
                this.updateXPBar();
                this.checkLevelUp();
                this.save();
            },
            updateXPBar() {
                const xpBar = document.getElementById('xpBar');
                if (!xpBar) return;
                xpBar.style.display = 'block';
                const nextLevelXP = this.level * 100;
                const progress = (this.xp / nextLevelXP) * 100;
                xpBar.querySelector('.progress-fill').style.width = Math.min(progress, 100) + '%';
                xpBar.querySelector('.xp-text').textContent = `${this.xp} / ${nextLevelXP} XP`;
                xpBar.querySelector('.level').textContent = `Level ${this.level}: ${this.getLevelName()}`;
            },
            getLevelName() {
                if (this.level === 1) return 'Profile Explorer';
                if (this.level === 2) return 'Insight Seeker';
                if (this.level === 3) return 'Self-Awareness Master';
                return 'Complete Profile Guru';
            },
            checkLevelUp() {
                const nextLevelXP = this.level * 100;
                if (this.xp >= nextLevelXP) {
                    this.level++;
                    this.showAchievement('üéä', 'Level Up!', `You are now ${this.getLevelName()}!`);
                    this.updateXPBar();
                }
            },
            showAchievement(icon, title, desc) {
                const toast = document.getElementById('achievementToast');
                if (!toast) return;
                document.getElementById('toastIcon').textContent = icon;
                document.getElementById('toastTitle').textContent = title;
                document.getElementById('toastDesc').textContent = desc;
                toast.style.display = 'block';
                toast.classList.add('show');
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => toast.style.display = 'none', 500);
                }, 4000);
            },
            unlockAchievement(key) {
                if (this.achievements[key] && !this.achievements[key].unlocked) {
                    this.achievements[key].unlocked = true;
                    const ach = this.achievements[key];
                    this.addXP(ach.xp);
                    this.showAchievement(ach.icon, ach.name, ach.desc);
                    this.save();
                }
            },
            showStreak() {
                const today = new Date().toDateString();
                const lastVisit = localStorage.getItem('tapinLastVisitComplete');
                let streak = parseInt(localStorage.getItem('tapinStreakComplete') || '0');
                if (lastVisit) {
                    const lastDate = new Date(lastVisit);
                    const diffDays = Math.floor((new Date(today) - lastDate) / (1000 * 60 * 60 * 24));
                    if (diffDays === 1) streak++;
                    else if (diffDays > 1) streak = 1;
                } else {
                    streak = 1;
                }
                localStorage.setItem('tapinLastVisitComplete', today);
                localStorage.setItem('tapinStreakComplete', streak.toString());
                const badge = document.getElementById('streakBadge');
                if (badge) {
                    badge.style.display = 'flex';
                    document.getElementById('streakCount').textContent = streak;
                }
            }
        };

        GAMIFICATION.load();
        GAMIFICATION.showStreak();

        const originalInit = init;
        init = function() {
            originalInit();
            GAMIFICATION.unlockAchievement('first_start');
            window.assessmentStartTime = Date.now();
        };

        function celebrateCompletion() {
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.top = '-10px';
                    confetti.style.background = ['#4a7c9c', '#3d6680', '#4a7c9c', '#4a7c9c'][Math.floor(Math.random() * 4)];
                    document.body.appendChild(confetti);
                    let pos = -10;
                    const fall = setInterval(() => {
                        if (pos >= window.innerHeight) {
                            clearInterval(fall);
                            confetti.remove();
                        } else {
                            pos += 5;
                            confetti.style.top = pos + 'px';
                        }
                    }, 20);
                }, i * 30);
            }
        }

        function addAchievementBadges() {
            const resultsDiv = document.getElementById('celebration');
            if (!resultsDiv) return;
            const achievementsHTML = `
                <div class="achievements-section">
                    <h3 style="color:#1a365d;font-size:1.8em;margin-bottom:10px;">üèÜ Your Achievements</h3>
                    <p style="color:#64748b;margin-bottom:20px;">You've earned ${GAMIFICATION.xp} XP and reached Level ${GAMIFICATION.level}!</p>
                    <div class="achievements-grid">
                        ${Object.entries(GAMIFICATION.achievements).map(([key, ach]) => `
                            <div class="badge ${ach.unlocked ? 'unlocked' : 'locked'}">
                                <div class="badge-icon">${ach.icon}</div>
                                <div class="badge-name">${ach.name}</div>
                                <div class="badge-desc">${ach.desc}</div>
                                <div style="margin-top:8px;color:#4a7c9c;font-weight:600;">+${ach.xp} XP</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            resultsDiv.insertAdjacentHTML('beforeend', achievementsHTML);
        }

        // Initialize on load
        init();
    </script>

    <!-- Performance Optimizer - Load First -->
<script src="js/performance-optimizer.js"></script>
</body>
</html>
