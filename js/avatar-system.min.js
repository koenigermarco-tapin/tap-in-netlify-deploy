const AVATAR_SYSTEM={beltColors:{white:"#FFFFFF",blue:"#1e40af",purple:"#7c3aed",brown:"#92400e",black:"#1f2937"},xpLevels:[{level:1,xp:0,title:"Beginner"},{level:2,xp:100,title:"Apprentice"},{level:3,xp:250,title:"Practitioner"},{level:4,xp:500,title:"Skilled"},{level:5,xp:1e3,title:"Dedicated"},{level:6,xp:1500,title:"Advanced"},{level:7,xp:2e3,title:"Expert"},{level:8,xp:3e3,title:"Elite"},{level:9,xp:4e3,title:"Master"},{level:10,xp:5e3,title:"Grand Master"},{level:11,xp:6e3,title:"Champion"},{level:12,xp:7500,title:"Legend"},{level:13,xp:9e3,title:"Sage"},{level:14,xp:11e3,title:"Mentor"},{level:15,xp:13e3,title:"Master Instructor"},{level:16,xp:15e3,title:"Grand Master"},{level:17,xp:18e3,title:"Legendary Master"},{level:18,xp:21e3,title:"Supreme Master"},{level:19,xp:25e3,title:"Ultimate Master"},{level:20,xp:3e4,title:"Perfect Master"}],getCurrentBelt:function(){if("true"===localStorage.getItem("blackBeltComplete"))return"black";if("true"===localStorage.getItem("brownBeltComplete"))return"brown";if("true"===localStorage.getItem("purpleBeltComplete"))return"purple";if("true"===localStorage.getItem("blueBeltComplete"))return"blue";if("true"===localStorage.getItem("whiteBeltComplete"))return"white";const e=localStorage.getItem("tapinBeltAssessment");if(e)try{const t=JSON.parse(e);if(t.belt)return t.belt.toLowerCase()}catch(e){console.warn("Error parsing assessment result:",e)}return"white"},getTotalXP:function(){return parseInt(localStorage.getItem("totalXP"))||0},getCurrentLevel:function(e){for(let t=this.xpLevels.length-1;t>=0;t--)if(e>=this.xpLevels[t].xp)return this.xpLevels[t];return this.xpLevels[0]},getNextLevelXP:function(e){const t=this.xpLevels.findIndex(t=>t.level===e);return t<this.xpLevels.length-1?this.xpLevels[t+1].xp:this.xpLevels[t].xp},init:function(){const e=this.getTotalXP(),t=this.getCurrentBelt(),l=this.getCurrentLevel(e),n=this.getNextLevelXP(l.level),i=document.getElementById("userBelt");i&&(i.style.fill=this.beltColors[t],i.className="belt "+t+"-belt");const r=document.getElementById("avatarBeltName");if(r){const e=t.charAt(0).toUpperCase()+t.slice(1);r.textContent=`${e}Belt`}const o=document.getElementById("avatarXP");o&&(o.textContent=`${e}/${n}XP`);const s=document.getElementById("avatarLevel");s&&(s.textContent=`Level ${l.level}:${l.title}`)},update:function(){this.init()},checkLevelUp:function(){const e=this.getTotalXP(),t=this.getCurrentLevel(e),l=parseInt(localStorage.getItem("lastKnownLevel"))||1;return t.level>l&&(localStorage.setItem("lastKnownLevel",t.level.toString()),this.showLevelUpCelebration(t),!0)},showLevelUpCelebration:function(e){const t=document.createElement("div");t.className="level-up-popup",t.innerHTML=`<div class="level-up-content"><div class="level-up-icon">ðŸŽ‰</div><h2>Level Up!</h2><p class="level-up-level">Level ${e.level}</p><p class="level-up-title">${e.title}</p><div class="level-up-xp">+${10*e.level}XP Bonus!</div></div>`,document.body.appendChild(t),"function"==typeof triggerConfetti&&triggerConfetti(),setTimeout(()=>{t.classList.add("show")},100),setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>t.remove(),500)},4e3)}};document.addEventListener("DOMContentLoaded",function(){AVATAR_SYSTEM.init(),AVATAR_SYSTEM.checkLevelUp()}),window.AVATAR_SYSTEM=AVATAR_SYSTEM;