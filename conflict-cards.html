<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conflict Cards - Workplace Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { transform: translateX(-100%); } to { transform: translateX(0); } }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        @keyframes wiggle { 0%, 100% { transform: rotate(0deg); } 25% { transform: rotate(-5deg); } 75% { transform: rotate(5deg); } }
        .fade-in { animation: fadeIn 0.5s ease-out; }
        .slide-in { animation: slideIn 0.3s ease-out; }
        .pulse-animation { animation: pulse 2s infinite; }
        .wiggle-animation { animation: wiggle 0.5s ease-in-out; }
        
        .card-3d {
            transform-style: preserve-3d;
            transition: transform 0.3s;
        }
        .card-3d:hover {
            transform: translateY(-10px) rotateX(5deg);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // BLACK CARDS - Conflict Scenarios (100 total - showing 50 here, expand as needed)
        const BLACK_CARDS = [
            // Team Dynamics
            "A teammate takes credit for your idea in front of the CEO. You _____.",
            "Your coworker's hygiene is affecting the whole office. You _____.",
            "Someone on your team is consistently 30 minutes late to every meeting. You _____.",
            "A colleague constantly interrupts you in meetings. You _____.",
            "Your teammate misses another deadline. You _____.",
            "Someone on the team is clearly not pulling their weight. You _____.",
            "A coworker gossips about other team members to you. You _____.",
            "Your manager asks you to cover for an underperforming colleague again. You _____.",
            "A team member micromanages everything you do. You _____.",
            "Someone keeps changing the project requirements without telling anyone. You _____.",
            
            // Client/Customer
            "A client demands a refund after 11 months of service. You _____.",
            "Your biggest customer wants a feature that violates your company values. You _____.",
            "A client yells at you for something that wasn't your fault. You _____.",
            "The customer insists on talking to 'someone more senior.' You _____.",
            "A client asks you to do something that's not in the contract. You _____.",
            "Your customer ghost you for three months, then demands immediate service. You _____.",
            "A client publicly badmouths your company on social media. You _____.",
            "The customer expects 24/7 support but only paid for business hours. You _____.",
            "A client asks for 'just one small change' for the tenth time this week. You _____.",
            "Your customer demands to speak to the CEO about a $50 issue. You _____.",
            
            // Leadership Failures
            "Your boss takes credit for the team's success but blames you for failures. You _____.",
            "Leadership announces another reorganization without explanation. You _____.",
            "Your manager asks you to work overtime again this weekend. You _____.",
            "The CEO says 'we're a family' right before layoffs. You _____.",
            "Your boss gives you conflicting directions from yesterday. You _____.",
            "Leadership cancels your project after six months of work. You _____.",
            "Your manager criticizes you in front of the whole team. You _____.",
            "The executive team makes a decision that everyone knows will fail. You _____.",
            "Your boss asks you to do something unethical. You _____.",
            "Leadership announces mandatory fun. You _____.",
            
            // Performance Issues
            "You discover a major mistake you made three months ago. You _____.",
            "Your presentation completely bombs in front of stakeholders. You _____.",
            "You accidentally replied-all to the entire company. You _____.",
            "You realize you've been doing the wrong thing for weeks. You _____.",
            "Your demo fails spectacularly during the sales pitch. You _____.",
            "You missed a critical deadline because you forgot about it. You _____.",
            "Your code broke production on a Friday evening. You _____.",
            "You gave the wrong advice and the client lost money. You _____.",
            "You forgot to invite the most important stakeholder to the meeting. You _____.",
            "You sent confidential information to the wrong person. You _____.",
            
            // Difficult Conversations
            "You need to fire someone on their birthday. You _____.",
            "Your best employee says they're quitting. You _____.",
            "HR says you need to address that employee's performance. Again. You _____.",
            "You have to tell the team the project is cancelled. You _____.",
            "Your employee asks for a raise you can't give them. You _____.",
            "You need to reject your friend's job application. You _____.",
            "The intern made a huge mistake. You _____.",
            "Your star performer is toxic to team morale. You _____.",
            "You have to deliver bad news to an already stressed team. You _____.",
            "Someone files a complaint about your leadership style. You _____.",
        ];

        // WHITE CARDS - Responses (400 total - showing 100 here, organized by category)
        const WHITE_CARDS = [
            // Professional/SBIR-Compliant (100 cards)
            "schedule a 1-on-1 to discuss specific observations",
            "use SBIR to address the behavior directly",
            "ask clarifying questions to understand their perspective",
            "share the impact and request a specific change",
            "acknowledge my feelings, then focus on facts",
            "propose a solution that benefits both parties",
            "escalate to leadership with documented examples",
            "set a clear boundary with consequences",
            "request mediation from HR or a neutral third party",
            "take 24 hours to respond thoughtfully",
            "acknowledge my role in the situation",
            "focus on observable behaviors, not character",
            "ask what success looks like for them",
            "share how this affects our team goals",
            "propose we revisit this conversation tomorrow",
            "document everything in writing immediately",
            "request specific examples of what they need",
            "offer multiple solutions and ask them to choose",
            "acknowledge the constraint and work within it",
            "explain my reasoning transparently",
            "ask for their advice on how to handle it",
            "set a time limit for the discussion",
            "name the pattern I'm observing",
            "commit to following up within 48 hours",
            "suggest we bring in a facilitator",
            "share my intention before giving feedback",
            "ask permission to share difficult feedback",
            "focus on future behavior, not past mistakes",
            "acknowledge what's going well first",
            "propose a pilot test before full commitment",
            "request time to think about it",
            "share the business impact with data",
            "ask what they would do in my position",
            "explain the constraints I'm operating under",
            "propose a compromise with clear next steps",
            "acknowledge this is uncomfortable for both of us",
            "circle back to our shared goals",
            "name the tension in the room directly",
            "ask what's behind their request",
            "share my values that inform this decision",
            "request we table this and revisit with fresh eyes",
            
            // Passive-Aggressive (75 cards)
            "send a very detailed email cc'ing their boss",
            "say 'per my last email' with a screenshot",
            "reply with 'as discussed' when it was never discussed",
            "schedule a meeting to discuss their meeting behavior",
            "forward them their own email from three months ago",
            "suggest they might want to review the handbook",
            "ask them to 'circle back' indefinitely",
            "recommend they attend a workshop on this topic",
            "cc everyone who wasn't involved",
            "put them on a performance improvement plan",
            "schedule a 'quick sync' that lasts 90 minutes",
            "create a task force to study the issue",
            "suggest this be added to the backlog",
            "forward the policy they're clearly violating",
            "ask them to document their reasoning in writing",
            "recommend they speak with their manager about it",
            "add it to the 'parking lot' of issues",
            "suggest we revisit this during the retrospective",
            "ask them to present their case to the leadership team",
            "recommend they review the org chart",
            "put them on read-only access",
            "schedule a skip-level meeting",
            "ask them to submit a formal request",
            "refer them to the FAQ they clearly didn't read",
            "suggest this be escalated to the steering committee",
            
            // Avoidant (75 cards)
            "pretend I didn't see it",
            "hope it resolves itself",
            "wait until they bring it up",
            "delegate it to someone else",
            "mark it as low priority",
            "schedule a meeting for next quarter",
            "say I'll get back to them and never do",
            "claim I need to check with my manager first",
            "take a sudden vacation",
            "reorganize my way out of the problem",
            "wait until one of us changes jobs",
            "hope they forget about it",
            "lose the email in my inbox",
            "claim I'm waiting on legal approval",
            "schedule a meeting during their PTO",
            "say I need more data before deciding",
            "form a committee to investigate",
            "say it's outside my scope",
            "defer to whoever is louder",
            "implement a new policy instead of addressing it directly",
            "start job hunting immediately",
            "request a transfer to another team",
            "call in sick the day we need to discuss it",
            "suddenly remember I have another urgent meeting",
            "claim I don't have the authority to address this",
            
            // Aggressive/Toxic (75 cards)
            "tell them that's just how things are done here",
            "say 'not my problem'",
            "remind them they're lucky to have this job",
            "suggest they lack a sense of humor",
            "tell them to toughen up",
            "question their commitment to the team",
            "imply they're being too sensitive",
            "compare them unfavorably to their predecessor",
            "threaten to escalate unnecessarily",
            "use their mistake against them forever",
            "bring up unrelated past failures",
            "make it personal",
            "raise my voice to establish dominance",
            "copy their tone mockingly",
            "publicly shame them in Slack",
            "give them the silent treatment",
            "reassign their favorite project to someone else",
            "exclude them from important meetings going forward",
            "remind them of the unemployment rate",
            "suggest they might be happier elsewhere",
            "document everything to build a case against them",
            "start looking for their replacement",
            "make an example of them to the team",
            "weaponize HR policies against them",
            "gaslight them about what actually happened",
            
            // Humorous/Absurd (75 cards)
            "resign dramatically via interpretive dance",
            "blame Mercury in retrograde",
            "suggest we resolve this with rock-paper-scissors",
            "fake my own death",
            "start a company-wide betting pool on the outcome",
            "hire a skywriter to spell out my resignation",
            "reply only in GIFs for the rest of the day",
            "propose trial by combat",
            "change my Slack status to 'witnessing a felony'",
            "update my LinkedIn while maintaining eye contact",
            "submit my two weeks notice in the form of a haiku",
            "schedule a meeting titled 'We Need to Talk About Kevin'",
            "start speaking only in corporate buzzwords",
            "turn it into a trust fall exercise",
            "suggest we take this to Judge Judy",
            "respond by playing 'Everybody Hurts' by R.E.M.",
            "launch a company-wide survey about it",
            "create a Slack channel called #things-we-dont-talk-about",
            "propose we settle this in the metaverse",
            "start a podcast about this exact situation",
            "make a vision board about my feelings",
            "schedule a wellness day to recover from this conversation",
            "suggest we align our chakras first",
            "reply 'k'",
            "change the subject to cryptocurrency",
        ];

        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyBvK_vZ3vXj5k5L0Qp6X9K5Z6Yq8L0A5B0",
            authDomain: "conflict-cards.firebaseapp.com",
            databaseURL: "https://conflict-cards-default-rtdb.firebaseio.com",
            projectId: "conflict-cards"
        };

        let firebaseApp = null;
        try {
            if (!firebase.apps.length) firebaseApp = firebase.initializeApp(firebaseConfig);
        } catch (error) {
            console.warn('Firebase init failed:', error);
        }

        class GameRoom {
            constructor(roomCode, multiDevice = false) {
                this.roomCode = roomCode;
                this.multiDevice = multiDevice && firebaseApp !== null;
                this.storageKey = `conflict-cards-${roomCode}`;
                if (this.multiDevice) {
                    this.dbRef = firebase.database().ref(`rooms/${roomCode}`);
                }
            }

            async getState() {
                if (this.multiDevice) {
                    const snapshot = await this.dbRef.once('value');
                    return snapshot.val();
                }
                const data = localStorage.getItem(this.storageKey);
                return data ? JSON.parse(data) : null;
            }

            async setState(state) {
                if (this.multiDevice) {
                    await this.dbRef.set(state);
                } else {
                    localStorage.setItem(this.storageKey, JSON.stringify(state));
                    window.dispatchEvent(new Event('storage'));
                }
            }

            subscribe(callback) {
                if (this.multiDevice) {
                    this.dbRef.on('value', (snapshot) => callback(snapshot.val()));
                    return () => this.dbRef.off('value');
                } else {
                    const handler = () => {
                        const data = localStorage.getItem(this.storageKey);
                        callback(data ? JSON.parse(data) : null);
                    };
                    window.addEventListener('storage', handler);
                    return () => window.removeEventListener('storage', handler);
                }
            }
        }

        function ConflictCards() {
            const [screen, setScreen] = useState('mode-select');
            const [gameMode, setGameMode] = useState(null);
            const [roomCode, setRoomCode] = useState('');
            const [myName, setMyName] = useState('');
            const [players, setPlayers] = useState([]);
            const [judgeIndex, setJudgeIndex] = useState(0);
            const [playerHands, setPlayerHands] = useState({});
            const [blackCard, setBlackCard] = useState(null);
            const [submissions, setSubmissions] = useState({});
            const [scores, setScores] = useState({});
            const [round, setRound] = useState(0);
            const [usedBlackCards, setUsedBlackCards] = useState([]);
            const [usedWhiteCards, setUsedWhiteCards] = useState([]);
            const [showWinner, setShowWinner] = useState(false);
            const [roundWinner, setRoundWinner] = useState(null);
            const [sbirBonus, setSbirBonus] = useState(false);

            const roomRef = useRef(null);

            useEffect(() => {
                if (!roomCode || screen === 'mode-select') return;

                const room = new GameRoom(roomCode, gameMode === 'multi-device');
                roomRef.current = room;

                const unsubscribe = room.subscribe((state) => {
                    if (state) {
                        setPlayers(state.players || []);
                        setJudgeIndex(state.judgeIndex || 0);
                        setPlayerHands(state.playerHands || {});
                        setBlackCard(state.blackCard || null);
                        setSubmissions(state.submissions || {});
                        setScores(state.scores || {});
                        setRound(state.round || 0);
                        setUsedBlackCards(state.usedBlackCards || []);
                        setUsedWhiteCards(state.usedWhiteCards || []);
                        if (state.screen) setScreen(state.screen);
                    }
                });

                room.getState().then(state => {
                    if (!state) {
                        room.setState({
                            players: [],
                            judgeIndex: 0,
                            playerHands: {},
                            scores: {},
                            round: 0,
                            usedBlackCards: [],
                            usedWhiteCards: [],
                            screen: 'lobby'
                        });
                    }
                });

                return unsubscribe;
            }, [roomCode, gameMode]);

            const updateRoom = async (updates) => {
                if (!roomRef.current) return;
                const state = await roomRef.current.getState();
                await roomRef.current.setState({ ...state, ...updates });
            };

            const selectMode = (mode) => {
                setGameMode(mode);
                setScreen('lobby');
                const code = Math.random().toString(36).substring(2, 8).toUpperCase();
                setRoomCode(code);
            };

            const addPlayer = async (name) => {
                if (!name.trim() || !roomRef.current) return;
                const state = await roomRef.current.getState();
                if (state.players.some(p => p.name === name)) {
                    alert('Name taken!');
                    return;
                }

                const newPlayer = { name, id: Date.now() };
                await updateRoom({
                    players: [...state.players, newPlayer],
                    scores: { ...state.scores, [name]: 0 }
                });
                setMyName(name);
            };

            const dealCards = () => {
                const hands = {};
                let availableCards = [...WHITE_CARDS];
                
                players.forEach(player => {
                    hands[player.name] = [];
                    for (let i = 0; i < 10; i++) {
                        if (availableCards.length === 0) availableCards = [...WHITE_CARDS];
                        const index = Math.floor(Math.random() * availableCards.length);
                        hands[player.name].push(availableCards[index]);
                        availableCards.splice(index, 1);
                    }
                });
                
                return hands;
            };

            const startGame = async () => {
                const state = await roomRef.current.getState();
                if (state.players.length < 4) {
                    alert('Need at least 4 players!');
                    return;
                }

                const hands = dealCards();
                await updateRoom({
                    screen: 'game',
                    round: 1,
                    judgeIndex: 0,
                    playerHands: hands
                });
                
                drawBlackCard();
            };

            const drawBlackCard = async () => {
                const state = await roomRef.current.getState();
                const available = BLACK_CARDS.filter((_, i) => !state.usedBlackCards.includes(i));
                
                if (available.length === 0) {
                    await updateRoom({ screen: 'end' });
                    return;
                }

                const index = Math.floor(Math.random() * available.length);
                const cardIndex = BLACK_CARDS.indexOf(available[index]);
                
                await updateRoom({
                    blackCard: available[index],
                    usedBlackCards: [...state.usedBlackCards, cardIndex],
                    submissions: {}
                });
            };

            const submitCard = async (card) => {
                const state = await roomRef.current.getState();
                const newHand = state.playerHands[myName].filter(c => c !== card);
                
                await updateRoom({
                    submissions: { ...state.submissions, [myName]: card },
                    playerHands: {
                        ...state.playerHands,
                        [myName]: newHand
                    }
                });
            };

            const pickWinner = async (winnerName) => {
                const state = await roomRef.current.getState();
                const points = sbirBonus ? 2 : 1;
                
                setRoundWinner(winnerName);
                setShowWinner(true);

                setTimeout(async () => {
                    setShowWinner(false);
                    setSbirBonus(false);
                    
                    const newScores = { ...state.scores };
                    newScores[winnerName] = (newScores[winnerName] || 0) + points;

                    // Check win condition
                    if (newScores[winnerName] >= 7 || state.round >= 15) {
                        await updateRoom({ scores: newScores, screen: 'end' });
                        return;
                    }

                    // Next round
                    const newJudgeIndex = (state.judgeIndex + 1) % state.players.length;
                    const newRound = state.round + 1;

                    // Refill hands
                    const newHands = { ...state.playerHands };
                    Object.keys(newHands).forEach(name => {
                        while (newHands[name].length < 10) {
                            const availableCards = WHITE_CARDS.filter(c => !newHands[name].includes(c));
                            if (availableCards.length === 0) break;
                            const randomCard = availableCards[Math.floor(Math.random() * availableCards.length)];
                            newHands[name].push(randomCard);
                        }
                    });

                    await updateRoom({
                        scores: newScores,
                        judgeIndex: newJudgeIndex,
                        round: newRound,
                        playerHands: newHands
                    });

                    drawBlackCard();
                }, 3000);
            };

            const resetGame = () => {
                setScreen('mode-select');
                setGameMode(null);
                setMyName('');
                setRoomCode('');
            };

            const judge = players[judgeIndex];
            const isJudge = judge?.name === myName;
            const myHand = playerHands[myName] || [];
            const hasSubmitted = submissions[myName] !== undefined;
            const allSubmitted = Object.keys(submissions).length === players.length - 1;

            // Mode Select Screen
            if (screen === 'mode-select') {
                return (
                    <div className="min-h-screen flex items-center justify-center p-4">
                        <div className="max-w-2xl w-full">
                            <div className="bg-white/10 backdrop-blur-lg rounded-3xl p-12 shadow-2xl border border-white/20 fade-in">
                                <h1 className="text-5xl font-bold text-white mb-4 text-center">
                                    üíº Conflict Cards
                                </h1>
                                <p className="text-white/80 text-center mb-12 text-lg">
                                    Workplace Edition - Against Harmony
                                </p>

                                <div className="space-y-6">
                                    <button
                                        onClick={() => selectMode('pass-play')}
                                        className="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-6 rounded-2xl font-bold text-xl hover:shadow-2xl transform hover:scale-105 transition"
                                    >
                                        <div className="text-3xl mb-2">üì±</div>
                                        Pass & Play
                                    </button>

                                    <button
                                        onClick={() => selectMode('multi-device')}
                                        className="w-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-8 py-6 rounded-2xl font-bold text-xl hover:shadow-2xl transform hover:scale-105 transition"
                                    >
                                        <div className="text-3xl mb-2">üåê</div>
                                        Multi-Device
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // Lobby Screen
            if (screen === 'lobby') {
                return (
                    <div className="min-h-screen flex items-center justify-center p-4">
                        <div className="max-w-2xl w-full">
                            <div className="bg-white/10 backdrop-blur-lg rounded-3xl p-8 shadow-2xl border border-white/20 fade-in">
                                <div className="text-center mb-8">
                                    <h2 className="text-3xl font-bold text-white mb-4">Game Lobby</h2>
                                    <div className="inline-block bg-gradient-to-r from-purple-500/30 to-pink-500/30 rounded-lg px-6 py-3 border border-purple-500/50">
                                        <p className="text-white/60 text-sm">Room Code</p>
                                        <p className="text-4xl font-mono font-bold text-white">{roomCode}</p>
                                    </div>
                                </div>

                                {!myName ? (
                                    <input
                                        type="text"
                                        placeholder="Enter your name"
                                        className="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/20 text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-purple-500 mb-6"
                                        onKeyPress={(e) => {
                                            if (e.key === 'Enter') {
                                                addPlayer(e.target.value);
                                                e.target.value = '';
                                            }
                                        }}
                                    />
                                ) : (
                                    <>
                                        <div className="mb-6">
                                            <h3 className="text-white font-bold mb-4">Players ({players.length}/10)</h3>
                                            <div className="space-y-2">
                                                {players.map(player => (
                                                    <div key={player.id} className="bg-white/5 rounded-lg p-3 flex justify-between">
                                                        <span className="text-white">{player.name}</span>
                                                        {player.name === myName && <span className="text-purple-400">(You)</span>}
                                                    </div>
                                                ))}
                                            </div>
                                        </div>

                                        {players.length >= 4 && players[0]?.name === myName && (
                                            <button
                                                onClick={startGame}
                                                className="w-full bg-gradient-to-r from-green-500 to-emerald-500 text-white px-8 py-4 rounded-xl font-bold text-xl hover:shadow-lg transform hover:scale-105 transition pulse-animation"
                                            >
                                                Start Game
                                            </button>
                                        )}

                                        {players.length < 4 && (
                                            <p className="text-white/60 text-center">Need {4 - players.length} more players</p>
                                        )}
                                    </>
                                )}

                                <button onClick={() => setScreen('mode-select')} className="w-full mt-4 text-white/60 hover:text-white">
                                    ‚Üê Back
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Game Screen
            if (screen === 'game') {
                return (
                    <div className="min-h-screen p-4">
                        <div className="max-w-6xl mx-auto">
                            {/* Header */}
                            <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-6 mb-6">
                                <div className="flex justify-between items-center">
                                    <div>
                                        <h2 className="text-2xl font-bold text-white">Round {round}</h2>
                                        <p className="text-white/60">Judge: {judge?.name}</p>
                                    </div>
                                    <div className="text-right">
                                        <p className="text-white/60 text-sm">Room: {roomCode}</p>
                                        <p className="text-white text-sm">Target: 7 points</p>
                                    </div>
                                </div>
                            </div>

                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                {/* Main Area */}
                                <div className="lg:col-span-2 space-y-6">
                                    {/* Black Card */}
                                    {blackCard && (
                                        <div className="bg-black border-4 border-white rounded-2xl p-8 shadow-2xl">
                                            <p className="text-white text-2xl font-bold text-center">
                                                {blackCard}
                                            </p>
                                        </div>
                                    )}

                                    {/* Judge View */}
                                    {isJudge && allSubmitted && (
                                        <div className="space-y-4">
                                            <div className="flex items-center gap-4 mb-4">
                                                <label className="flex items-center gap-2 text-white">
                                                    <input
                                                        type="checkbox"
                                                        checked={sbirBonus}
                                                        onChange={(e) => setSbirBonus(e.target.checked)}
                                                        className="w-5 h-5"
                                                    />
                                                    <span>SBIR Bonus (+2 points instead of 1)</span>
                                                </label>
                                            </div>
                                            
                                            <p className="text-white text-center font-bold mb-4">Pick the Winner:</p>
                                            {Object.entries(submissions).map(([name, card], i) => (
                                                <button
                                                    key={i}
                                                    onClick={() => pickWinner(name)}
                                                    className="w-full bg-white rounded-xl p-6 text-left hover:bg-purple-100 transition transform hover:scale-105 shadow-lg"
                                                >
                                                    <p className="text-gray-800 text-lg">{card}</p>
                                                </button>
                                            ))}
                                        </div>
                                    )}

                                    {/* Player View */}
                                    {!isJudge && (
                                        <div>
                                            {!hasSubmitted ? (
                                                <div>
                                                    <p className="text-white text-center mb-4 font-bold">Choose Your Card:</p>
                                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                        {myHand.map((card, i) => (
                                                            <button
                                                                key={i}
                                                                onClick={() => submitCard(card)}
                                                                className="bg-white rounded-xl p-4 text-left hover:bg-purple-100 transition transform hover:scale-105 shadow-lg"
                                                            >
                                                                <p className="text-gray-800">{card}</p>
                                                            </button>
                                                        ))}
                                                    </div>
                                                </div>
                                            ) : (
                                                <p className="text-green-400 text-center text-xl">
                                                    ‚úì Card submitted! Waiting for judge...
                                                </p>
                                            )}
                                        </div>
                                    )}

                                    {isJudge && !allSubmitted && (
                                        <p className="text-white/60 text-center text-xl">
                                            Waiting for players to submit cards...
                                            <br />
                                            <span className="text-sm">({Object.keys(submissions).length}/{players.length - 1})</span>
                                        </p>
                                    )}
                                </div>

                                {/* Scoreboard */}
                                <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-6">
                                    <h3 className="text-xl font-bold text-white mb-4">Scores</h3>
                                    <div className="space-y-2">
                                        {players
                                            .sort((a, b) => (scores[b.name] || 0) - (scores[a.name] || 0))
                                            .map(player => (
                                                <div
                                                    key={player.id}
                                                    className={`p-3 rounded-lg ${
                                                        player.name === judge?.name ? 'bg-yellow-500/30 border border-yellow-500' : 'bg-white/5'
                                                    }`}
                                                >
                                                    <div className="flex justify-between items-center">
                                                        <div>
                                                            <span className="text-white">{player.name}</span>
                                                            {player.name === myName && <span className="ml-2 text-purple-400 text-xs">(You)</span>}
                                                            {player.name === judge?.name && <span className="ml-2 text-yellow-400 text-xs">üë®‚Äç‚öñÔ∏è</span>}
                                                        </div>
                                                        <span className="text-2xl font-bold text-purple-400">
                                                            {scores[player.name] || 0}
                                                        </span>
                                                    </div>
                                                </div>
                                            ))}
                                    </div>
                                    <button onClick={resetGame} className="w-full mt-4 text-white/60 hover:text-white text-sm">
                                        End Game
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* Winner Modal */}
                        {showWinner && (
                            <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 fade-in">
                                <div className="bg-gradient-to-br from-purple-600 to-pink-600 rounded-3xl p-12 max-w-2xl shadow-2xl wiggle-animation">
                                    <h2 className="text-5xl font-bold text-white text-center mb-8">üèÜ</h2>
                                    <h3 className="text-3xl font-bold text-white text-center mb-4">Round Winner!</h3>
                                    <p className="text-4xl font-bold text-white text-center">{roundWinner}</p>
                                    <p className="text-white/80 text-center mt-4">
                                        +{sbirBonus ? 2 : 1} point{sbirBonus ? 's' : ''}
                                        {sbirBonus && <span className="ml-2">üåü SBIR Bonus!</span>}
                                    </p>
                                </div>
                            </div>
                        )}
                    </div>
                );
            }

            // End Screen
            if (screen === 'end') {
                const sorted = [...players].sort((a, b) => (scores[b.name] || 0) - (scores[a.name] || 0));
                const winner = sorted[0];

                return (
                    <div className="min-h-screen flex items-center justify-center p-4">
                        <div className="max-w-4xl w-full">
                            <div className="bg-white/10 backdrop-blur-lg rounded-3xl p-12 shadow-2xl border border-white/20">
                                <h1 className="text-6xl text-center mb-8">üèÜ</h1>
                                <h2 className="text-4xl font-bold text-white text-center mb-8">Game Over!</h2>
                                
                                <div className="bg-gradient-to-r from-purple-500/30 to-pink-500/30 rounded-xl p-8 mb-8 border border-purple-500/50 text-center">
                                    <p className="text-white/80 mb-2">Winner</p>
                                    <p className="text-5xl font-bold text-white">{winner?.name}</p>
                                    <p className="text-3xl text-purple-400 mt-4">{scores[winner?.name]} points</p>
                                </div>

                                <div className="space-y-3 mb-8">
                                    <h3 className="text-2xl font-bold text-white text-center mb-4">Final Standings</h3>
                                    {sorted.map((player, i) => (
                                        <div key={player.id} className="bg-white/5 rounded-lg p-4 flex justify-between">
                                            <span className="text-white">#{i + 1} {player.name}</span>
                                            <span className="text-2xl font-bold text-purple-400">{scores[player.name] || 0}</span>
                                        </div>
                                    ))}
                                </div>

                                <button
                                    onClick={resetGame}
                                    className="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white px-12 py-4 rounded-xl font-bold text-xl hover:shadow-lg transform hover:scale-105 transition"
                                >
                                    Play Again
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return null;
        }

        ReactDOM.render(<ConflictCards />, document.getElementById('root'));
    </script>
</body>
</html>