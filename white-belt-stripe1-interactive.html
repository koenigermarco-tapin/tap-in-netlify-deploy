<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>‚ö™ White Belt - Stripe 1: Trust Foundations | Tap-In</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1d2e;
            min-height: 100vh;
            color: #e2e8f0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: #252940;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .belt-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: #3d4466;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 15px;
        }

        h1 {
            color: #ffffff;
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .module-description {
            color: #94a3b8;
            font-size: 16px;
            line-height: 1.6;
        }

        /* Progress Bar */
        .progress-container {
            background: #252940;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .progress-bar {
            background: #3d4466;
            height: 12px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            background: linear-gradient(90deg, #6366f1 0%, #818cf8 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #94a3b8;
            font-size: 14px;
            font-weight: 600;
        }

        /* Main Content Card */
        .content-card {
            background: #252940;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            min-height: 400px;
        }

        .lesson-number {
            color: #818cf8;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
        }

        .lesson-title {
            color: #ffffff;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 25px;
        }

        /* Content Sections with Animation */
        .content-section {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .content-section h3 {
            color: #ffffff;
            font-size: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .content-section p {
            color: #cbd5e1;
            line-height: 1.8;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .content-section ul {
            color: #cbd5e1;
            line-height: 1.8;
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .content-section li {
            margin-bottom: 10px;
        }

        .content-section strong {
            color: #ffffff;
            font-weight: 600;
        }

        /* Info Boxes */
        .research-box {
            background: #2d4a5a;
            border-left: 4px solid #60a5fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            animation: fadeIn 0.5s ease;
        }

        .research-box h4 {
            color: #93c5fd;
            margin-bottom: 10px;
            font-size: 16px;
            font-weight: 700;
        }

        .research-box p,
        .research-box ul {
            color: #e0f2fe;
        }

        .research-box li {
            margin-bottom: 8px;
        }

        .practice-box {
            background: #2d5a4d;
            border-left: 4px solid #34d399;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            animation: fadeIn 0.5s ease;
        }

        .practice-box h4 {
            color: #6ee7b7;
            margin-bottom: 10px;
            font-size: 16px;
            font-weight: 700;
        }

        .practice-box p {
            color: #d1fae5;
            line-height: 1.7;
        }

        /* Interactive Question Box */
        .question-box {
            background: #3d4466;
            border: 2px solid #4a5568;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .question-box h4 {
            color: #ffffff;
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .question-text {
            color: #e2e8f0;
            font-size: 16px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: #252940;
            border: 2px solid #4a5568;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            color: #cbd5e1;
            font-size: 15px;
        }

        .option:hover {
            border-color: #6366f1;
            background: #2d3250;
            transform: translateX(5px);
        }

        .option.selected {
            border-color: #6366f1;
            background: #3d4466;
            color: #ffffff;
        }

        .option.correct {
            border-color: #34d399;
            background: #2d5a4d;
            animation: correctPulse 0.5s ease;
        }

        .option.incorrect {
            border-color: #f87171;
            background: #4a2d2d;
            animation: shake 0.3s ease;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #2d5a4d;
            color: #6ee7b7;
            border-left: 4px solid #34d399;
        }

        .feedback.incorrect {
            background: #4a2d2d;
            color: #fca5a5;
            border-left: 4px solid #f87171;
        }

        /* Buttons */
        .btn {
            padding: 15px 30px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: #3d4466;
            color: #e2e8f0;
        }

        .btn-secondary:hover {
            background: #4a5568;
        }

        .xp-badge {
            background: #fbbf24;
            color: #78350f;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 700;
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 30px;
            padding-top: 25px;
            border-top: 1px solid #3d4466;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .header,
            .content-card {
                padding: 25px 20px;
            }

            h1 {
                font-size: 24px;
            }

            .lesson-title {
                font-size: 22px;
            }

            .btn {
                width: 100%;
            }

            .nav-buttons {
                flex-direction: column;
            }
        }

        .hidden {
            display: none;
        }
    
        /* ============= NUMBERED OPTION BOX READABILITY FIX ============= */
        .scale-option,
        .rating-option,
        .numbered-option,
        .option-number,
        [data-value="1"],
        [data-value="2"],
        [data-value="3"],
        [data-value="4"],
        [data-value="5"] {
            color: #FFFFFF !important;
            font-weight: 700 !important;
            font-size: 1.1rem !important;
            background: #1e293b !important;
            border: 2px solid #475569 !important;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5) !important;
        }
        .scale-option:hover,
        .rating-option:hover,
        .numbered-option:hover,
        .option-number:hover,
        [data-value]:hover {
            background: #334155 !important;
            border-color: #667eea !important;
            color: #FFFFFF !important;
            transform: scale(1.05) !important;
        }
        .scale-option.selected,
        .rating-option.selected,
        .numbered-option.selected,
        .option-number.selected,
        [data-value].selected {
            background: #667eea !important;
            border-color: #818cf8 !important;
            color: #FFFFFF !important;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3) !important;
        }
        .scale-label,
        .rating-label,
        .option-label {
            color: #FFFFFF !important;
            font-weight: 600 !important;
            font-size: 0.9rem !important;
            text-align: center !important;
            margin-top: 0.5rem !important;
        }
        .scale-container,
        .rating-container,
        .options-row {
            display: flex !important;
            justify-content: space-between !important;
            gap: 0.75rem !important;
            margin: 1.5rem 0 !important;
        }
        .scale-container > *,
        .rating-container > *,
        .options-row > * {
            flex: 1 !important;
            min-width: 60px !important;
            text-align: center !important;
            padding: 1rem 0.5rem !important;
            border-radius: 8px !important;
            cursor: pointer !important;
            transition: all 0.2s ease !important;
        }
        @media (max-width: 768px) {
            .scale-option,
            .rating-option,
            .numbered-option,
            .option-number,
            [data-value] {
                font-size: 1rem !important;
                padding: 0.75rem 0.25rem !important;
                min-width: 50px !important;
            }
            .scale-label,
            .rating-label,
            .option-label {
                font-size: 0.75rem !important;
            }
        }
        input[type="range"] {
            -webkit-appearance: none !important;
            width: 100% !important;
            height: 8px !important;
            background: #334155 !important;
            border-radius: 5px !important;
            outline: none !important;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none !important;
            width: 24px !important;
            height: 24px !important;
            background: #667eea !important;
            cursor: pointer !important;
            border-radius: 50% !important;
            border: 3px solid #FFFFFF !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3) !important;
        }
        input[type="range"]::-moz-range-thumb {
            width: 24px !important;
            height: 24px !important;
            background: #667eea !important;
            cursor: pointer !important;
            border-radius: 50% !important;
            border: 3px solid #FFFFFF !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3) !important;
        }
        .slider-value,
        .range-value {
            display: block !important;
            text-align: center !important;
            font-size: 1.5rem !important;
            font-weight: 700 !important;
            color: #667eea !important;
            margin-top: 1rem !important;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2) !important;
        }
        .slider-labels {
            display: flex !important;
            justify-content: space-between !important;
            margin-top: 0.5rem !important;
        }
        .slider-labels span {
            font-size: 0.85rem !important;
            color: #cbd5e1 !important;
            font-weight: 600 !important;
        }

    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="belt-badge">‚ö™ WHITE BELT</div>
            <h1>üéØ Stripe 1: Trust Foundations</h1>
            <p class="module-description">Master the foundation of high-performing teams: vulnerability-based trust</p>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Starting...</div>
        </div>

        <!-- Main Content Card -->
        <div class="content-card" id="contentCard">
            <!-- Content dynamically rendered here -->
        </div>

        <!-- Back Button -->
        <div style="text-align: center; margin-top: 30px;">
            <a href="stripe-navigator.html" class="btn btn-secondary">‚Üê Back to Belt Map</a>
        </div>
    </div>

    <script>
        // ===== LESSON 1: THE TWO TYPES OF TRUST =====
        const lesson1Chunks = [
            {
                lessonNumber: "Lesson 1 of 4",
                lessonTitle: "The Two Types of Trust",
                content: `
                    <div class="content-section">
                        <h3>üéØ What You'll Learn</h3>
                        <ul>
                            <li>The critical difference between predictability-based trust and vulnerability-based trust</li>
                            <li>Why high-performing teams require vulnerability-based trust</li>
                            <li>How to assess which type of trust exists in your current team</li>
                        </ul>
                    </div>
                `,
                question: {
                    text: "Which type of trust is most common in new teams?",
                    options: [
                        { label: "A) Predictability-based", correct: true },
                        { label: "B) Vulnerability-based", correct: false },
                        { label: "C) Both equally", correct: false }
                    ],
                    correctFeedback: "‚úì Correct! New teams typically start with predictability-based trust.",
                    incorrectFeedback: "Not quite. New teams usually begin with predictability-based trust before building deeper vulnerability-based trust."
                }
            },
            {
                lessonNumber: "Lesson 1 of 4",
                lessonTitle: "The Two Types of Trust",
                content: `
                    <div class="content-section">
                        <h3>üìñ Core Concept: Predictability-Based Trust</h3>
                        <p>
                            Most people confuse reliability with trust. They think: "I trust Sarah because she always delivers on time." That's <strong>predictability-based trust</strong>‚Äîuseful, but limited. It means you can predict behavior. It doesn't mean you can be vulnerable.
                        </p>
                    </div>
                `,
                question: {
                    text: "Predictability-based trust is useful because...",
                    options: [
                        { label: "A) It allows vulnerability", correct: false },
                        { label: "B) You can predict behavior", correct: true },
                        { label: "C) It builds deep relationships", correct: false }
                    ],
                    correctFeedback: "‚úì Exactly! It lets you predict behavior, though it's limited in depth.",
                    incorrectFeedback: "Not quite. Predictability-based trust is about being able to predict someone's behavior."
                }
            },
            {
                lessonNumber: "Lesson 1 of 4",
                lessonTitle: "The Two Types of Trust",
                content: `
                    <div class="content-section">
                        <h3>üìñ Core Concept: Vulnerability-Based Trust</h3>
                        <p>
                            <strong>Vulnerability-based trust</strong> is different. According to Lencioni's research, it's the confidence that your teammates will not use your weaknesses against you. It's knowing you can say "I don't know," "I was wrong," or "I need help" without being punished, judged, or secretly tallied against.
                        </p>
                        <p>
                            Amy Edmondson's research at Harvard defines this as <strong>psychological safety</strong>: "a shared belief held by members of a team that the team is safe for interpersonal risk-taking."
                        </p>
                    </div>
                `,
                question: {
                    text: "What is psychological safety?",
                    options: [
                        { label: "A) Feeling comfortable at work", correct: false },
                        { label: "B) Shared belief you won't be punished for mistakes", correct: true },
                        { label: "C) Having good relationships", correct: false }
                    ],
                    correctFeedback: "‚úì Perfect! It's the shared belief that interpersonal risk-taking is safe.",
                    incorrectFeedback: "Not quite. Psychological safety is specifically about feeling safe to take interpersonal risks without punishment."
                }
            },
            {
                lessonNumber: "Lesson 1 of 4",
                lessonTitle: "The Two Types of Trust",
                content: `
                    <div class="research-box">
                        <h4>üìä Research Evidence: Google's Project Aristotle</h4>
                        <p>
                            Google's 2-year study of 180 teams found that psychological safety‚Äîthe belief that you won't be punished when you make a mistake‚Äîis the #1 predictor of team performance.
                        </p>
                        <ul>
                            <li><strong>43%</strong> of variance in team performance correlated with psychological safety</li>
                            <li><strong>19%</strong> higher productivity with fewer errors</li>
                            <li><strong>27%</strong> lower turnover rates</li>
                            <li><strong>3.6x</strong> more engagement and job satisfaction</li>
                        </ul>
                    </div>
                `,
                question: {
                    text: "According to Google, what's the #1 predictor of team performance?",
                    options: [
                        { label: "A) Intelligence", correct: false },
                        { label: "B) Psychological safety", correct: true },
                        { label: "C) Clear roles", correct: false }
                    ],
                    correctFeedback: "‚úì Yes! Psychological safety was the top factor in high-performing teams.",
                    incorrectFeedback: "Not quite. Google's research found psychological safety to be the #1 predictor."
                }
            },
            {
                lessonNumber: "Lesson 1 of 4",
                lessonTitle: "The Two Types of Trust",
                content: `
                    <div class="content-section">
                        <h3>üîç Why This Matters</h3>
                        <p>
                            Teams without vulnerability-based trust operate in constant self-protection mode. People hedge their language, hide their mistakes, and avoid asking for help. Energy that should go toward results gets wasted on political maneuvering and impression management.
                        </p>
                        
                        <h3>üí° Key Takeaways</h3>
                        <ul>
                            <li><strong>Predictability-based trust</strong> lets you rely on someone's behavior; <strong>vulnerability-based trust</strong> lets you be honest with them</li>
                            <li>Teams without vulnerability-based trust waste enormous energy on self-protection</li>
                            <li>Building vulnerability-based trust requires someone to go first‚Äîusually the leader</li>
                        </ul>
                    </div>
                    
                    <div class="practice-box">
                        <h4>‚ú® Practice Exercise</h4>
                        <p>
                            <strong>This week:</strong> In your next team meeting, admit something you don't know or a recent mistake you made. Observe how people respond. Do they reciprocate with their own vulnerability, or does the room go silent?
                        </p>
                    </div>
                `,
                isComplete: true
            }
        ];

        // ===== STATE MANAGEMENT =====
        let currentChunk = 0;
        let currentLesson = 1;
        let totalChunks = lesson1Chunks.length;
        let lessonXP = 0;

        // ===== RENDER FUNCTIONS =====
        function renderChunk() {
            const chunk = lesson1Chunks[currentChunk];
            const card = document.getElementById('contentCard');
            
            let html = `
                <div class="lesson-number">${chunk.lessonNumber}</div>
                <div class="lesson-title">${chunk.lessonTitle}</div>
                ${chunk.content}
            `;
            
            // Add question if not the final chunk
            if (!chunk.isComplete) {
                html += `
                    <div class="question-box">
                        <h4>‚úì Quick Check</h4>
                        <p class="question-text">${chunk.question.text}</p>
                        <div class="options" id="options">
                            ${chunk.question.options.map((opt, idx) => `
                                <div class="option" onclick="selectAnswer(${idx}, ${opt.correct})" data-index="${idx}">
                                    ${opt.label}
                                </div>
                            `).join('')}
                        </div>
                        <div class="feedback" id="feedback"></div>
                    </div>
                `;
            } else {
                // Final chunk - show complete button
                html += `
                    <div class="nav-buttons">
                        <button class="btn btn-primary" onclick="completeLesson()">
                            Mark Complete <span class="xp-badge">+25 XP</span>
                        </button>
                    </div>
                `;
            }
            
            card.innerHTML = html;
            updateProgress();
            window.scrollTo(0, 0);
        }

        function selectAnswer(index, isCorrect) {
            const chunk = lesson1Chunks[currentChunk];
            const options = document.querySelectorAll('.option');
            const feedback = document.getElementById('feedback');
            
            // Remove previous selections
            options.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
                opt.style.pointerEvents = 'none'; // Disable further clicks
            });
            
            // Mark selected option
            options[index].classList.add('selected');
            
            if (isCorrect) {
                options[index].classList.add('correct');
                feedback.className = 'feedback correct show';
                feedback.textContent = chunk.question.correctFeedback;
                
                // Auto-advance after 1.5 seconds
                setTimeout(() => {
                    currentChunk++;
                    if (currentChunk < totalChunks) {
                        renderChunk();
                    }
                }, 1500);
            } else {
                options[index].classList.add('incorrect');
                feedback.className = 'feedback incorrect show';
                feedback.textContent = chunk.question.incorrectFeedback;
                
                // Re-enable clicks after 2 seconds
                setTimeout(() => {
                    options.forEach(opt => {
                        opt.style.pointerEvents = 'auto';
                        opt.classList.remove('selected', 'incorrect');
                    });
                    feedback.classList.remove('show');
                }, 2000);
            }
        }

        function updateProgress() {
            const progress = ((currentChunk + 1) / totalChunks) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            if (lesson1Chunks[currentChunk].isComplete) {
                document.getElementById('progressText').textContent = `Lesson ${currentLesson} - Ready to Complete`;
            } else {
                document.getElementById('progressText').textContent = `Lesson ${currentLesson} - Section ${currentChunk + 1} of ${totalChunks}`;
            }
        }

        function completeLesson() {
            lessonXP += 25;
            
            // Save progress
            let totalXP = parseInt(localStorage.getItem('totalXP') || '0');
            totalXP += 25;
            localStorage.setItem('totalXP', totalXP);
            
            alert(`üéâ Lesson ${currentLesson} Complete!\n\n+25 XP earned\nTotal XP: ${totalXP}`);
            
            // For now, go back to navigator (later we'll load lesson 2, 3, 4)
            if (confirm('Continue to next lesson?')) {
                // TODO: Load lesson 2
                alert('Lesson 2 coming next! For now, returning to Belt Map.');
                window.location.href = 'stripe-navigator.html';
            } else {
                window.location.href = 'stripe-navigator.html';
            }
        }

        // ===== INITIALIZATION =====
        window.addEventListener('DOMContentLoaded', () => {
            renderChunk();
        });
    </script>

    <!-- Performance Optimizer - Load First -->
<script src="js/performance-optimizer.js"></script>
<!-- TAP-IN Utilities -->
<script src="js/shared-utilities.js"></script>
<script src="js/global-error-handler.js"></script>
<script src="js/storage-health.js"></script>
</body>
</html>

